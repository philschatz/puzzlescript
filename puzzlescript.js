!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=374)}([function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){var a=e.apply(t,n);function s(e){r(a,o,i,s,l,"next",e)}function l(e){r(a,o,i,s,l,"throw",e)}s(void 0)})}}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s,l,u;function c(e){var t=[];return e.forEach(function(e){e.forEach(function(e){t.push(e)})}),t}function f(e){var t;return function(){t&&clearTimeout(t),t=setTimeout(function(){e()},10)}}function h(e){switch(e){case s.UP:return s.DOWN;case s.DOWN:return s.UP;case s.LEFT:return s.RIGHT;case s.RIGHT:return s.LEFT;default:throw new Error('BUG: Invalid direction: "'.concat(e,'"'))}}function p(e,t){if(e.size!==t.size)return!1;var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(!e.has(s))return!1}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return!0}function m(e,t){var n=new Set(e),r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;n.add(l)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}function y(e,t){var n=new Set,r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;e.has(l)&&n.add(l)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}function d(e,t){var n=new Set(e),r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;n.delete(l)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}n.d(t,"d",function(){return s}),n.d(t,"b",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"g",function(){return c}),n.d(t,"f",function(){return f}),n.d(t,"i",function(){return h}),n.d(t,"n",function(){return p}),n.d(t,"l",function(){return m}),n.d(t,"o",function(){return y}),n.d(t,"m",function(){return d}),n.d(t,"h",function(){return _}),n.d(t,"k",function(){return S}),n.d(t,"q",function(){return w}),n.d(t,"j",function(){return E}),n.d(t,"c",function(){return b}),n.d(t,"p",function(){return T}),n.d(t,"a",function(){return O}),function(e){e.UP="UP",e.DOWN="DOWN",e.LEFT="LEFT",e.RIGHT="RIGHT",e.ACTION="ACTION",e.STATIONARY="STATIONARY",e.RANDOMDIR="RANDOMDIR"}(s||(s={})),function(e){e.UP="UP",e.DOWN="DOWN",e.LEFT="LEFT",e.RIGHT="RIGHT",e.ACTION="ACTION",e.UNDO="UNDO",e.RESTART="RESTART"}(l||(l={})),function(e){e.RELATIVE_LEFT="<",e.RELATIVE_RIGHT=">",e.RELATIVE_UP="^",e.RELATIVE_DOWN="V"}(u||(u={}));var v,b,g=1,$=null;function _(e){if($){if($.length<=g-1)throw new Error("BUG: the list of random values for testing was too short.\n            See calls to setRandomValuesForTesting([...]).\n            The list was [".concat($,"]. Index being requested is ").concat(g-1));var t=$[g-1];return g++,t}var n=1e4*Math.sin(g++);return Math.round((n-Math.floor(n))*(e-1))}function S(){g=1}function w(e){var t=e.getPlayer().getSprites(),n=new Set(t),r=!0,o=!1,i=void 0;try{for(var s,l=n[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value.getCollisionLayer(),c=!0,f=!1,h=void 0;try{for(var p,m=e.objects[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var d=p.value;d.getCollisionLayer()===u&&n.add(d)}}catch(e){f=!0,h=e}finally{try{c||null==m.return||m.return()}finally{if(f)throw h}}}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}var v=!0,b=!1,g=void 0;try{for(var $,_=e.winConditions[Symbol.iterator]();!(v=($=_.next()).done);v=!0){var S=$.value,w=!0,E=!1,T=void 0;try{for(var O,R=S.a11yGetTiles()[Symbol.iterator]();!(w=(O=R.next()).done);w=!0){var k=O.value,L=!0,x=!1,C=void 0;try{for(var A,M=k.getSprites()[Symbol.iterator]();!(L=(A=M.next()).done);L=!0){var I=A.value;n.add(I)}}catch(e){x=!0,C=e}finally{try{L||null==M.return||M.return()}finally{if(x)throw C}}}}catch(e){E=!0,T=e}finally{try{w||null==R.return||R.return()}finally{if(E)throw T}}}}catch(e){b=!0,g=e}finally{try{v||null==_.return||_.return()}finally{if(b)throw g}}var N=!0,P=!1,D=void 0;try{for(var G,B=e.rules[Symbol.iterator]();!(N=(G=B.next()).done);N=!0){var F=G.value,U=!0,W=!1,j=void 0;try{for(var H,V=F.a11yGetConditionSprites()[Symbol.iterator]();!(U=(H=V.next()).done);U=!0){var q=H.value;if(y(q,n).size>0){var X=!0,z=!1,K=void 0;try{for(var Y,J=q[Symbol.iterator]();!(X=(Y=J.next()).done);X=!0){var Z=Y.value;n.add(Z)}}catch(e){z=!0,K=e}finally{try{X||null==J.return||J.return()}finally{if(z)throw K}}}}}catch(e){W=!0,j=e}finally{try{U||null==V.return||V.return()}finally{if(W)throw j}}}}catch(e){P=!0,D=e}finally{try{N||null==B.return||B.return()}finally{if(P)throw D}}var Q=e.getMagicBackgroundSprite();return Q&&n.delete(Q),new Set(a(n).filter(function(e){return!e.isTransparent()}))}function E(e,t){return new Promise(function(n){var r=setInterval(function(){var e=t();e&&(clearInterval(r),n(e))},e)})}!function(e){e.BREAKPOINT="DEBUGGER",e.BREAKPOINT_REMOVE="DEBUGGER_REMOVE"}(v||(v={})),function(e){e.PAUSE="PAUSE",e.RESUME="RESUME",e.TICK="TICK",e.PRESS="PRESS",e.CLOSE="CLOSE",e.ON_GAME_CHANGE="ON_GAME_CHANGE",e.ON_PRESS="ON_PRESS",e.ON_MESSAGE="ON_MESSAGE",e.ON_MESSAGE_DONE="ON_MESSAGE_DONE",e.ON_LEVEL_CHANGE="ON_LEVEL_CHANGE",e.ON_WIN="ON_WIN",e.ON_SOUND="ON_SOUND",e.ON_TICK="ON_TICK",e.ON_PAUSE="ON_PAUSE",e.ON_RESUME="ON_RESUME"}(b||(b={}));var T=function(e,t){var n=Date.now(),r=Math.min(e.realtimeInterval||1e3,e.keyRepeatInterval||1e3,e.againInterval||1e3);return(r>100||Number.isNaN(r))&&(r=.01),n-t>=1e3*r},O=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subHandlers=t||[]}var t,n,r;return t=e,(n=[{key:"onGameChange",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.subHandlers[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.onGameChange&&a.onGameChange(e)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"onPress",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.subHandlers[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.onPress&&a.onPress(e)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"onMessage",value:function(){var e=o(regeneratorRuntime.mark(function e(t){var n,r,o,i,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,r=!1,o=void 0,e.prev=3,i=this.subHandlers[Symbol.iterator]();case 5:if(n=(a=i.next()).done){e.next=14;break}if(s=a.value,e.t0=s.onMessage,!e.t0){e.next=11;break}return e.next=11,s.onMessage(t);case 11:n=!0,e.next=5;break;case 14:e.next=20;break;case 16:e.prev=16,e.t1=e.catch(3),r=!0,o=e.t1;case 20:e.prev=20,e.prev=21,n||null==i.return||i.return();case 23:if(e.prev=23,!r){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}},e,this,[[3,16,20,28],[21,,23,27]])}));return function(t){return e.apply(this,arguments)}}()},{key:"onLevelChange",value:function(e,t,n){var r=!0,o=!1,i=void 0;try{for(var a,s=this.subHandlers[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.onLevelChange&&l.onLevelChange(e,t,n)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}},{key:"onWin",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.subHandlers[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;i.onWin&&i.onWin()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"onSound",value:function(){var e=o(regeneratorRuntime.mark(function e(t){var n,r,o,i,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=!0,r=!1,o=void 0,e.prev=3,i=this.subHandlers[Symbol.iterator]();!(n=(a=i.next()).done);n=!0)(s=a.value).onSound&&s.onSound(t);e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),r=!0,o=e.t0;case 11:e.prev=11,e.prev=12,n||null==i.return||i.return();case 14:if(e.prev=14,!r){e.next=17;break}throw o;case 17:return e.finish(14);case 18:return e.finish(11);case 19:case"end":return e.stop()}},e,this,[[3,7,11,19],[12,,14,18]])}));return function(t){return e.apply(this,arguments)}}()},{key:"onTick",value:function(e,t,n){var r=!0,o=!1,i=void 0;try{for(var a,s=this.subHandlers[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.onTick&&l.onTick(e,t,n)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}},{key:"onPause",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.subHandlers[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;i.onPause&&i.onPause()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"onResume",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.subHandlers[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;i.onResume&&i.onResume()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}}])&&i(t.prototype,n),r&&i(t,r),e}()},function(e,t,n){var r=n(4),o=n(24),i=n(16),a=n(17),s=n(25),l=function e(t,n,l){var u,c,f,h,p=t&e.F,m=t&e.G,y=t&e.P,d=t&e.B,v=m?r:t&e.S?r[n]||(r[n]={}):(r[n]||{}).prototype,b=m?o:o[n]||(o[n]={}),g=b.prototype||(b.prototype={});for(u in m&&(l=n),l)f=((c=!p&&v&&void 0!==v[u])?v:l)[u],h=d&&c?s(f,r):y&&"function"==typeof f?s(Function.call,f):f,v&&a(v,u,f,t&e.U),b[u]!=f&&i(b,u,h),y&&g[u]!=f&&(g[u]=f)};r.core=o,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){"use strict";var r,o,i,a,s,l,u,c,f,h,p,m,y,d;n.d(t,"e",function(){return r}),n.d(t,"b",function(){return l}),n.d(t,"h",function(){return u}),n.d(t,"i",function(){return c}),n.d(t,"g",function(){return f}),n.d(t,"f",function(){return h}),n.d(t,"a",function(){return p}),n.d(t,"c",function(){return m}),n.d(t,"j",function(){return y}),n.d(t,"d",function(){return d}),function(e){e.RANDOM="RANDOM",e.UP="UP",e.DOWN="DOWN",e.LEFT="LEFT",e.RIGHT="RIGHT",e.VERTICAL="VERTICAL",e.HORIZONTAL="HORIZONTAL",e.ORTHOGONAL="ORTHOGONAL",e.PERPENDICULAR="PERPENDICULAR",e.PARALLEL="PARALLEL",e.MOVING="MOVING",e.LATE="LATE",e.RIGID="RIGID"}(r||(r={})),function(e){e.NO="NO",e.LEFT="LEFT",e.RIGHT="RIGHT",e.UP="UP",e.DOWN="DOWN",e.RANDOMDIR="RANDOMDIR",e.RANDOM="RANDOM",e.STATIONARY="STATIONARY",e.MOVING="MOVING",e.ACTION="ACTION",e.VERTICAL="VERTICAL",e.HORIZONTAL="HORIZONTAL",e.PERPENDICULAR="PERPENDICULAR",e.PARALLEL="PARALLEL",e.ORTHOGONAL="ORTHOGONAL",e.ARROW_ANY="ARROW_ANY"}(o||(o={})),function(e){e.RESTART="RESTART",e.UNDO="UNDO",e.TITLESCREEN="TITLESCREEN",e.STARTGAME="STARTGAME",e.STARTLEVEL="STARTLEVEL",e.ENDLEVEL="ENDLEVEL",e.ENDGAME="ENDGAME",e.SHOWMESSAGE="SHOWMESSAGE",e.CLOSEMESSAGE="CLOSEMESSAGE"}(i||(i={})),function(e){e.UP="UP",e.DOWN="DOWN",e.LEFT="LEFT",e.RIGHT="RIGHT",e.HORIZONTAL="HORIZONTAL",e.VERTICAL="VERTICAL"}(a||(a={})),function(e){e.CREATE="CREATE",e.DESTROY="DESTROY",e.CANTMOVE="CANTMOVE"}(s||(s={})),function(e){e.HEX3="HEX3",e.HEX6="HEX6",e.NAME="NAME"}(l||(l={})),function(e){e.NO_PIXELS="NO_PIXELS",e.WITH_PIXELS="WITH_PIXELS"}(u||(u={})),function(e){e.SIMPLE="LEGEND_ITEM_SIMPLE",e.OR="LEGEND_ITEM_OR",e.AND="LEGEND_ITEM_AND"}(c||(c={})),function(e){e.WHEN="SOUND_WHEN",e.SFX="SOUND_SFX",e.SPRITE_DIRECTION="SOUND_SPRITE_DIRECTION",e.SPRITE_MOVE="SOUND_SPRITE_MOVE",e.SPRITE_EVENT="SOUND_SPRITE_EVENT"}(f||(f={})),function(e){e.GROUP="RULE_GROUP",e.LOOP="RULE_LOOP",e.SIMPLE="RULE_SIMPLE"}(h||(h={})),function(e){e.SIMPLE="BRACKET_SIMPLE",e.ELLIPSIS="BRACKET_ELLIPSIS"}(p||(p={})),function(e){e.MESSAGE="COMMAND_MESSAGE",e.AGAIN="COMMAND_AGAIN",e.CANCEL="COMMAND_CANCEL",e.CHECKPOINT="COMMAND_CHECKPOINT",e.RESTART="COMMAND_RESTART",e.WIN="COMMAND_WIN",e.SFX="COMMAND_SFX"}(m||(m={})),function(e){e.SIMPLE="WINCONDITION_SIMPLE",e.ON="WINCONDITION_ON"}(y||(y={})),function(e){e.MESSAGE="LEVEL_MESSAGE",e.MAP="LEVEL_MAP"}(d||(d={}))},function(e,t,n){var r=n(6);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return"object"===n(e)?null!==e:"function"==typeof e}},function(e,t,n){"use strict";(function(e){n.d(t,"f",function(){return O}),n.d(t,"g",function(){return R}),n.d(t,"e",function(){return k}),n.d(t,"h",function(){return L}),n.d(t,"b",function(){return A}),n.d(t,"c",function(){return N}),n.d(t,"a",function(){return M}),n.d(t,"d",function(){return G});var r=n(19),o=n(145),i=n(2),a=n(39),s=n(0),l=n(13);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var g=n(105),$=50,_=(s.d.RIGHT,s.d.DOWN,s.d.LEFT,s.d.UP,function e(t,n){b(this,e),this.condition=t,this.action=n}),S=function(e){function t(e,n,r){var o;return b(this,t),(o=m(this,y(t).call(this,e,n))).extra=r,o}return d(t,_),t}(),w=function(){function e(t,n){b(this,e),this.cell=t,this.messages=n}return h(e,[{key:"hasCell",value:function(){return!0}},{key:"getCell",value:function(){return this.cell}},{key:"getCommand",value:function(){throw new Error("BUG: check hasCommand first")}}]),e}(),E=function(){function e(t){b(this,e),this.command=t,this.messages=[]}return h(e,[{key:"getCommand",value:function(){return this.command}},{key:"hasCell",value:function(){return!1}},{key:"getCell",value:function(){throw new Error("BUG: check hasCell first")}}]),e}();var T,O=function(e){function t(e,n,r){var o;return b(this,t),(o=m(this,y(t).call(this,e))).rules=r,o.isRandom=n,o}return d(t,l["a"]),h(t,[{key:"hasMatches",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.rules[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(o.value.hasMatches(e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return!1}},{key:"evaluate",value:function(e,t){var n;r.b.isLevel(r.a.DEBUG)&&(n=Date.now());var o,i=[];for(o=0;o<350;o++){if(349===o)throw new Error("BUG: Iterated too many times in startloop or + (rule group)\n".concat(this.toString()));if(this.isRandom){var a=this.rules.filter(function(t){return t.hasMatches(e)});return 0===a.length?[]:1===a.length?a[0].evaluate(e,!0):a[Object(s.h)(a.length)].evaluate(e,!0)}var l=!1,u=!0,c=!1,f=void 0;try{for(var h,p=this.rules[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value.evaluate(e,t);if(m.length>0){if(m.filter(function(e){return e.hasCell()}).length>0&&(l=!0),t)return m;i.push(m)}}}catch(e){c=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw f}}if(!l)break}return r.b.isLevel(r.a.DEBUG)&&i.length>0&&(n&&Date.now()-n>30?r.b.debug("Rule ".concat(this.__getSourceLineAndColumn().lineNum," applied. ").concat(1===o?"":"(x".concat(o,")")," [[").concat(Date.now()-n,"ms]]")):r.b.debug("Rule ".concat(this.__getSourceLineAndColumn().lineNum," applied. ").concat(1===o?"":"(x".concat(o,")")))),Object(s.g)(i)}},{key:"clearCaches",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.rules[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.clearCaches()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"getChildRules",value:function(){return this.rules}},{key:"isLate",value:function(){return this.rules[0].isLate()}},{key:"hasRigid",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.rules[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){if(r.value.hasRigid())return!0}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}return!1}},{key:"addCellsToEmptyRules",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.rules[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.addCellsToEmptyRules(e)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"toKey",value:function(){return this.rules.map(function(e){return e.toKey()}).join("\n")}},{key:"a11yGetConditionSprites",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this.rules[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e=[].concat(c(e),c(a.a11yGetConditionSprites()))}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}}]),t}(),R=function(e){function t(){return b(this,t),m(this,y(t).apply(this,arguments))}return d(t,O),t}(),k=function(e){function t(e,n,r,o,i,a,s){var l;if(b(this,t),(l=m(this,y(t).call(this,e))).conditionBrackets=n,l.actionBrackets=r,l.commands=o,l._isLate=i,l.isRigid=a,l.debugFlag=s,l.isSubscribedToCellChanges=!1,r.length>0)for(var u=0;u<n.length;u++)n[u].prepareAction(r[u]);return l}return d(t,l["a"]),h(t,[{key:"toKey",value:function(){var e=this.conditionBrackets.map(function(e){return e.toKey()}),t=this.actionBrackets.map(function(e){return e.toKey()}),n=this.commands.map(function(e){return function(e){switch(e.type){case i.c.AGAIN:case i.c.CANCEL:case i.c.CHECKPOINT:case i.c.RESTART:case i.c.WIN:return e.type;case i.c.MESSAGE:return"".concat(e.type,":").concat(e.message);case i.c.SFX:return"".concat(e.type,":").concat(e.sound.type,":").concat(e.sound.soundCode)}}(e)});return"{Late?".concat(this._isLate,"} {Rigid?").concat(this.isRigid,"} ").concat(e," -> ").concat(t," ").concat(n.join(" ")," {debugger?").concat(this.debugFlag,"}")}},{key:"getChildRules",value:function(){return[]}},{key:"subscribeToCellChanges",value:function(){if(!this.isSubscribedToCellChanges){var e=!0,t=!1,n=void 0;try{for(var r,o=this.conditionBrackets[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.subscribeToNeighborChanges()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}this.isSubscribedToCellChanges=!0}}},{key:"clearCaches",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.conditionBrackets[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.clearCaches()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"getMatches",value:function(e){for(var t=[],n=0;n<this.conditionBrackets.length;n++){var r=this.conditionBrackets[n],o=this.actionBrackets[n],i=r.getMatches(e,o);if(0===i.length)return[];t.push(i)}return t}},{key:"evaluate",value:function(e,t){var n=[];var r=this.getMatches(e);if(0===r.length)return[];if(this.actionBrackets.length>0){var o=function(e){var t=[[]],n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l=[],u=!0,c=!1,f=void 0;try{for(var h,p=s[Symbol.iterator]();!(u=(h=p.next()).done);u=!0)for(var m=h.value,y=0;y<t.length;y++){var d=t[y].concat([m]);l.push(d)}}catch(e){c=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw f}}t=l}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}(r),i=[],a=!0,l=!1,u=void 0;try{for(var c,f=o[Symbol.iterator]();!(a=(c=f.next()).done);a=!0){var h=c.value,p=!0,m=new Map,y=!0,d=!1,v=void 0;try{for(var b,g=h[Symbol.iterator]();!(y=(b=g.next()).done);y=!0){var $=b.value;if(!$.doesStillMatch()){p=!1;break}$.populateMagicOrTiles(m)}}catch(e){d=!0,v=e}finally{try{y||null==g.return||g.return()}finally{if(d)throw v}}if(p){var _=!0,S=!1,w=void 0;try{for(var T,O=h[Symbol.iterator]();!(_=(T=O.next()).done);_=!0){var R=T.value;R.doesStillMatch()&&i.push(R.evaluate(m))}}catch(e){S=!0,w=e}finally{try{_||null==O.return||O.return()}finally{if(S)throw w}}if(t)break}}}catch(e){l=!0,u=e}finally{try{a||null==f.return||f.return()}finally{if(l)throw u}}n=Object(s.g)(i)}var k=!0,L=!1,x=void 0;try{for(var C,A=this.commands[Symbol.iterator]();!(k=(C=A.next()).done);k=!0){var M=C.value;n.push(new E(M))}}catch(e){L=!0,x=e}finally{try{k||null==A.return||A.return()}finally{if(L)throw x}}return n}},{key:"hasMatches",value:function(e){for(var t=0;t<this.conditionBrackets.length;t++){var n=this.conditionBrackets[t],r=this.actionBrackets[t];if(!n.hasMatches(e,r))return!1}return!0}},{key:"isLate",value:function(){return this._isLate}},{key:"hasRigid",value:function(){return this.isRigid}},{key:"canCollapseBecauseBracketsMatch",value:function(e){for(var t=0;t<this.conditionBrackets.length;t++){if(this.conditionBrackets[t]!==e.conditionBrackets[t])return!1;if(this.conditionBrackets[t]._getAllNeighbors().length>1)return!1}for(var n=0;n<this.actionBrackets.length;n++)if(this.actionBrackets[n]!==e.actionBrackets[n])return!1;return!0}},{key:"addCellsToEmptyRules",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.conditionBrackets[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.addCellsToEmptyRules(e)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"a11yGetConditionSprites",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this.conditionBrackets[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e=[].concat(c(e),c(a.a11yGetSprites()))}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}}]),t}(),L=function(e){function t(e,n,r,o,i,a){var s;return b(this,t),(s=m(this,y(t).call(this,e)))._isNegated=n,s._isRandom=r,s._direction=o,s._tile=i,s.neighbors=new Set,s._debugFlag=a,s.trickleCells=new Set,s}return d(t,l["a"]),h(t,[{key:"toKey",value:function(e){var t=this._tile.getSprites().map(function(e){return e.getName()}).sort();return e?"{-?".concat(this._isNegated,"} {#?").concat(this._isRandom,'} dir="').concat(this._direction,'" [').concat(t.join(" "),"]"):"{-?".concat(this._isNegated,"} {#?").concat(this._isRandom,'} dir="').concat(this._direction,'" [').concat(t.join(" "),"]{debugging?").concat(!!this._debugFlag,"}")}},{key:"equals",value:function(e){return this._isNegated===e._isNegated&&this._tile.equals(e._tile)&&this._direction===e._direction&&this._isRandom===e._isRandom}},{key:"clearCaches",value:function(){}},{key:"isNo",value:function(){return this._isNegated}},{key:"isRandom",value:function(){return this._isRandom}},{key:"getCollisionLayers",value:function(){var e=new Set,t=!0,n=!1,r=void 0;try{for(var o,i=this._tile.getSprites()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.add(a.getCollisionLayer())}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"subscribeToCellChanges",value:function(e){this.neighbors.add(e),this._tile.subscribeToCellChanges(this)}},{key:"addCells",value:function(e,t,n,r){if(this._direction&&r!==this._direction?this._tile.isOr()&&this.matchesFirstCell(n,r)?!this.isNo():this.isNo():!this.isNo()){var o=!0,i=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value;this.trickleCells.add(u)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}var c=!0,f=!1,h=void 0;try{for(var p,m=this.neighbors[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){p.value.addCells(this,t,n,r)}}catch(e){f=!0,h=e}finally{try{c||null==m.return||m.return()}finally{if(f)throw h}}}else{var y=!0,d=!1,v=void 0;try{for(var b,g=n[Symbol.iterator]();!(y=(b=g.next()).done);y=!0){var $=b.value;this.trickleCells.delete($)}}catch(e){d=!0,v=e}finally{try{y||null==g.return||g.return()}finally{if(d)throw v}}var _=!0,S=!1,w=void 0;try{for(var E,T=this.neighbors[Symbol.iterator]();!(_=(E=T.next()).done);_=!0){E.value.removeCells(this,t,n)}}catch(e){S=!0,w=e}finally{try{_||null==T.return||T.return()}finally{if(S)throw w}}}}},{key:"updateCells",value:function(e,t,n){if(this.matchesFirstCell(t,n)){var r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;this.trickleCells.add(l)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}if(n){var u=!0,c=!1,f=void 0;try{for(var h,p=this.neighbors[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){h.value.updateCells(this,e,t,n)}}catch(e){c=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw f}}}}else{var m=!0,y=!1,d=void 0;try{for(var v,b=t[Symbol.iterator]();!(m=(v=b.next()).done);m=!0){var g=v.value;this.trickleCells.delete(g)}}catch(e){y=!0,d=e}finally{try{m||null==b.return||b.return()}finally{if(y)throw d}}var $=!0,_=!1,S=void 0;try{for(var w,E=this.neighbors[Symbol.iterator]();!($=(w=E.next()).done);$=!0){w.value.removeCells(this,e,t)}}catch(e){_=!0,S=e}finally{try{$||null==E.return||E.return()}finally{if(_)throw S}}}}},{key:"removeCells",value:function(e,t,n){if(this._tile.isOr()?this.matchesFirstCell(n,null):this.isNo()){var r=!0,o=!1,i=void 0;try{for(var a,l=n[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;this.trickleCells.add(u)}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}var c=!0,f=!1,h=void 0;try{for(var p,m=this.neighbors[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){p.value.addCells(this,t,n,s.d.STATIONARY)}}catch(e){f=!0,h=e}finally{try{c||null==m.return||m.return()}finally{if(f)throw h}}}else{var y=!0,d=!1,v=void 0;try{for(var b,g=n[Symbol.iterator]();!(y=(b=g.next()).done);y=!0){var $=b.value;this.trickleCells.delete($)}}catch(e){d=!0,v=e}finally{try{y||null==g.return||g.return()}finally{if(d)throw v}}var _=!0,S=!1,w=void 0;try{for(var E,T=this.neighbors[Symbol.iterator]();!(_=(E=T.next()).done);_=!0){E.value.removeCells(this,t,n)}}catch(e){S=!0,w=e}finally{try{_||null==T.return||T.return()}finally{if(S)throw w}}}}},{key:"hasCell",value:function(e){return this.trickleCells.has(e)}},{key:"matchesCellWantsToMove",value:function(e,t){var n=this._tile.hasCell(e);if(this._isNegated!==(n&&(this._direction===t||!this._direction)))return!0;if(this._direction){var r=!0,o=!1,i=void 0;try{for(var a,s=this._tile.getSpritesThatMatch(e)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(this._direction===e.getWantsToMove(l))return!0}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return!1}return!1}},{key:"matchesFirstCell",value:function(e,t){return this.matchesCellWantsToMove(e[0],t)}}]),t}(),x=function(e){function t(e,n,r,o){var i;return b(this,t),(i=m(this,y(t).call(this,e))).direction=n,i.debugFlag=o,i.allNeighbors=r,i.firstCells=new Set,i}return d(t,l["a"]),h(t,[{key:"_getAllNeighbors",value:function(){return this.allNeighbors}},{key:"hasMatches",value:function(e,t){return this.getMatches(e,t).length>0}}]),t}(),C=function(){function e(t){b(this,e),this.cellsAndNeighbors=t,this.cellKeys=new Map;var n=!0,r=!1,o=void 0;try{for(var i,a=this.cellsAndNeighbors[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value.cell;this.cellKeys.set(s,s.toKey())}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}return h(e,[{key:"firstCell",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.cellsAndNeighbors[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){return r.value.cell}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}throw new Error("BUG: ? No cells were included in the match")}},{key:"lastCell",value:function(){var e,t=!0,n=!1,r=void 0;try{for(var o,i=this.cellsAndNeighbors[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){e=o.value.cell}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}if(e)return e;throw new Error("BUG: ? No cells were included in the match")}},{key:"doesStillMatch",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.cellsAndNeighbors[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value,a=i.cell,s=i.condition;if(a.toKey()!==this.cellKeys.get(a)){if(!s.matchesCellSimple(a))return!1;this.cellKeys.set(a,a.toKey())}}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}return!0}},{key:"populateMagicOrTiles",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.cellsAndNeighbors[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=a.cell;a.condition.populateMagicOrTiles(s,e)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"evaluate",value:function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=this.cellsAndNeighbors[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l=s.cell,u=s.condition,c=s.action;if(!c)throw new Error("BUG: Should not have tried to evaluate something when there is no action");var f=u.evaluate(c,l,e);f&&t.push(f)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}}]),e}(),A=function(t){function n(e,t,r,o){var i;b(this,n),(i=m(this,y(n).call(this,e,t,r,o))).actionDebugFlag=null,i.neighbors=r,i.ellipsisBracketListeners=new Map,i.spritesPresentInRowOrColumn=i.neighbors[0].spritesPresent.union(i.neighbors.map(function(e){return e.spritesPresent}));var s=[],l=!0,u=!1,c=void 0;try{for(var f,h=i.neighbors[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var p=f.value,d=!0,v=!1,g=void 0;try{for(var $,_=p.anySpritesPresent[Symbol.iterator]();!(d=($=_.next()).done);d=!0){var S=$.value;s.push(S)}}catch(e){v=!0,g=e}finally{try{d||null==_.return||_.return()}finally{if(v)throw g}}}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}return i.anySpritesPresentInRowOrColumn=(new a.a).union(s),i}return d(n,x),h(n,[{key:"toKey",value:function(){var e=this.dependsOnDirection()?this.direction:"";return"{".concat(e,"[").concat(this.neighbors.map(function(e){return e.toKey()}).join("|"),"]{debugging?").concat(!!this.debugFlag,"}}")}},{key:"dependsOnDirection",value:function(){return this.neighbors.length>1||!!this.neighbors.find(function(e){return e.dependsOnDirection()})}},{key:"subscribeToNeighborChanges",value:function(){var e=this;this.shouldUseOnDemandMethod()||this.neighbors.forEach(function(t,n){t.subscribeToTileChanges(e,n)})}},{key:"addEllipsisBracket",value:function(e,t){this.ellipsisBracketListeners.set(e,t)}},{key:"clearCaches",value:function(){this.firstCells.clear();var e=!0,t=!1,n=void 0;try{for(var r,o=this.neighbors[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.clearCaches()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"getNeighbors",value:function(){return this.neighbors}},{key:"prepareAction",value:function(e){var t=e;this.actionDebugFlag=t.debugFlag;for(var n=0;n<this.neighbors.length;n++){var r=this.neighbors[n],o=t.neighbors[n];r.prepareAction(o)}}},{key:"addCellsToEmptyRules",value:function(e){if(1===this.neighbors.length&&0===this.neighbors[0]._tilesWithModifier.size){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this._addFirstCell(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}}},{key:"_addFirstCell",value:function(e){this.firstCells.add(e);var t=!0,n=!1,r=void 0;try{for(var o,i=this.ellipsisBracketListeners[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=u(o.value,2),s=a[0],l=a[1];s.addFirstCell(this,e,l)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"addCell",value:function(e,t,n,r,o,i){if(this.matchesDownstream(o,e)){var a=this.matchesUpstream(o,e);if(a)this._addFirstCell(a);else{var s=this.getUpstream(o,e);s&&this._removeFirstCell(s)}}else{this.getUpstream(o,e)&&this._removeFirstCell(o)}}},{key:"removeCell",value:function(e,t,n,r,o){var i=this.getFirstCellToRemove(o,e);i&&this.firstCells.has(i)&&this._removeFirstCell(i)}},{key:"shouldUseOnDemandMethod",value:function(){return"ondemand"===e.env.PUZZLESCRIPT_METHOD}},{key:"getMatchesByTrickling",value:function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=this.firstCells[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;this.addToCellMatches(n,l,t)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}},{key:"getMatchesByLooping",value:function(e,t){var n=[],r=e.getCells(),o=r.length,i=r[0].length;switch(this.direction){case s.d.UP:case s.d.DOWN:for(var a=0;a<i;a++)if(e.colContainsSprites(a,this.spritesPresentInRowOrColumn,this.anySpritesPresentInRowOrColumn))for(var l=0;l<o;l++)this.addIfCellMatches(n,e.getCell(l,a),t);break;case s.d.LEFT:case s.d.RIGHT:for(var u=0;u<o;u++)if(e.rowContainsSprites(u,this.spritesPresentInRowOrColumn,this.anySpritesPresentInRowOrColumn))for(var c=0;c<i;c++)this.addIfCellMatches(n,e.getCell(u,c),t);break;default:throw new Error('BUG: Unsupported Direction "'.concat(this.direction,'"'))}return n}},{key:"getMatches",value:function(t,n){var r;if(this.shouldUseOnDemandMethod())r=this.getMatchesByLooping(t,n);else if(r=this.getMatchesByTrickling(t,n),e.env.VERIFY_MATCHES){var o=this.getMatchesByLooping(t,n);if(r.length!==o.length)throw this.getMatchesByTrickling(t,n),this.getMatchesByLooping(t,n),new Error("Match lengths differ. Expected ".concat(o.length," but found ").concat(r.length,". \n").concat(this.toString()))}return r}},{key:"a11yGetSprites",value:function(){var e=new Set,t=!0,n=!1,r=void 0;try{for(var o,i=this.neighbors[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=!0,l=!1,u=void 0;try{for(var c,f=a._tilesWithModifier[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var h=c.value,p=!0,m=!1,y=void 0;try{for(var d,v=h._tile.getSprites()[Symbol.iterator]();!(p=(d=v.next()).done);p=!0){var b=d.value;e.add(b)}}catch(e){m=!0,y=e}finally{try{p||null==v.return||v.return()}finally{if(m)throw y}}}}catch(e){l=!0,u=e}finally{try{s||null==f.return||f.return()}finally{if(l)throw u}}}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return[e]}},{key:"_removeFirstCell",value:function(e){if(this.firstCells.has(e)){0,this.firstCells.delete(e);var t=!0,n=!1,r=void 0;try{for(var o,i=this.ellipsisBracketListeners[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=u(o.value,2),s=a[0],l=a[1];s.removeFirstCell(this,e,l)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}}},{key:"matchesDownstream",value:function(e,t){for(var n=!0,r=e,o=t+1;o<this.neighbors.length;o++)if(!(r=r.getNeighbor(this.direction))||0!==this.neighbors[o]._tilesWithModifier.size&&!this.neighbors[o].matchesCellSimple(r)){n=!1;break}return n}},{key:"getUpstream",value:function(e,t){for(var n=e,r=t-1;r>=0;r--)if(!(n=n.getNeighbor(Object(s.i)(this.direction))))return null;return n}},{key:"matchesUpstream",value:function(e,t){for(var n=!0,r=e,o=t-1;o>=0;o--)if(!(r=r.getNeighbor(Object(s.i)(this.direction)))||0!==this.neighbors[o]._tilesWithModifier.size&&!this.neighbors[o].matchesCellSimple(r)){n=!1;break}return n?r:null}},{key:"getFirstCellToRemove",value:function(e,t){for(var n=!0,r=e,o=t-1;o>=0;o--)if(!(r=r.getNeighbor(Object(s.i)(this.direction)))){n=!1;break}return n?r:null}},{key:"addToCellMatches",value:function(e,t,n){for(var r=[],o=t,i=!0,a=0;a<this.neighbors.length;a++){if(!o){i=!1;break}var s=this.neighbors[a],l=null;n&&(l=n.neighbors[a]||null);var u={cell:o,condition:s,action:l};r.push(u),o=o.getNeighbor(this.direction)}i&&e.push(new C(r))}},{key:"addIfCellMatches",value:function(e,t,n){this.neighbors[0].matchesCellSimple(t)&&this.matchesDownstream(t,0)&&this.addToCellMatches(e,t,n)}}]),n}();!function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"}(T||(T={}));var M,I=function(){function e(){b(this,e),this.map=new Map}return h(e,[{key:"clear",value:function(){this.map.clear()}},{key:"getB",value:function(e){return this.map.get(e)}},{key:"add",value:function(e,t){var n=this.map.get(e);return n||(n=new Set,this.map.set(e,n)),!n.has(t)&&(n.add(t),!0)}},{key:"deleteAllA",value:function(e){this.map.delete(e)}},{key:"deleteAllB",value:function(e){var t=new Set,n=!0,r=!1,o=void 0;try{for(var i,a=this.map[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=u(i.value,2),l=s[0],c=s[1];c.has(e)&&(c.delete(e),0===c.size&&(this.map.delete(l),t.add(l)))}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}},{key:"sizeA",value:function(){return this.map.size}}]),e}(),N=function(e){function t(e,n,r,o,i){var a;return b(this,t),(a=m(this,y(t).call(this,e,n,[].concat(c(r),c(o)),i))).beforeEllipsisBracket=new A(e,n,r,i),a.afterEllipsisBracket=new A(e,n,o,i),a.linkages=new I,a}return d(t,x),h(t,[{key:"subscribeToNeighborChanges",value:function(){this.beforeEllipsisBracket.subscribeToNeighborChanges(),this.afterEllipsisBracket.subscribeToNeighborChanges(),this.beforeEllipsisBracket.addEllipsisBracket(this,T.BEFORE),this.afterEllipsisBracket.addEllipsisBracket(this,T.AFTER)}},{key:"toKey",value:function(){return"[".concat(this.direction," ").concat(this.beforeEllipsisBracket.toKey()," ... ").concat(this.afterEllipsisBracket.toKey(),"]}")}},{key:"clearCaches",value:function(){this.firstCells.clear(),this.linkages.clear(),this.beforeEllipsisBracket.clearCaches(),this.afterEllipsisBracket.clearCaches()}},{key:"prepareAction",value:function(e){var t=e;this.beforeEllipsisBracket.prepareAction(t.beforeEllipsisBracket),this.afterEllipsisBracket.prepareAction(t.afterEllipsisBracket)}},{key:"addCellsToEmptyRules",value:function(e){this.beforeEllipsisBracket.addCellsToEmptyRules(e),this.afterEllipsisBracket.addCellsToEmptyRules(e)}},{key:"addCell",value:function(e,t,n,r,o,i){throw new Error("BUG: We should not be subscribed to these events")}},{key:"removeCell",value:function(e,t,n,r,o){throw new Error("BUG: We should not be subscribed to these events")}},{key:"addFirstCell",value:function(e,t,n){}},{key:"removeFirstCell",value:function(e,t,n){if(this.checkInvariants(),e===this.beforeEllipsisBracket){if(this.linkages.deleteAllA(t),this.firstCells.has(t))throw new Error("BUG: Unreachable code")}else{if(e!==this.afterEllipsisBracket)throw new Error("BUG: Bracket should only ever be the before-ellipsis or after-ellipsis one");if(this.linkages.deleteAllB(t).size>0)throw new Error("BUG: Unreachable code")}this.checkInvariants()}},{key:"getMatches",value:function(e,t){var n,r,o=[];t?(n=this.beforeEllipsisBracket.getMatches(e,t.beforeEllipsisBracket),r=this.afterEllipsisBracket.getMatches(e,t.afterEllipsisBracket)):(n=this.beforeEllipsisBracket.getMatches(e,null),r=this.afterEllipsisBracket.getMatches(e,null));var i=new I;if(0===n.length||0===r.length)return[];switch(this.direction){case s.d.UP:case s.d.DOWN:var a=!0,l=!1,u=void 0;try{for(var f,h=n[Symbol.iterator]();!(a=(f=h.next()).done);a=!0){var p=f.value;i.add(p.lastCell().colIndex,p)}}catch(e){l=!0,u=e}finally{try{a||null==h.return||h.return()}finally{if(l)throw u}}var m=!0,y=!1,d=void 0;try{for(var v,b=r[Symbol.iterator]();!(m=(v=b.next()).done);m=!0){var g=v.value,$=g.firstCell(),_=$.colIndex,S=$.rowIndex,w=!0,E=!1,T=void 0;try{for(var O,R=(i.getB(_)||[])[Symbol.iterator]();!(w=(O=R.next()).done);w=!0){var k=O.value,L=k.lastCell().rowIndex;(this.direction===s.d.DOWN?L<S:S<L)&&o.push(new C(c(k.cellsAndNeighbors).concat(c(g.cellsAndNeighbors))))}}catch(e){E=!0,T=e}finally{try{w||null==R.return||R.return()}finally{if(E)throw T}}}}catch(e){y=!0,d=e}finally{try{m||null==b.return||b.return()}finally{if(y)throw d}}break;case s.d.LEFT:case s.d.RIGHT:var x=!0,A=!1,M=void 0;try{for(var N,P=n[Symbol.iterator]();!(x=(N=P.next()).done);x=!0){var D=N.value;i.add(D.lastCell().rowIndex,D)}}catch(e){A=!0,M=e}finally{try{x||null==P.return||P.return()}finally{if(A)throw M}}var G=!0,B=!1,F=void 0;try{for(var U,W=r[Symbol.iterator]();!(G=(U=W.next()).done);G=!0){var j=U.value,H=j.firstCell(),V=(S=H.rowIndex,_=H.colIndex,!0),q=!1,X=void 0;try{for(var z,K=(i.getB(S)||[])[Symbol.iterator]();!(V=(z=K.next()).done);V=!0){var Y=z.value,J=Y.lastCell().colIndex;(this.direction===s.d.RIGHT?J<_:_<J)&&o.push(new C(c(Y.cellsAndNeighbors).concat(c(j.cellsAndNeighbors))))}}catch(e){q=!0,X=e}finally{try{V||null==K.return||K.return()}finally{if(q)throw X}}}}catch(e){B=!0,F=e}finally{try{G||null==W.return||W.return()}finally{if(B)throw F}}break;default:throw new Error("BUG: Invalid direction ".concat(this.direction))}return o}},{key:"a11yGetSprites",value:function(){return[].concat(c(this.beforeEllipsisBracket.a11yGetSprites()),c(this.afterEllipsisBracket.a11yGetSprites()))}},{key:"checkInvariants",value:function(){if(this.firstCells.size!==this.linkages.sizeA())throw new Error("BUG: Invariant violation")}}]),t}();!function(e){e.ADD="ADD",e.REPLACE="REPLACE",e.REMOVE="REMOVE",e.MOVE="MOVE"}(M||(M={}));var P=function(){function e(t,n,r,o,i){if(b(this,e),!t)throw new Error("BUG: collisionLayer is not set");this.collisionLayer=t,this.actionTileWithModifier=n,this.mightNotFindConditionButThatIsOk=r,this.conditionSpritesToRemove=o,this.newDirection=i}return h(e,[{key:"replace",value:function(e,t,n){var r=!1,o=[];if(this.actionTileWithModifier){var i;if(this.actionTileWithModifier.isRandom()){var a=this.actionTileWithModifier._tile.getSprites();i=[a[Object(s.h)(a.length)]]}else if(this.actionTileWithModifier._tile.isOr()){var l=t.get(this.actionTileWithModifier._tile);if(!l)throw new Error("BUG: Magic OR tile not found\n".concat(this.actionTileWithModifier.toString()));i=l}else i=this.actionTileWithModifier._tile.getSprites();var u=[],c=[],f=!0,h=!1,p=void 0;try{for(var m,y=i[Symbol.iterator]();!(f=(m=y.next()).done);f=!0){var d=m.value,v=d.getCollisionLayer(),b=this.newDirection||e.getCollisionLayerWantsToMove(v),g=void 0;if(e.hasSprite(d)){if(!b)throw new Error("BUG: Invariant violation. if the sprite exists then wantsToMove must also exist (at least it would be STATIONARY)");g=e.updateSprite(d,b)}else{var $=e.getSpriteByCollisionLayer(v);$?c.push({oldSprite:$,newSprite:d}):u.push(d),g=e.addSprite(d,b)}r=r||g}}catch(e){h=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(h)throw p}}o.push({type:M.ADD,cell:e,sprites:u}),o.push({type:M.REPLACE,cell:e,replacements:c})}else{var _=new Set,S=e.getSpriteByCollisionLayer(this.collisionLayer);if(!S&&this.mightNotFindConditionButThatIsOk)return{didActuallyChange:!1,messages:[]};if(!S)throw new Error("BUG: No tile found");if(!this.conditionSpritesToRemove)throw new Error("BUG: Not implemented (just commented out)");if(this.conditionSpritesToRemove._tile.isOr()){if(!n.has(this.conditionSpritesToRemove._tile)){var w=S.getSprites(),E=!0,T=!1,O=void 0;try{for(var R,k=this.conditionSpritesToRemove._tile.getSprites()[Symbol.iterator]();!(E=(R=k.next()).done);E=!0){var L=R.value;if(w.indexOf(L)>=0){var x=e.removeSprite(L);_.add(L),r=r||x,x&&n.add(this.conditionSpritesToRemove._tile);break}}}catch(e){T=!0,O=e}finally{try{E||null==k.return||k.return()}finally{if(T)throw O}}}}else{var C=new Set(this.conditionSpritesToRemove._tile.getSprites()),A=!0,I=!1,N=void 0;try{for(var P,D=S.getSprites()[Symbol.iterator]();!(A=(P=D.next()).done);A=!0){var G=P.value;if(C.has(G)){var B=e.removeSprite(G);_.add(G),r=r||B}}}catch(e){I=!0,N=e}finally{try{A||null==D.return||D.return()}finally{if(I)throw N}}}o.push({type:M.REMOVE,cell:e,sprites:_})}return{didActuallyChange:r,messages:o}}}]),e}(),D=function(){function e(t,n,r){if(b(this,e),!t)throw new Error("BUG: collisionLayer is not set");this.collisionLayer=t,this.direction=n,this.mightNotFindConditionButThatIsOk=r}return h(e,[{key:"replace",value:function(e){var t=this.direction;if(this.mightNotFindConditionButThatIsOk&&!e.getSpriteByCollisionLayer(this.collisionLayer))return{didActuallyChange:!1};if(this.direction===s.d.RANDOMDIR){if(e.getCollisionLayerWantsToMove(this.collisionLayer)!==s.d.STATIONARY)return{didActuallyChange:!1};switch(Object(s.h)(4)){case 0:t=s.d.UP;break;case 1:t=s.d.DOWN;break;case 2:t=s.d.LEFT;break;case 3:t=s.d.RIGHT;break;default:throw new Error("BUG: invalid random number chosen")}}return{didActuallyChange:e.setWantsToMoveCollisionLayer(this.collisionLayer,t)}}}]),e}(),G=function(e){function t(e,n,r){var i;b(this,t),(i=m(this,y(t).call(this,e)))._tilesWithModifier=n,i.brackets=new Map,i.debugFlag=r,i.staticCache=new Map,i.spritesPresent=new a.a,i.spritesMissing=new a.a,i.anySpritesPresent=new Set,i.spriteMovementsPresent=new Map,i.orTileMovementsPresent=new Map,i.trickleCells=new Set,i.lruCache=new o.a($),i.cacheYesBitSets=new Map,i.cacheNoBitSets=new Map,i.cacheDirections=new Map,i.cacheMultiCollisionLayerTiles=new Set;var s=c(n),l=s.filter(function(e){return e.isNo()}),u=s.filter(function(e){return!e.isNo()}),f=!0,h=!1,p=void 0;try{for(var d,v=u[Symbol.iterator]();!(f=(d=v.next()).done);f=!0){var _=d.value;if(_._tile.hasSingleCollisionLayer()){var S=!0,w=!1,E=void 0;try{for(var T,O=_._tile.getSprites()[Symbol.iterator]();!(S=(T=O.next()).done);S=!0){var R=T.value,k=R.getCollisionLayer();_._direction&&i.cacheDirections.set(k,_._direction);var L=i.cacheYesBitSets.get(k);L||(L=new g,i.cacheYesBitSets.set(k,L)),L.set(k.getBitSetIndexOf(R))}}catch(e){w=!0,E=e}finally{try{S||null==O.return||O.return()}finally{if(w)throw E}}}else i.cacheMultiCollisionLayerTiles.add(_);if(_._tile.isOr())i.anySpritesPresent.add(new a.a(_._tile.getSprites())),_._direction&&i.orTileMovementsPresent.set(_._tile,_._direction);else{i.spritesPresent.addAll(_._tile.getSprites());var x=!0,C=!1,A=void 0;try{for(var M,I=_._tile.getSprites()[Symbol.iterator]();!(x=(M=I.next()).done);x=!0){var N=M.value;if(_._direction){var P=i.spriteMovementsPresent.get(N.getCollisionLayer());if(P&&P!==_._direction)throw new Error("BUG??? prev=".concat(P," ").concat(_._direction));i.spriteMovementsPresent.set(N.getCollisionLayer(),_._direction)}}}catch(e){C=!0,A=e}finally{try{x||null==I.return||I.return()}finally{if(C)throw A}}}}}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}var D=!0,G=!1,B=void 0;try{for(var F,U=l[Symbol.iterator]();!(D=(F=U.next()).done);D=!0){var W=F.value;if(W._tile.hasSingleCollisionLayer()){var j=!0,H=!1,V=void 0;try{for(var q,X=W._tile.getSprites()[Symbol.iterator]();!(j=(q=X.next()).done);j=!0){var z=q.value,K=z.getCollisionLayer();if(W._direction)throw new Error("BUG: Unreachable code");var Y=i.cacheNoBitSets.get(K);Y||(Y=new g,i.cacheNoBitSets.set(K,Y)),Y.set(K.getBitSetIndexOf(z))}}catch(e){H=!0,V=e}finally{try{j||null==X.return||X.return()}finally{if(H)throw V}}}else i.cacheMultiCollisionLayerTiles.add(W);W._tile.isOr(),i.spritesMissing.addAll(W._tile.getSprites())}}catch(e){G=!0,B=e}finally{try{D||null==U.return||U.return()}finally{if(G)throw B}}return i}return d(t,l["a"]),h(t,[{key:"toKey",value:function(){return"{".concat(c(this._tilesWithModifier).map(function(e){return e.toKey()}).sort().join(" ")," debugging?").concat(!!this.debugFlag,"}")}},{key:"dependsOnDirection",value:function(){return!!c(this._tilesWithModifier).find(function(e){return!!e._direction})}},{key:"prepareAction",value:function(e){if(!this.staticCache.has(e)){var t=new Map,n=new Map,r=!0,o=!1,i=void 0;try{for(var a,l=this._tilesWithModifier[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;if(c._tile.isOr()&&!c._tile.hasSingleCollisionLayer())c.isNo()||n.set(c._tile,c);else if(c._tile.hasSingleCollisionLayer()){var f=c._tile.getCollisionLayer();if(!f)throw new Error("BUG: Tile is not assigned to a collision layer\n".concat(c._tile.toString()));t.has(f)||t.set(f,new S(c,null,!1))}else{var h=!0,p=!1,m=void 0;try{for(var y,d=c._tile.getSprites()[Symbol.iterator]();!(h=(y=d.next()).done);h=!0){var v=y.value.getCollisionLayer();t.has(v)||t.set(v,new S(c,null,!1))}}catch(e){p=!0,m=e}finally{try{h||null==d.return||d.return()}finally{if(p)throw m}}}}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}var b=new Map(n.entries()),g=!0,$=!1,_=void 0;try{for(var w,E=e._tilesWithModifier[Symbol.iterator]();!(g=(w=E.next()).done);g=!0){var T=w.value;if(T._tile.isOr()&&!T._tile.hasSingleCollisionLayer()){var O=n.get(T._tile);if(O){b.delete(T._tile);var R=O;if(R._direction!==T._direction){var k=!0,x=!1,C=void 0;try{for(var A,M=T._tile.getSprites()[Symbol.iterator]();!(k=(A=M.next()).done);k=!0){var I=A.value,N=I.getCollisionLayer();t.has(N)||t.set(N,new S(new L(R.__source,R._isNegated,R._isRandom,R._direction,I,R._debugFlag),new L(T.__source,T._isNegated,T._isRandom,T._direction,I,T._debugFlag),!0))}}catch(e){x=!0,C=e}finally{try{k||null==M.return||M.return()}finally{if(x)throw C}}}}else if(T.isNo()){var G=!0,B=!1,F=void 0;try{for(var U,W=T._tile.getSprites()[Symbol.iterator]();!(G=(U=W.next()).done);G=!0){var j=U.value.getCollisionLayer();if(!t.has(j)){var H=new L(T.__source,!1,T._isRandom,T._direction,T._tile,T._debugFlag);t.set(j,new S(H,null,!0))}}}catch(e){B=!0,F=e}finally{try{G||null==W.return||W.return()}finally{if(B)throw F}}}else{var V=!0,q=!1,X=void 0;try{for(var z,K=T._tile.getSprites()[Symbol.iterator]();!(V=(z=K.next()).done);V=!0){var Y=z.value.getCollisionLayer();if(!t.has(Y)){var J=new L(T.__source,!1,T._isRandom,T._direction,T._tile,T._debugFlag);t.set(Y,new S(null,J,!0))}}}catch(e){q=!0,X=e}finally{try{V||null==K.return||K.return()}finally{if(q)throw X}}}}else{var Z=!0,Q=!1,ee=void 0;try{for(var te,ne=T.getCollisionLayers()[Symbol.iterator]();!(Z=(te=ne.next()).done);Z=!0){var re=te.value;if(!re)throw new Error("BUG: Tile is not assigned to a collision layer.\n".concat(T._tile.toString()));var oe=t.get(re),ie=oe&&oe.condition||null;if(ie&&ie.equals(T))t.delete(re);else if(T.isNo())if(oe){if(oe.condition===T)throw new Error("BUG: Unreachable code")}else{var ae=new L(T.__source,!1,!1,T._direction,T._tile,T._debugFlag);t.set(re,new S(ae,null,!0))}else oe?oe.action=T:t.set(re,new S(null,T,!1))}}catch(e){Q=!0,ee=e}finally{try{Z||null==ne.return||ne.return()}finally{if(Q)throw ee}}}}}catch(e){$=!0,_=e}finally{try{g||null==E.return||E.return()}finally{if($)throw _}}if(b.size>0){var se=!0,le=!1,ue=void 0;try{for(var ce,fe=b.values()[Symbol.iterator]();!(se=(ce=fe.next()).done);se=!0){var he=ce.value,pe=!0,me=!1,ye=void 0;try{for(var de,ve=he._tile.getSprites()[Symbol.iterator]();!(pe=(de=ve.next()).done);pe=!0){var be=de.value.getCollisionLayer();if(!t.has(be)){var ge=new L(he.__source,!1,!1,he._direction,he._tile,he._debugFlag);t.set(be,new S(ge,null,!0))}}}catch(e){me=!0,ye=e}finally{try{pe||null==ve.return||ve.return()}finally{if(me)throw ye}}}}catch(e){le=!0,ue=e}finally{try{se||null==fe.return||fe.return()}finally{if(le)throw ue}}}var $e=new Set,_e=new Set,Se=!0,we=!1,Ee=void 0;try{for(var Te,Oe=t.entries()[Symbol.iterator]();!(Se=(Te=Oe.next()).done);Se=!0){var Re=u(Te.value,2),ke=Re[0],Le=Re[1],xe=Le.condition,Ce=Le.action,Ae=Le.extra;if(xe&&Ce){if(xe!==Ce){var Me=null;(xe._direction!==Ce._direction||xe.isNo())&&(Me=Ce._direction||s.d.STATIONARY),!xe._tile.equals(Ce._tile)||xe.isNo()?$e.add(new P(ke,Ce,Ae,null,Me)):Me&&_e.add(new D(ke,Me,Ae))}}else xe?xe.isNo()||$e.add(new P(ke,null,Ae,xe,null)):Ce&&(Ce.isNo()||$e.add(new P(ke,Ce,Ae,null,Ce._direction||s.d.STATIONARY)))}}catch(e){we=!0,Ee=e}finally{try{Se||null==Oe.return||Oe.return()}finally{if(we)throw Ee}}this.staticCache.set(e,{replaceTiles:$e,replaceDirections:_e})}}},{key:"evaluate",value:function(e,t,n){var r=this.staticCache.get(e);if(!r)throw new Error("BUG: Missing actionNeighbor. Should have been prepared before");var o=r.replaceTiles,i=r.replaceDirections,a=!1,s=!1,l=new Set,u=[],f=!0,h=!1,p=void 0;try{for(var m,y=o[Symbol.iterator]();!(f=(m=y.next()).done);f=!0){var d=m.value.replace(t,n,l),v=d.didActuallyChange,b=d.messages;v&&(u=[].concat(c(u),c(b))),a=a||v||!1}}catch(e){h=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(h)throw p}}var g=!0,$=!1,_=void 0;try{for(var S,E=i[Symbol.iterator]();!(g=(S=E.next()).done);g=!0){v=S.value.replace(t).didActuallyChange;s=s||v}}catch(e){$=!0,_=e}finally{try{g||null==E.return||E.return()}finally{if($)throw _}}return a||s?new w(t,u):null}},{key:"clearCaches",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this._tilesWithModifier[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.clearCaches()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"populateMagicOrTiles",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this._tilesWithModifier[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;if(!l.isNo()&&l._tile.isOr()){var u=Object(s.o)(new Set(l._tile.getSprites()),e.getSpritesAsSet());t.set(l._tile,u)}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"subscribeToTileChanges",value:function(e,t){var n=this,r=this.brackets.get(e);r||(r=new Set,this.brackets.set(e,r)),r.add(t),this._tilesWithModifier.forEach(function(e){e.subscribeToCellChanges(n)})}},{key:"matchesCellSimple",value:function(e){return this.matchesCell(e,null,null)}},{key:"addCells",value:function(e,t,n,r){var o=!0,i=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;if(this.matchesTiles(c)){this.trickleCells.add(c);var f=!0,h=!1,p=void 0;try{for(var m,y=this.brackets.entries()[Symbol.iterator]();!(f=(m=y.next()).done);f=!0){var d=u(m.value,2),v=d[0],b=d[1],g=!0,$=!1,_=void 0;try{for(var S,w=b[Symbol.iterator]();!(g=(S=w.next()).done);g=!0){var E=S.value;v.addCell(E,this,e,t,c,r)}}catch(e){$=!0,_=e}finally{try{g||null==w.return||w.return()}finally{if($)throw _}}}}catch(e){h=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(h)throw p}}}else if(this.trickleCells.has(c))throw new Error("BUG: Should be unreachable")}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}}},{key:"updateCells",value:function(e,t,n,r){this.addCells(e,t,n,r)}},{key:"removeCells",value:function(e,t,n){var r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(!this.matchesTiles(l)){this.trickleCells.delete(l);var c=!0,f=!1,h=void 0;try{for(var p,m=this.brackets.entries()[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var y=u(p.value,2),d=y[0],v=y[1],b=!0,g=!1,$=void 0;try{for(var _,S=v[Symbol.iterator]();!(b=(_=S.next()).done);b=!0){var w=_.value;d.removeCell(w,this,e,t,l)}}catch(e){g=!0,$=e}finally{try{b||null==S.return||S.return()}finally{if(g)throw $}}}}catch(e){f=!0,h=e}finally{try{c||null==m.return||m.return()}finally{if(f)throw h}}}}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}},{key:"matchesCell",value:function(e,t,n){var r=this;return this.lruCache.get("[".concat(e.toKey(),"]"),function(){var t=e.spriteBitSet.containsAll(r.spritesPresent)&&e.spriteBitSet.containsNone(r.spritesMissing);if(t){var n=!0,o=!1,i=void 0;try{for(var a,s=r.anySpritesPresent[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;t=t&&e.spriteBitSet.containsAny(l)}}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}}if(t){var c=!0,f=!1,h=void 0;try{for(var p,m=r.spriteMovementsPresent[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var y=u(p.value,2),d=y[0];y[1]!==e.getCollisionLayerWantsToMove(d)&&(t=!1)}}catch(e){f=!0,h=e}finally{try{c||null==m.return||m.return()}finally{if(f)throw h}}}if(t){var v=!0,b=!1,g=void 0;try{for(var $,_=r.orTileMovementsPresent[Symbol.iterator]();!(v=($=_.next()).done);v=!0){var S=u($.value,2),w=S[0],E=S[1];if(w.hasSingleCollisionLayer())E!==e.getCollisionLayerWantsToMove(w.getCollisionLayer())&&(t=!1);else{var T=!1,O=!1,R=!0,k=!1,L=void 0;try{for(var x,C=w.getSprites()[Symbol.iterator]();!(R=(x=C.next()).done);R=!0){var A=x.value;e.spriteBitSet.has(A)&&(T=!0,E===e.getCollisionLayerWantsToMove(A.getCollisionLayer())&&(O=!0))}}catch(e){k=!0,L=e}finally{try{R||null==C.return||C.return()}finally{if(k)throw L}}if(t=t&&O,!T)throw new Error("BUG: Could not find sprite. One should have already been matched before")}}}catch(e){b=!0,g=e}finally{try{v||null==_.return||_.return()}finally{if(b)throw g}}}return t})}},{key:"matchesTiles",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this._tilesWithModifier[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(!o.value.hasCell(e))return!1}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return!0}}]),t}()}).call(this,n(106))},function(e,t,n){var r=n(62)("wks"),o=n(41),i=n(4).Symbol,a="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=r},function(e,t,n){var r=n(27),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){e.exports=!n(5)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(3),o=n(109),i=n(30),a=Object.defineProperty;t.f=n(10)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(31);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){for(var n=1,r=1,o=0,i=0,a=null,s=null,l=-1;o<t;){var u=e.charAt(o++);"\n"===u?(n++,r=1,l=i,i=o):"\r"!==u&&r++}var c=e.indexOf("\n",i);if(-1===c)c=e.length;else{var f=e.indexOf("\n",c+1);a=(a=-1===f?e.slice(c):e.slice(c,f)).replace(/^\r?\n/,"").replace(/\r$/,"")}return l>=0&&(s=e.slice(l,i).replace(/\r?\n$/,"")),{lineNum:n,colNum:r,line:e.slice(i,c).replace(/\r$/,""),prevLine:s,nextLine:a}}n.d(t,"a",function(){return i});var i=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new Error("BUG: failed to provide the source when constructing this object");this.__source=t,this.__coverageCount=null}var t,n,i;return t=e,(n=[{key:"__getSourceLineAndColumn",value:function(){var e=this.__source;return o(e.code,e.sourceOffset)}},{key:"toString",value:function(){var e=this.__source,t=o(e.code,e.sourceOffset),n=t.lineNum,r=t.colNum,i=t.line;return"".concat(i,"\nSource: ").concat(n,":").concat(r)}},{key:"toSourceString",value:function(){var e=this.__source,t=o(e.code,e.sourceOffset).lineNum;return e.code.split("\n")[t-1]}},{key:"__getLineAndColumnRange",value:function(){var e=this.__source,t=o(e.code,e.sourceOffset),n=t.lineNum,r=t.colNum;return{start:{line:n,col:r},end:{line:n,col:r+1}}}},{key:"__incrementCoverage",value:function(){0}}])&&r(t.prototype,n),i&&r(t,i),e}()},function(e,t,n){"use strict";n.d(t,"d",function(){return y}),n.d(t,"f",function(){return d}),n.d(t,"e",function(){return v}),n.d(t,"c",function(){return g}),n.d(t,"a",function(){return $}),n.d(t,"b",function(){return _});var r=n(0),o=n(13);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=n(105),y=function(e){function t(e,n,r){var o;return s(this,t),(o=c(this,f(t).call(this,e))).name=n,o._optionalLegendChar=r,o.trickleCells=new Set,o.trickleTiles=new Set,o.trickleTilesWithModifier=new Set,o.allSpritesBitSetIndex=-1,o.collisionLayer=null,o.bitSet=null,o}return h(t,o["a"]),u(t,[{key:"isOr",value:function(){return!1}},{key:"equals",value:function(e){return this===e}},{key:"getName",value:function(){return this.name}},{key:"isBackground",value:function(){return"background"===this.name.toLowerCase()}},{key:"_getDescendantTiles",value:function(){return[]}},{key:"getSprites",value:function(){return[this]}},{key:"hasCollisionLayer",value:function(){return!!this.collisionLayer}},{key:"hasSingleCollisionLayer",value:function(){return this.hasCollisionLayer()}},{key:"setCollisionLayer",value:function(e){this.collisionLayer=e}},{key:"setCollisionLayerAndIndex",value:function(e,t){this.collisionLayer=e,this.bitSet=new m,this.bitSet.set(t)}},{key:"getCollisionLayer",value:function(){if(!this.collisionLayer)throw new Error("ERROR: This sprite was not in a Collision Layer\n".concat(this.toString()));return this.collisionLayer}},{key:"clearCaches",value:function(){this.trickleCells.clear()}},{key:"hasCell",value:function(e){return this.trickleCells.has(e)}},{key:"matchesCell",value:function(e){return e.getSpritesAsSet().has(this)}},{key:"getSpritesThatMatch",value:function(e){return e.getSpritesAsSet().has(this)?new Set([this]):new Set}},{key:"subscribeToCellChanges",value:function(e){this.trickleTilesWithModifier.add(e)}},{key:"subscribeToCellChangesTile",value:function(e){this.trickleTiles.add(e)}},{key:"addCell",value:function(e,t){this.addCells(this,[e],t)}},{key:"removeCell",value:function(e){this.removeCells(this,[e])}},{key:"updateCell",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.trickleTiles[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.updateCells(this,[e],t)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}var s=!0,l=!1,u=void 0;try{for(var c,f=this.trickleTilesWithModifier[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){c.value.updateCells(this,[e],t)}}catch(e){l=!0,u=e}finally{try{s||null==f.return||f.return()}finally{if(l)throw u}}}},{key:"addCells",value:function(e,t,n){var r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(this.trickleCells.has(l))throw new Error("BUG: should not be trying to add a cell that has already been matched (right?)");this.trickleCells.add(l)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}var u=!0,c=!1,f=void 0;try{for(var h,p=this.trickleTiles[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){h.value.addCells(this,t,n)}}catch(e){c=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw f}}var m=!0,y=!1,d=void 0;try{for(var v,b=this.trickleTilesWithModifier[Symbol.iterator]();!(m=(v=b.next()).done);m=!0){v.value.addCells(this,this,t,n)}}catch(e){y=!0,d=e}finally{try{m||null==b.return||b.return()}finally{if(y)throw d}}}},{key:"updateCells",value:function(e,t,n){throw new Error("BUG: Unreachable code")}},{key:"removeCells",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;this.trickleCells.delete(s)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}var l=!0,u=!1,c=void 0;try{for(var f,h=this.trickleTiles[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){f.value.removeCells(this,t)}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}var p=!0,m=!1,y=void 0;try{for(var d,v=this.trickleTilesWithModifier[Symbol.iterator]();!(p=(d=v.next()).done);p=!0){d.value.removeCells(this,this,t)}}catch(e){m=!0,y=e}finally{try{p||null==v.return||v.return()}finally{if(m)throw y}}}},{key:"has",value:function(e){return this.trickleCells.has(e)}},{key:"hasNegationTileWithModifier",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.trickleTilesWithModifier[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){if(r.value.isNo())return!0}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}var i=!0,a=!1,s=void 0;try{for(var l,u=this.trickleTiles[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){if(l.value.hasNegationTileWithModifier())return!0}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return!1}},{key:"getCellsThatMatch",value:function(e){var t=this;return this.trickleCells.size>0?this.trickleCells:e?new Set(a(e).filter(function(e){return t.matchesCell(e)})):new Set}}]),t}(),d=function(e){function t(e,n,r,o){var i;return s(this,t),(i=c(this,f(t).call(this,e,n,r))).color=o[0],i}return h(t,y),u(t,[{key:"isTransparent",value:function(){return this.color.isTransparent()}},{key:"hasPixels",value:function(){return!1}},{key:"getPixels",value:function(e,t){for(var n=[],r=0;r<e;r++){n.push([]);for(var o=0;o<t;o++)n[r].push(this.color)}return n}}]),t}(),v=function(e){function t(e,n,r,o){var i;s(this,t),(i=c(this,f(t).call(this,e,n,r))).pixels=o,i._isTransparent=!0;var a=!0,l=!1,u=void 0;try{for(var h,p=o[Symbol.iterator]();!(a=(h=p.next()).done);a=!0){var m=h.value,y=!0,d=!1,v=void 0;try{for(var b,g=m[Symbol.iterator]();!(y=(b=g.next()).done);y=!0){if(!b.value.isTransparent()){i._isTransparent=!1;break}}}catch(e){d=!0,v=e}finally{try{y||null==g.return||g.return()}finally{if(d)throw v}}}}catch(e){l=!0,u=e}finally{try{a||null==p.return||p.return()}finally{if(l)throw u}}return i}return h(t,y),u(t,[{key:"isTransparent",value:function(){return this._isTransparent}},{key:"getSprites",value:function(){return[this]}},{key:"hasPixels",value:function(){return!0}},{key:"getPixels",value:function(e,t){return this.pixels.map(function(e){return e.map(function(e){return e})})}}]),t}(),b=function(e){function t(e,n,r){var o;return s(this,t),(o=c(this,f(t).call(this,e))).spriteNameOrLevelChar=n,o.tiles=r,o.trickleCells=new Set,o.trickleTilesWithModifier=new Set,o.collisionLayer=null,o.spritesCache=null,o}return h(t,o["a"]),u(t,[{key:"equals",value:function(e){return this.isOr()===e.isOr()&&0===Object(r.m)(new Set(this.getSprites()),e.getSprites()).size}},{key:"isOr",value:function(){return!1}},{key:"getName",value:function(){return this.spriteNameOrLevelChar}},{key:"_getDescendantTiles",value:function(){return this.tiles.concat(Object(r.g)(this.tiles.map(function(e){return e._getDescendantTiles()})))}},{key:"getSprites",value:function(){return this.spritesCache||(this.spritesCache=Object(r.g)(this.tiles.map(function(e){return e.getSprites()})).sort(function(e,t){return e.getCollisionLayer().id-t.getCollisionLayer().id}).reverse()),this.spritesCache}},{key:"setCollisionLayer",value:function(e){this.collisionLayer=e}},{key:"getCollisionLayer",value:function(){if(this.collisionLayer)return this.collisionLayer;var e=this.getSprites()[0].getCollisionLayer(),t=!0,n=!1,r=void 0;try{for(var o,i=this.getSprites()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(o.value.getCollisionLayer()!==e)throw new Error("ooh, sprites in a tile have different collision layers... that's a problem\n".concat(this.toString()))}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"getCollisionLayers",value:function(){var e=new Set,t=!0,n=!1,r=void 0;try{for(var o,i=this.getSprites()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value;e.add(s.getCollisionLayer())}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return a(e)}},{key:"getCellsThatMatch",value:function(e){var t=new Set,n=!0,r=!1,o=void 0;try{for(var i,a=this.getSprites()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l=!0,u=!1,c=void 0;try{for(var f,h=s.getCellsThatMatch(e)[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var p=f.value;t.add(p)}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}},{key:"subscribeToCellChanges",value:function(e){this.trickleTilesWithModifier.add(e);var t=!0,n=!1,r=void 0;try{for(var o,i=this.getSprites()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.subscribeToCellChangesTile(this)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"hasNegationTileWithModifier",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.trickleTilesWithModifier[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){if(r.value.isNo())return!0}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}return!1}},{key:"addCells",value:function(e,t,n){var r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(!this.trickleCells.has(l)&&this.matchesCell(l)){this.trickleCells.add(l);var u=!0,c=!1,f=void 0;try{for(var h,p=this.trickleTilesWithModifier[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){h.value.addCells(this,e,[l],n)}}catch(e){c=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw f}}}}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}},{key:"updateCells",value:function(e,t,n){var r=!0,o=!1,i=void 0;try{for(var a,s=this.trickleTilesWithModifier[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){a.value.updateCells(e,t,n)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}},{key:"removeCells",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(this.matchesCell(s))this.trickleCells.has(s)?this.updateCells(e,[s],null):this.addCells(e,[s],null);else{this.trickleCells.delete(s);var l=!0,u=!1,c=void 0;try{for(var f,h=this.trickleTilesWithModifier[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){f.value.removeCells(this,e,[s])}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"hasCell",value:function(e){return this.trickleCells.has(e)}}]),t}(),g=function(e){function t(e,n,r){return s(this,t),c(this,f(t).call(this,e,n,[r]))}return h(t,b),u(t,[{key:"matchesCell",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.tiles[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(!o.value.matchesCell(e))return!1}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return!0}},{key:"getSpritesThatMatch",value:function(e){return Object(r.o)(new Set(this.getSprites()),e.getSpritesAsSet())}},{key:"hasSingleCollisionLayer",value:function(){return!!this.collisionLayer}}]),t}(),$=function(e){function t(){return s(this,t),c(this,f(t).apply(this,arguments))}return h(t,b),u(t,[{key:"matchesCell",value:function(e){throw new Error("BUG: Unreachable code")}},{key:"getSpritesThatMatch",value:function(e){throw new Error("BUG: This method should only be called for OR tiles")}},{key:"hasSingleCollisionLayer",value:function(){return!!this.collisionLayer}}]),t}(),_=function(e){function t(){return s(this,t),c(this,f(t).apply(this,arguments))}return h(t,b),u(t,[{key:"isOr",value:function(){return!0}},{key:"matchesCell",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.tiles[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(o.value.matchesCell(e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return!1}},{key:"getSpritesThatMatch",value:function(e){return Object(r.o)(new Set(this.getSprites()),e.getSpritesAsSet())}},{key:"hasSingleCollisionLayer",value:function(){var e=this.getSprites(),t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(o.value.getCollisionLayer()!==e[0].getCollisionLayer())return!1}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return!0}}]),t}()},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(11),o=n(40);e.exports=n(10)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(4),o=n(16),i=n(20),a=n(41)("src"),s=Function.toString,l=(""+s).split("toString");n(24).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var u="function"==typeof n;u&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(u&&(i(n,a)||o(n,a,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(e,t,n){var r=n(1),o=n(5),i=n(31),a=/"/g,s=function(e,t,n,r){var o=String(i(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+o+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*o(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",n)}},function(e,t,n){"use strict";(function(e){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o;n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s}),function(e){e.SEVERE="SEVERE",e.WARN="WARN",e.INFO="INFO",e.DEBUG="DEBUG",e.TRACE="TRACE"}(o||(o={}));var i=[o.SEVERE,o.WARN,o.INFO,o.DEBUG,o.TRACE];function a(e){return i.indexOf(e)}var s=new(function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentLevelNum=a(function(e){if(!e)return o.SEVERE;switch(e.toUpperCase()){case o.SEVERE:return o.SEVERE;case o.DEBUG:return o.DEBUG;case o.TRACE:return o.TRACE;default:throw new Error("ERROR: Invalid log level. valid levels are ".concat(JSON.stringify(i)))}}(e.env.LOG_LEVEL))}var n,s,l;return n=t,(s=[{key:"isLevel",value:function(e){return a(e)<=this.currentLevelNum}},{key:"warn",value:function(e){this.log(o.WARN,e)}},{key:"info",value:function(e){this.log(o.INFO,e)}},{key:"debug",value:function(e){this.log(o.DEBUG,e)}},{key:"trace",value:function(e){this.log(o.TRACE,e)}},{key:"logFn",value:function(e,t){this.isLevel(e)&&console.warn(t())}},{key:"log",value:function(e,t){"string"==typeof t?this.logFn(e,function(){return t}):this.logFn(e,t)}}])&&r(n.prototype,s),l&&r(n,l),t}())}).call(this,n(106))},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(57),o=n(31);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(58),o=n(40),i=n(21),a=n(30),s=n(20),l=n(109),u=Object.getOwnPropertyDescriptor;t.f=n(10)?u:function(e,t){if(e=i(e),t=a(t,!0),l)try{return u(e,t)}catch(e){}if(s(e,t))return o(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(20),o=n(12),i=n(80)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t){var n=e.exports={version:"2.6.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(15);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){"use strict";var r=n(5);e.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t,n){"use strict";n.d(t,"a",function(){return p}),n.d(t,"b",function(){return m});var r=n(13);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var h=function e(t,n,r){f(this,e),this.r=t,this.g=n,this.b=r},p=function(e){function t(e,n){var r;return f(this,t),(r=s(this,l(t).call(this,e))).hex=n,r}return u(t,r["a"]),a(t,[{key:"isTransparent",value:function(){return!1}},{key:"toRgb",value:function(){return function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,r){return t+t+n+n+r+r});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(t)return new h(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16));throw new Error("BUG: hex color was invalid")}(this.hex)}},{key:"toHex",value:function(){return this.hex}}]),t}(),m=function(e){function t(e){return f(this,t),s(this,l(t).call(this,e))}return u(t,r["a"]),a(t,[{key:"isTransparent",value:function(){return!0}},{key:"toRgb",value:function(){throw new Error("BUG: Transparent colors do not have RGB data")}},{key:"toHex",value:function(){throw new Error("BUG: Transparent colors do not have a hex color value")}}]),t}()},function(e,t,n){var r=n(6);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(1),o=n(24),i=n(5);e.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*i(function(){n(1)}),"Object",a)}},function(e,t,n){var r=n(25),o=n(57),i=n(12),a=n(9),s=n(96);e.exports=function(e,t){var n=1==e,l=2==e,u=3==e,c=4==e,f=6==e,h=5==e||f,p=t||s;return function(t,s,m){for(var y,d,v=i(t),b=o(v),g=r(s,m,3),$=a(b.length),_=0,S=n?p(t,$):l?p(t,0):void 0;$>_;_++)if((h||_ in b)&&(d=g(y=b[_],_,v),e))if(n)S[_]=d;else if(d)switch(e){case 3:return!0;case 5:return y;case 6:return _;case 2:S.push(y)}else if(c)return!1;return f?-1:u||c?c:S}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}if(n(10)){var o=n(37),i=n(4),a=n(5),s=n(1),l=n(73),u=n(104),c=n(25),f=n(47),h=n(40),p=n(16),m=n(49),y=n(27),d=n(9),v=n(137),b=n(43),g=n(30),$=n(20),_=n(51),S=n(6),w=n(12),E=n(93),T=n(44),O=n(23),R=n(45).f,k=n(95),L=n(41),x=n(8),C=n(33),A=n(63),M=n(60),I=n(98),N=n(53),P=n(68),D=n(46),G=n(97),B=n(126),F=n(11),U=n(22),W=F.f,j=U.f,H=i.RangeError,V=i.TypeError,q=i.Uint8Array,X=Array.prototype,z=u.ArrayBuffer,K=u.DataView,Y=C(0),J=C(2),Z=C(3),Q=C(4),ee=C(5),te=C(6),ne=A(!0),re=A(!1),oe=I.values,ie=I.keys,ae=I.entries,se=X.lastIndexOf,le=X.reduce,ue=X.reduceRight,ce=X.join,fe=X.sort,he=X.slice,pe=X.toString,me=X.toLocaleString,ye=x("iterator"),de=x("toStringTag"),ve=L("typed_constructor"),be=L("def_constructor"),ge=l.CONSTR,$e=l.TYPED,_e=l.VIEW,Se=C(1,function(e,t){return Re(M(e,e[be]),t)}),we=a(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ee=!!q&&!!q.prototype.set&&a(function(){new q(1).set({})}),Te=function(e,t){var n=y(e);if(n<0||n%t)throw H("Wrong offset!");return n},Oe=function(e){if(S(e)&&$e in e)return e;throw V(e+" is not a typed array!")},Re=function(e,t){if(!(S(e)&&ve in e))throw V("It is not a typed array constructor!");return new e(t)},ke=function(e,t){return Le(M(e,e[be]),t)},Le=function(e,t){for(var n=0,r=t.length,o=Re(e,r);r>n;)o[n]=t[n++];return o},xe=function(e,t,n){W(e,t,{get:function(){return this._d[n]}})},Ce=function(e){var t,n,r,o,i,a,s=w(e),l=arguments.length,u=l>1?arguments[1]:void 0,f=void 0!==u,h=k(s);if(null!=h&&!E(h)){for(a=h.call(s),r=[],t=0;!(i=a.next()).done;t++)r.push(i.value);s=r}for(f&&l>2&&(u=c(u,arguments[2],2)),t=0,n=d(s.length),o=Re(this,n);n>t;t++)o[t]=f?u(s[t],t):s[t];return o},Ae=function(){for(var e=0,t=arguments.length,n=Re(this,t);t>e;)n[e]=arguments[e++];return n},Me=!!q&&a(function(){me.call(new q(1))}),Ie=function(){return me.apply(Me?he.call(Oe(this)):Oe(this),arguments)},Ne={copyWithin:function(e,t){return B.call(Oe(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return Q(Oe(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return G.apply(Oe(this),arguments)},filter:function(e){return ke(this,J(Oe(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return ee(Oe(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return te(Oe(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){Y(Oe(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return re(Oe(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return ne(Oe(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return ce.apply(Oe(this),arguments)},lastIndexOf:function(e){return se.apply(Oe(this),arguments)},map:function(e){return Se(Oe(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return le.apply(Oe(this),arguments)},reduceRight:function(e){return ue.apply(Oe(this),arguments)},reverse:function(){for(var e,t=Oe(this).length,n=Math.floor(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this},some:function(e){return Z(Oe(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return fe.call(Oe(this),e)},subarray:function(e,t){var n=Oe(this),r=n.length,o=b(e,r);return new(M(n,n[be]))(n.buffer,n.byteOffset+o*n.BYTES_PER_ELEMENT,d((void 0===t?r:b(t,r))-o))}},Pe=function(e,t){return ke(this,he.call(Oe(this),e,t))},De=function(e){Oe(this);var t=Te(arguments[1],1),n=this.length,r=w(e),o=d(r.length),i=0;if(o+t>n)throw H("Wrong length!");for(;i<o;)this[t+i]=r[i++]},Ge={entries:function(){return ae.call(Oe(this))},keys:function(){return ie.call(Oe(this))},values:function(){return oe.call(Oe(this))}},Be=function(e,t){return S(e)&&e[$e]&&"symbol"!=r(t)&&t in e&&String(+t)==String(t)},Fe=function(e,t){return Be(e,t=g(t,!0))?h(2,e[t]):j(e,t)},Ue=function(e,t,n){return!(Be(e,t=g(t,!0))&&S(n)&&$(n,"value"))||$(n,"get")||$(n,"set")||n.configurable||$(n,"writable")&&!n.writable||$(n,"enumerable")&&!n.enumerable?W(e,t,n):(e[t]=n.value,e)};ge||(U.f=Fe,F.f=Ue),s(s.S+s.F*!ge,"Object",{getOwnPropertyDescriptor:Fe,defineProperty:Ue}),a(function(){pe.call({})})&&(pe=me=function(){return ce.call(this)});var We=m({},Ne);m(We,Ge),p(We,ye,Ge.values),m(We,{slice:Pe,set:De,constructor:function(){},toString:pe,toLocaleString:Ie}),xe(We,"buffer","b"),xe(We,"byteOffset","o"),xe(We,"byteLength","l"),xe(We,"length","e"),W(We,de,{get:function(){return this[$e]}}),e.exports=function(e,t,n,r){var u=e+((r=!!r)?"Clamped":"")+"Array",c="get"+e,h="set"+e,m=i[u],y=m||{},b=m&&O(m),g=!m||!l.ABV,$={},w=m&&m.prototype,E=function(e,n){W(e,n,{get:function(){return function(e,n){var r=e._d;return r.v[c](n*t+r.o,we)}(this,n)},set:function(e){return function(e,n,o){var i=e._d;r&&(o=(o=Math.round(o))<0?0:o>255?255:255&o),i.v[h](n*t+i.o,o,we)}(this,n,e)},enumerable:!0})};g?(m=n(function(e,n,r,o){f(e,m,u,"_d");var i,a,s,l,c=0,h=0;if(S(n)){if(!(n instanceof z||"ArrayBuffer"==(l=_(n))||"SharedArrayBuffer"==l))return $e in n?Le(m,n):Ce.call(m,n);i=n,h=Te(r,t);var y=n.byteLength;if(void 0===o){if(y%t)throw H("Wrong length!");if((a=y-h)<0)throw H("Wrong length!")}else if((a=d(o)*t)+h>y)throw H("Wrong length!");s=a/t}else s=v(n),i=new z(a=s*t);for(p(e,"_d",{b:i,o:h,l:a,e:s,v:new K(i)});c<s;)E(e,c++)}),w=m.prototype=T(We),p(w,"constructor",m)):a(function(){m(1)})&&a(function(){new m(-1)})&&P(function(e){new m,new m(null),new m(1.5),new m(e)},!0)||(m=n(function(e,n,r,o){var i;return f(e,m,u),S(n)?n instanceof z||"ArrayBuffer"==(i=_(n))||"SharedArrayBuffer"==i?void 0!==o?new y(n,Te(r,t),o):void 0!==r?new y(n,Te(r,t)):new y(n):$e in n?Le(m,n):Ce.call(m,n):new y(v(n))}),Y(b!==Function.prototype?R(y).concat(R(b)):R(y),function(e){e in m||p(m,e,y[e])}),m.prototype=w,o||(w.constructor=m));var k=w[ye],L=!!k&&("values"==k.name||null==k.name),x=Ge.values;p(m,ve,!0),p(w,$e,u),p(w,_e,!0),p(w,be,m),(r?new m(1)[de]==u:de in w)||W(w,de,{get:function(){return u}}),$[u]=m,s(s.G+s.W+s.F*(m!=y),$),s(s.S,u,{BYTES_PER_ELEMENT:t}),s(s.S+s.F*a(function(){y.of.call(m,1)}),u,{from:Ce,of:Ae}),"BYTES_PER_ELEMENT"in w||p(w,"BYTES_PER_ELEMENT",t),s(s.P,u,Ne),D(u),s(s.P+s.F*Ee,u,{set:De}),s(s.P+s.F*!L,u,Ge),o||w.toString==pe||(w.toString=pe),s(s.P+s.F*a(function(){new m(1).slice()}),u,{slice:Pe}),s(s.P+s.F*(a(function(){return[1,2].toLocaleString()!=new m([1,2]).toLocaleString()})||!a(function(){w.toLocaleString.call([1,2])})),u,{toLocaleString:Ie}),N[u]=L?k:x,o||L||p(w,ye,x)}}else e.exports=function(){}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(132),i=n(1),a=n(62)("metadata"),s=a.store||(a.store=new(n(135))),l=function(e,t,n){var r=s.get(e);if(!r){if(!n)return;s.set(e,r=new o)}var i=r.get(t);if(!i){if(!n)return;r.set(t,i=new o)}return i};e.exports={store:s,map:l,has:function(e,t,n){var r=l(t,n,!1);return void 0!==r&&r.has(e)},get:function(e,t,n){var r=l(t,n,!1);return void 0===r?void 0:r.get(e)},set:function(e,t,n,r){l(n,r,!0).set(e,t)},keys:function(e,t){var n=l(e,t,!1),r=[];return n&&n.forEach(function(e,t){r.push(t)}),r},key:function(e){return void 0===e||"symbol"==r(e)?e:String(e)},exp:function(e){i(i.S,"Reflect",e)}}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(41)("meta"),i=n(6),a=n(20),s=n(11).f,l=0,u=Object.isExtensible||function(){return!0},c=!n(5)(function(){return u(Object.preventExtensions({}))}),f=function(e){s(e,o,{value:{i:"O"+ ++l,w:{}}})},h=e.exports={KEY:o,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==r(e)?e:("string"==typeof e?"S":"P")+e;if(!a(e,o)){if(!u(e))return"F";if(!t)return"E";f(e)}return e[o].i},getWeak:function(e,t){if(!a(e,o)){if(!u(e))return!0;if(!t)return!1;f(e)}return e[o].w},onFreeze:function(e){return c&&h.NEED&&u(e)&&!a(e,o)&&f(e),e}}},function(e,t){e.exports=!1},function(e,t,n){var r=n(8)("unscopables"),o=Array.prototype;null==o[r]&&n(16)(o,r,{}),e.exports=function(e){o[r][e]=!0}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}n.d(t,"a",function(){return h});var c=n(105),f=function(){function e(t,n){s(this,e),this.bitSet=n||new c,t&&this.addAll(t)}return u(e,[{key:"isEmpty",value:function(){return this.bitSet.isEmpty()}},{key:"addAll",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.add(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"add",value:function(e){this.bitSet.set(this._indexOf(e))}},{key:"remove",value:function(e){this.bitSet.clear(this._indexOf(e))}},{key:"has",value:function(e){return!!this.bitSet.get(this._indexOf(e))}},{key:"containsAll",value:function(e){return e.bitSet.cardinality()===this.bitSet.and(e.bitSet).cardinality()}},{key:"containsAny",value:function(e){return!this.bitSet.and(e.bitSet).isEmpty()}},{key:"containsNone",value:function(e){return e.bitSet.and(this.bitSet).isEmpty()}},{key:"_indexOf",value:function(e){var t=this.indexOf(e);if(t<0)throw new Error("BUG: Expected the item index to be >= 0 but it was ".concat(t));return t}}]),e}(),h=function(e){function t(){return s(this,t),o(this,i(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,f),u(t,[{key:"indexOf",value:function(e){return e.allSpritesBitSetIndex}},{key:"union",value:function(e){var t=this,n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;t=t.or(s)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}},{key:"toString",value:function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=this.getSprites(e)[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;t.push(s.getName())}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t.join(" ")}},{key:"getSprites",value:function(e){var t=new Set,n=!0,r=!1,o=void 0;try{for(var i,a=e.objects[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;this.has(s)&&t.add(s)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}},{key:"or",value:function(e){return new t(void 0,this.bitSet.or(e.bitSet))}}]),t}()},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(111),o=n(81);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t,n){var r=n(27),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):i(e,t)}},function(e,t,n){var r=n(3),o=n(112),i=n(81),a=n(80)("IE_PROTO"),s=function(){},l=function(){var e,t=n(78)("iframe"),r=i.length;for(t.style.display="none",n(82).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;r--;)delete l.prototype[i[r]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[a]=e):n=l(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(111),o=n(81).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},function(e,t,n){"use strict";var r=n(4),o=n(11),i=n(10),a=n(8)("species");e.exports=function(e){var t=r[e];i&&t&&!t[a]&&o.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(25),o=n(124),i=n(93),a=n(3),s=n(9),l=n(95),u={},c={};(t=e.exports=function(e,t,n,f,h){var p,m,y,d,v=h?function(){return e}:l(e),b=r(n,f,t?2:1),g=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(i(v)){for(p=s(e.length);p>g;g++)if((d=t?b(a(m=e[g])[0],m[1]):b(e[g]))===u||d===c)return d}else for(y=v.call(e);!(m=y.next()).done;)if((d=o(y,b,m.value,t))===u||d===c)return d}).BREAK=u,t.RETURN=c},function(e,t,n){var r=n(17);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},function(e,t,n){var r=n(11).f,o=n(20),i=n(8)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){var r=n(26),o=n(8)("toStringTag"),i="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:i?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var r=n(1),o=n(31),i=n(5),a=n(84),s="["+a+"]",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),c=function(e,t,n){var o={},s=i(function(){return!!a[e]()||""!=""[e]()}),l=o[e]=s?t(f):a[e];n&&(o[n]=l),r(r.P+r.F*s,"String",o)},f=c.trim=function(e,t){return e=String(o(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=c},function(e,t){e.exports={}},function(e,t,n){var r=n(6);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"a",function(){return y});var r,o=n(13);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e){e.NO="NO",e.ALL="ALL",e.ANY="ANY",e.SOME="SOME"}(r||(r={}));var m=function(e){function t(e,n,r){var o;if(s(this,t),(o=c(this,f(t).call(this,e))).qualifier=n,o.tile=r,!r)throw new Error("BUG: Could not find win condition tile");return o}return h(t,o["a"]),u(t,[{key:"cellsThatMatchTile",value:function(e,t){return a(e).filter(function(e){return t.matchesCell(e)})}},{key:"isSatisfied",value:function(e){var t=this._isSatisfied(e);return t}},{key:"a11yGetTiles",value:function(){return[this.tile]}},{key:"_isSatisfied",value:function(e){var t=this.cellsThatMatchTile(e,this.tile);switch(this.qualifier){case r.NO:return 0===t.length;case r.ANY:case r.SOME:return t.length>0;default:throw new Error('BUG: Invalid qualifier: "'.concat(this.qualifier,'"'))}}}]),t}(),y=function(e){function t(e,n,r,o){var i;return s(this,t),(i=c(this,f(t).call(this,e,n,r))).onTile=o,i}return h(t,m),u(t,[{key:"a11yGetTiles",value:function(){return[this.tile,this.onTile]}},{key:"_isSatisfied",value:function(e){var t=this.cellsThatMatchTile(e,this.tile),n=this.cellsThatMatchTile(t,this.onTile);switch(this.qualifier){case r.NO:return 0===n.length;case r.ANY:case r.SOME:return n.length>0;case r.ALL:return n.length===t.length;default:throw new Error('BUG: Invalid qualifier: "'.concat(this.qualifier,'"'))}}}]),t}()},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(0),o=n(13);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var f=0,h=function(e){function t(e,n){var o,s,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s=this,u=l(t).call(this,e),(o=!u||"object"!==i(u)&&"function"!=typeof u?c(s):u).id=f++,n.forEach(function(e){e.setCollisionLayer(c(c(o))),e._getDescendantTiles().forEach(function(e){e.setCollisionLayer(c(c(o)))})}),o.sprites=a(new Set(Object(r.g)(n.map(function(e){return e.getSprites()})))),o.sprites.forEach(function(e,t){return e.setCollisionLayerAndIndex(c(c(o)),t)}),o}var n,h,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,o["a"]),n=t,(h=[{key:"getBitSetIndexOf",value:function(e){var t=this.sprites.indexOf(e);if(t<0)throw new Error("BUG: Sprite is not in this CollisionLayer");return t}}])&&s(n.prototype,h),p&&s(n,p),t}()},function(e,t,n){var r=n(26);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";var r=n(3);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){var r=n(3),o=n(15),i=n(8)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[i])?t:o(n)}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var i=function e(t,n){o(this,e),this.width=t,this.height=n},a=function(){function e(){o(this,e),this.noAction=!1,this.noUndo=!1,this.noRepeatAction=!1,this.throttleMovement=!1,this.noRestart=!1,this.requirePlayerMovement=!1,this.verboseLogging=!1,this.author=null,this.homepage=null,this.youtube=null,this.zoomscreen=null,this.flickscreen=null,this.colorPalette=null,this.backgroundColor=null,this.textColor=null,this.realtimeInterval=null,this.keyRepeatInterval=null,this.againInterval=null,this.runRulesOnLevelStart=null}var t,n,i;return t=e,(n=[{key:"_setValue",value:function(e,t){switch(e.toLowerCase()){case"author":this.author=t;break;case"homepage":this.homepage=t;break;case"youtube":this.youtube=t;break;case"zoomscreen":this.zoomscreen=t;break;case"flickscreen":this.flickscreen=t;break;case"colorpalette":case"color_palette":this.colorPalette=t;break;case"backgroundcolor":case"background_color":this.backgroundColor=t;break;case"textcolor":case"text_color":this.textColor=t;break;case"realtimeinterval":case"realtime_interval":this.realtimeInterval=t;break;case"keyrepeatinterval":case"key_repeat_interval":this.keyRepeatInterval=t;break;case"againinterval":case"again_interval":this.againInterval=t;break;case"noaction":this.noAction=t;break;case"noundo":this.noUndo=t;break;case"runrulesonlevelstart":case"run_rules_on_level_start":this.runRulesOnLevelStart=t;break;case"norepeataction":case"norepeat_action":this.noRepeatAction=t;break;case"throttlemovement":case"throttle_movement":this.throttleMovement=t;break;case"norestart":this.noRestart=t;break;case"requireplayermovement":case"require_player_movement":this.requirePlayerMovement=t;break;case"verboselogging":case"verbose_logging":this.verboseLogging=t;break;default:throw new Error('BUG: Unsupported config field "'.concat(e,'" with value "').concat(t,'"'))}}}])&&r(t.prototype,n),i&&r(t,i),e}()},function(e,t,n){var r=n(24),o=n(4),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(37)?"pure":"global",copyright:" 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(21),o=n(9),i=n(43);e.exports=function(e){return function(t,n,a){var s,l=r(t),u=o(l.length),c=i(a,u);if(e&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(26);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(27),o=n(31);e.exports=function(e){return function(t,n){var i,a,s=String(o(t)),l=r(n),u=s.length;return l<0||l>=u?e?"":void 0:(i=s.charCodeAt(l))<55296||i>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):i:e?s.slice(l,l+2):a-56320+(i-55296<<10)+65536}}},function(e,t,n){var r=n(6),o=n(26),i=n(8)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==o(e))}},function(e,t,n){var r=n(8)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i=[7],a=i[r]();a.next=function(){return{done:n=!0}},i[r]=function(){return a},e(i)}catch(e){}return n}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(51),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var a=n.call(e,t);if("object"!==r(a))throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==o(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";n(128);var r=n(17),o=n(16),i=n(5),a=n(31),s=n(8),l=n(99),u=s("species"),c=!i(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),f=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var h=s(e),p=!i(function(){var t={};return t[h]=function(){return 7},7!=""[e](t)}),m=p?!i(function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[u]=function(){return n}),n[h](""),!t}):void 0;if(!p||!m||"replace"===e&&!c||"split"===e&&!f){var y=/./[h],d=n(a,h,""[e],function(e,t,n,r,o){return t.exec===l?p&&!o?{done:!0,value:y.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),v=d[0],b=d[1];r(String.prototype,e,v),o(RegExp.prototype,h,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},function(e,t,n){var r=n(4).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){"use strict";var r=n(4),o=n(1),i=n(17),a=n(49),s=n(36),l=n(48),u=n(47),c=n(6),f=n(5),h=n(68),p=n(50),m=n(85);e.exports=function(e,t,n,y,d,v){var b=r[e],g=b,$=d?"set":"add",_=g&&g.prototype,S={},w=function(e){var t=_[e];i(_,e,"delete"==e?function(e){return!(v&&!c(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof g&&(v||_.forEach&&!f(function(){(new g).entries().next()}))){var E=new g,T=E[$](v?{}:-0,1)!=E,O=f(function(){E.has(1)}),R=h(function(e){new g(e)}),k=!v&&f(function(){for(var e=new g,t=5;t--;)e[$](t,t);return!e.has(-0)});R||((g=t(function(t,n){u(t,g,e);var r=m(new b,t,g);return null!=n&&l(n,d,r[$],r),r})).prototype=_,_.constructor=g),(O||k)&&(w("delete"),w("has"),d&&w("get")),(k||T)&&w($),v&&_.clear&&delete _.clear}else g=y.getConstructor(t,e,d,$),a(g.prototype,n),s.NEED=!0;return p(g,e),S[e]=g,o(o.G+o.W+o.F*(g!=b),S),v||y.setStrong(g,e,d),g}},function(e,t,n){for(var r,o=n(4),i=n(16),a=n(41),s=a("typed_array"),l=a("view"),u=!(!o.ArrayBuffer||!o.DataView),c=u,f=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(r=o[h[f++]])?(i(r.prototype,s,!0),i(r.prototype,l,!0)):c=!1;e.exports={ABV:u,CONSTR:c,TYPED:s,VIEW:l}},function(e,t,n){"use strict";e.exports=n(37)||!n(5)(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete n(4)[e]})},function(e,t,n){"use strict";var r=n(1);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";var r=n(1),o=n(15),i=n(25),a=n(48);e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,s,l=arguments[1];return o(this),(t=void 0!==l)&&o(l),null==e?new this:(n=[],t?(r=0,s=i(l,arguments[2],2),a(e,!1,function(e){n.push(s(e,r++))})):a(e,!1,n.push,n),new this(n))}})}},function(e,t,n){"use strict";var r=n(29),o=n(14);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=new Map;function s(e,t,n){var i=new r.a(e,"#ffffff"),a=new r.a(e,"#000000"),s=n.map(function(e){return e.map(function(e){return 0===e?a:i})});return new o.e(e,'letterchar="'.concat(t,'"'),"",s)}function l(e,t){a.set(e,t)}l("a",[[0,0,0,0,0],[0,1,1,1,0],[1,0,0,1,0],[1,0,0,1,0],[0,1,1,1,0]]),l("b",[[1,0,0,0,0],[1,0,0,0,0],[1,1,1,0,0],[1,0,0,1,0],[0,1,1,0,0]]),l("c",[[0,0,0,0,0],[0,1,1,1,0],[1,0,0,0,0],[1,0,0,0,0],[0,1,1,1,0]]),l("d",[[0,0,0,1,0],[0,0,0,1,0],[0,1,1,1,0],[1,0,0,1,0],[0,1,1,0,0]]),l("e",[[0,1,1,0,0],[1,0,0,1,0],[1,1,1,0,0],[1,0,0,0,0],[0,1,1,0,0]]),l("f",[[0,0,0,0,0],[0,0,1,1,0],[0,1,0,0,0],[1,1,1,0,0],[0,1,0,0,0]]),l("g",[[0,1,1,0,0],[1,0,0,1,0],[0,1,1,1,0],[0,0,0,1,0],[0,1,1,0,0]]),l("h",[[1,0,0,0,0],[1,0,0,0,0],[1,1,1,0,0],[1,0,0,1,0],[1,0,0,1,0]]),l("i",[[0,0,1,0,0],[0,0,0,0,0],[0,1,1,0,0],[0,0,1,0,0],[0,1,1,1,0]]),l("j",[[0,0,1,0,0],[0,0,0,0,0],[0,0,1,0,0],[1,0,1,0,0],[0,1,0,0,0]]),l("k",[[1,0,0,0,0],[1,0,0,1,0],[1,1,1,0,0],[1,0,0,1,0],[1,0,0,1,0]]),l("l",[[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,1,0],[0,1,1,0,0]]),l("m",[[0,0,0,0,0],[0,1,0,1,0],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1]]),l("n",[[0,0,0,0,0],[0,1,1,0,0],[1,0,0,1,0],[1,0,0,1,0],[1,0,0,1,0]]),l("o",[[0,0,0,0,0],[0,1,1,0,0],[1,0,0,1,0],[1,0,0,1,0],[0,1,1,0,0]]),l("p",[[0,0,0,0,0],[0,1,1,0,0],[1,0,0,1,0],[1,1,1,0,0],[1,0,0,0,0]]),l("q",[[0,0,0,0,0],[0,1,1,0,0],[1,0,0,1,0],[0,1,1,1,0],[0,0,0,1,0]]),l("r",[[0,0,0,0,0],[0,1,1,1,0],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0]]),l("s",[[0,1,1,1,0],[1,0,0,0,0],[0,1,1,0,0],[0,0,0,1,0],[1,1,1,0,0]]),l("t",[[0,1,0,0,0],[1,1,1,0,0],[0,1,0,0,0],[0,1,0,0,1],[0,0,1,1,0]]),l("u",[[0,0,0,0,0],[1,0,0,1,0],[1,0,0,1,0],[1,0,0,1,0],[1,1,1,0,0]]),l("v",[[0,0,0,0,0],[1,0,0,1,0],[1,0,1,0,0],[1,1,0,0,0],[1,0,0,0,0]]),l("w",[[0,0,0,0,0],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[0,1,0,1,0]]),l("x",[[0,0,0,0,0],[1,0,0,1,0],[0,1,1,0,0],[0,1,1,0,0],[1,0,0,1,0]]),l("y",[[1,0,0,1,0],[1,0,0,1,0],[0,1,1,1,0],[0,0,0,1,0],[1,1,1,0,0]]),l("z",[[0,0,0,0,0],[1,1,1,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,1,1,1,0]]),l("A",[[1,1,1,1,1],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1]]),l("B",[[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0]]),l("C",[[1,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,1]]),l("D",[[1,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,0]]),l("E",[[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1]]),l("F",[[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0]]),l("G",[[0,1,1,1,1],[1,0,0,0,0],[1,0,0,1,1],[1,0,0,0,1],[0,1,1,1,1]]),l("H",[[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1]]),l("I",[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1]]),l("J",[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[1,1,1,0,0]]),l("K",[[1,0,0,0,1],[1,0,1,1,0],[1,1,0,0,0],[1,0,1,1,0],[1,0,0,0,1]]),l("L",[[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,1]]),l("M",[[1,1,1,1,1],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1]]),l("N",[[1,0,0,0,1],[1,1,0,0,1],[1,0,1,0,1],[1,0,0,1,1],[1,0,0,0,1]]),l("O",[[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,1]]),l("P",[[1,1,1,1,1],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0]]),l("Q",[[1,1,1,1,1],[1,0,0,0,1],[1,1,1,1,1],[0,0,0,0,1],[0,0,0,0,1]]),l("R",[[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1]]),l("S",[[0,1,1,1,1],[1,0,0,0,0],[0,1,1,1,0],[0,0,0,0,1],[1,1,1,1,0]]),l("T",[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]]),l("U",[[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,1]]),l("V",[[1,0,0,0,1],[0,1,0,1,0],[0,1,0,1,0],[0,0,1,0,0],[0,0,1,0,0]]),l("W",[[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[0,1,0,1,0]]),l("X",[[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0],[0,1,0,1,0],[1,0,0,0,1]]),l("Y",[[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]]),l("Z",[[1,1,1,1,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,1,1,1,1]]),l("0",[[1,1,1,1,1],[1,0,0,1,1],[1,0,1,0,1],[1,1,0,0,1],[1,1,1,1,1]]),l("1",[[1,1,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1]]),l("2",[[1,1,1,1,1],[0,0,0,0,1],[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1]]),l("3",[[1,1,1,1,0],[0,0,0,0,1],[0,0,1,1,0],[0,0,0,0,1],[1,1,1,1,0]]),l("4",[[1,0,0,0,0],[1,0,0,0,0],[1,0,0,1,0],[1,1,1,1,1],[0,0,0,1,0]]),l("5",[[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,0],[0,0,0,0,1],[1,1,1,1,0]]),l("6",[[0,1,1,1,0],[1,0,0,0,0],[1,1,1,1,0],[1,0,0,0,1],[0,1,1,1,0]]),l("7",[[1,1,1,1,1],[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0]]),l("8",[[0,1,1,1,0],[1,0,0,0,1],[0,1,1,1,0],[1,0,0,0,1],[0,1,1,1,0]]),l("9",[[0,1,1,1,0],[1,0,0,0,1],[0,1,1,1,1],[0,0,0,0,1],[0,1,1,1,0]]),l(".",[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,1,0,0]]),l(",",[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,1,0,0],[0,1,1,0,0]]),l(";",[[0,0,0,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,1,0,0],[0,1,1,0,0]]),l(":",[[0,0,0,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,1,0,0],[0,0,0,0,0]]),l("?",[[0,1,1,1,0],[1,0,0,0,1],[0,0,1,1,0],[0,0,1,0,0],[0,0,1,0,0]]),l("!",[[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,1,0,0]]),l("@",[[0,1,1,1,0],[1,0,0,0,1],[1,0,1,1,1],[1,0,0,0,0],[0,1,1,1,0]]),l("",[[0,1,1,1,0],[0,1,0,0,1],[1,1,1,0,0],[0,1,0,0,0],[1,1,1,1,1]]),l("$",[[0,1,1,1,1],[1,0,1,0,0],[0,1,1,1,0],[0,0,1,0,1],[1,1,1,1,0]]),l("%",[[1,1,0,0,1],[1,1,0,1,0],[0,0,1,0,0],[0,1,0,1,1],[1,0,0,1,1]]),l("^",[[0,0,1,0,0],[0,1,0,1,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]),l("&",[[0,1,1,0,0],[1,0,0,0,0],[0,1,0,1,1],[1,0,0,1,0],[0,1,1,0,0]]),l("*",[[0,1,0,1,0],[0,0,1,0,0],[0,1,0,1,0],[0,0,0,0,0],[0,0,0,0,0]]),l("(",[[0,0,0,1,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,0,1,0]]),l(")",[[0,1,0,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,1,0,0,0]]),l("+",[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]]),l("-",[[0,0,0,0,0],[0,0,0,0,0],[0,1,1,1,0],[0,0,0,0,0],[0,0,0,0,0]]),l("_",[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[1,1,1,1,1]]),l("=",[[0,0,0,0,0],[1,1,1,1,1],[0,0,0,0,0],[1,1,1,1,1],[0,0,0,0,0]]),l(" ",[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]),l("{",[[0,0,1,1,0],[0,0,1,0,0],[0,1,1,0,0],[0,0,1,0,0],[0,0,1,1,0]]),l("}",[[0,1,1,0,0],[0,0,1,0,0],[0,0,1,1,0],[0,0,1,0,0],[0,1,1,0,0]]),l("[",[[0,0,1,1,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,1,0]]),l("]",[[0,1,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,1,1,0,0]]),l("'",[[0,0,1,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]),l('"',[[0,1,0,1,0],[0,1,0,1,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]),l("/",[[0,0,0,0,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,0,0,0,0]]),l("\\",[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]]),l("|",[[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]]),l("<",[[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0]]),l(">",[[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0]]),l("~",[[0,0,0,0,0],[0,1,0,0,0],[1,0,1,0,1],[0,0,0,1,0],[0,0,0,0,0]]),l("`",[[0,1,0,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]),l("#",[[0,1,0,1,0],[1,1,1,1,1],[0,1,0,1,0],[1,1,1,1,1],[0,1,0,1,0]]);var u=n(56);function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",function(){return h});var h=function(){function e(t,n,r,o,l,f,h,p,m,y){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.title=n,this.metadata=r,this.objects=o,this.legends=l,this.sounds=f,this.collisionLayers=h,this.winConditions=m,this.levels=y,this.rules=p,this.cachedBackgroundSprite=null;var d=this.objects.filter(function(e){return e.hasPixels()})[0];if(d){var v=d.getPixels(1,1);this.cacheSpriteSize={spriteHeight:v.length,spriteWidth:v[0].length}}else this.cacheSpriteSize={spriteHeight:1,spriteWidth:1};var b=this.objects.length;this.letterSprites=function(e){var t=new Map,n=!0,r=!1,o=void 0;try{for(var l,u=a.entries()[Symbol.iterator]();!(n=(l=u.next()).done);n=!0){var c=i(l.value,2),f=c[0],h=s(e,f,c[1]);t.set(f,h)}}catch(e){r=!0,o=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw o}}return t}(t);var g=!0,$=!1,_=void 0;try{for(var S,w=this.letterSprites.values()[Symbol.iterator]();!(g=(S=w.next()).done);g=!0){S.value.allSpritesBitSetIndex=b++}}catch(e){$=!0,_=e}finally{try{g||null==w.return||w.return()}finally{if($)throw _}}var E=new u.a(t,c(this.letterSprites.values()));this.collisionLayers.push(E)}var t,n,r;return t=e,(n=[{key:"_getSpriteByName",value:function(e){return this.objects.find(function(t){return t.getName().toLowerCase()===e.toLowerCase()})||null}},{key:"_getTileByName",value:function(e){return this.legends.find(function(t){return t.getName().toLowerCase()===e.toLowerCase()})}},{key:"getSpriteByName",value:function(e){var t=this._getSpriteByName(e);if(!t)throw new Error('BUG: Could not find sprite "'.concat(e,'" but expected one to exist.'));return t}},{key:"getTileByName",value:function(e){var t=this._getTileByName(e);if(!t)throw new Error('BUG: Could not find tile "'.concat(e,'" but expected one to exist.'));return t}},{key:"getMagicBackgroundSprite",value:function(){if(this.cachedBackgroundSprite)return this.cachedBackgroundSprite;var e=this._getSpriteByName("background");if(!e){var t=this.legends.find(function(e){return"background"===e.getName().toLowerCase()});if(t)return t.isOr()?null:t.getSprites()[0]}if(!e)throw new Error("ERROR: Game does not have a Background Sprite or Tile");return this.cachedBackgroundSprite=e,e}},{key:"getPlayer",value:function(){var e=this._getSpriteByName("player")||this.legends.find(function(e){return"player"===e.getName().toLowerCase()});if(!e)throw new Error("BUG: Could not find the Player sprite or tile in the game");return e}},{key:"clearCaches",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.rules[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.clearCaches()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}var i=!0,a=!1,s=void 0;try{for(var l,u=this.objects[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){l.value.clearCaches()}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}}},{key:"getSpriteSize",value:function(){return this.cacheSpriteSize}},{key:"getLetterSprite",value:function(e){var t=this.letterSprites.get(e);if(!t)throw new Error('BUG: Cannot find sprite for letter "'.concat(e,'"'));return t}}])&&f(t.prototype,n),r&&f(t,r),e}()},function(e,t,n){var r=n(6),o=n(4).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t,n){var r=n(4),o=n(24),i=n(37),a=n(110),s=n(11).f;e.exports=function(e){var t=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){var r=n(62)("keys"),o=n(41);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(4).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(6),o=n(3),i=function(e,t){if(o(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(25)(Function.call,n(22).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return i(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:i}},function(e,t){e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},function(e,t,n){var r=n(6),o=n(83).set;e.exports=function(e,t,n){var i,a=t.constructor;return a!==n&&"function"==typeof a&&(i=a.prototype)!==n.prototype&&r(i)&&o&&o(e,i),e}},function(e,t,n){"use strict";var r=n(27),o=n(31);e.exports=function(e){var t=String(o(this)),n="",i=r(e);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(n+=t);return n}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n},function(e,t,n){"use strict";var r=n(37),o=n(1),i=n(17),a=n(16),s=n(53),l=n(90),u=n(50),c=n(23),f=n(8)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,m,y,d,v){l(n,t,m);var b,g,$,_=function(e){if(!h&&e in T)return T[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",w="values"==y,E=!1,T=e.prototype,O=T[f]||T["@@iterator"]||y&&T[y],R=O||_(y),k=y?w?_("entries"):R:void 0,L="Array"==t&&T.entries||O;if(L&&($=c(L.call(new e)))!==Object.prototype&&$.next&&(u($,S,!0),r||"function"==typeof $[f]||a($,f,p)),w&&O&&"values"!==O.name&&(E=!0,R=function(){return O.call(this)}),r&&!v||!h&&!E&&T[f]||a(T,f,R),s[t]=R,s[S]=p,y)if(b={values:w?R:_("values"),keys:d?R:_("keys"),entries:k},v)for(g in b)g in T||i(T,g,b[g]);else o(o.P+o.F*(h||E),t,b);return b}},function(e,t,n){"use strict";var r=n(44),o=n(40),i=n(50),a={};n(16)(a,n(8)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(a,{next:o(1,n)}),i(e,t+" Iterator")}},function(e,t,n){var r=n(67),o=n(31);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(o(e))}},function(e,t,n){var r=n(8)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){var r=n(53),o=n(8)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[o]===e)}},function(e,t,n){"use strict";var r=n(11),o=n(40);e.exports=function(e,t,n){t in e?r.f(e,t,o(0,n)):e[t]=n}},function(e,t,n){var r=n(51),o=n(8)("iterator"),i=n(53);e.exports=n(24).getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(244);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){"use strict";var r=n(12),o=n(43),i=n(9);e.exports=function(e){for(var t=r(this),n=i(t.length),a=arguments.length,s=o(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:o(l,n);u>s;)t[s++]=e;return t}},function(e,t,n){"use strict";var r=n(38),o=n(127),i=n(53),a=n(21);e.exports=n(89)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r,o,i=n(59),a=RegExp.prototype.exec,s=String.prototype.replace,l=a,u=(r=/a/,o=/b*/g,a.call(r,"a"),a.call(o,"a"),0!==r.lastIndex||0!==o.lastIndex),c=void 0!==/()??/.exec("")[1];(u||c)&&(l=function(e){var t,n,r,o,l=this;return c&&(n=new RegExp("^"+l.source+"$(?!\\s)",i.call(l))),u&&(t=l.lastIndex),r=a.call(l,e),u&&r&&(l.lastIndex=l.global?r.index+r[0].length:t),c&&r&&r.length>1&&s.call(r[0],n,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)}),r}),e.exports=l},function(e,t,n){"use strict";var r=n(66)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r,o,i,a=n(25),s=n(117),l=n(82),u=n(78),c=n(4),f=c.process,h=c.setImmediate,p=c.clearImmediate,m=c.MessageChannel,y=c.Dispatch,d=0,v={},b=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},g=function(e){b.call(e.data)};h&&p||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++d]=function(){s("function"==typeof e?e:Function(e),t)},r(d),d},p=function(e){delete v[e]},"process"==n(26)(f)?r=function(e){f.nextTick(a(b,e,1))}:y&&y.now?r=function(e){y.now(a(b,e,1))}:m?(i=(o=new m).port2,o.port1.onmessage=g,r=a(i.postMessage,i,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(e){c.postMessage(e+"","*")},c.addEventListener("message",g,!1)):r="onreadystatechange"in u("script")?function(e){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),b.call(e)}}:function(e){setTimeout(a(b,e,1),0)}),e.exports={set:h,clear:p}},function(e,t,n){var r=n(4),o=n(101).set,i=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,l="process"==n(26)(a);e.exports=function(){var e,t,n,u=function(){var r,o;for(l&&(r=a.domain)&&r.exit();e;){o=e.fn,e=e.next;try{o()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(l)n=function(){a.nextTick(u)};else if(!i||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);n=function(){c.then(u)}}else n=function(){o.call(r,u)};else{var f=!0,h=document.createTextNode("");new i(u).observe(h,{characterData:!0}),n=function(){h.data=f=!f}}return function(r){var o={fn:r,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t,n){"use strict";var r=n(15);function o(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new o(e)}},function(e,t,n){"use strict";var r=n(4),o=n(10),i=n(37),a=n(73),s=n(16),l=n(49),u=n(5),c=n(47),f=n(27),h=n(9),p=n(137),m=n(45).f,y=n(11).f,d=n(97),v=n(50),b="prototype",g="Wrong index!",$=r.ArrayBuffer,_=r.DataView,S=r.Math,w=r.RangeError,E=r.Infinity,T=$,O=S.abs,R=S.pow,k=S.floor,L=S.log,x=S.LN2,C=o?"_b":"buffer",A=o?"_l":"byteLength",M=o?"_o":"byteOffset";function I(e,t,n){var r,o,i,a=new Array(n),s=8*n-t-1,l=(1<<s)-1,u=l>>1,c=23===t?R(2,-24)-R(2,-77):0,f=0,h=e<0||0===e&&1/e<0?1:0;for((e=O(e))!=e||e===E?(o=e!=e?1:0,r=l):(r=k(L(e)/x),e*(i=R(2,-r))<1&&(r--,i*=2),(e+=r+u>=1?c/i:c*R(2,1-u))*i>=2&&(r++,i/=2),r+u>=l?(o=0,r=l):r+u>=1?(o=(e*i-1)*R(2,t),r+=u):(o=e*R(2,u-1)*R(2,t),r=0));t>=8;a[f++]=255&o,o/=256,t-=8);for(r=r<<t|o,s+=t;s>0;a[f++]=255&r,r/=256,s-=8);return a[--f]|=128*h,a}function N(e,t,n){var r,o=8*n-t-1,i=(1<<o)-1,a=i>>1,s=o-7,l=n-1,u=e[l--],c=127&u;for(u>>=7;s>0;c=256*c+e[l],l--,s-=8);for(r=c&(1<<-s)-1,c>>=-s,s+=t;s>0;r=256*r+e[l],l--,s-=8);if(0===c)c=1-a;else{if(c===i)return r?NaN:u?-E:E;r+=R(2,t),c-=a}return(u?-1:1)*r*R(2,c-t)}function P(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function D(e){return[255&e]}function G(e){return[255&e,e>>8&255]}function B(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function F(e){return I(e,52,8)}function U(e){return I(e,23,4)}function W(e,t,n){y(e[b],t,{get:function(){return this[n]}})}function j(e,t,n,r){var o=p(+n);if(o+t>e[A])throw w(g);var i=e[C]._b,a=o+e[M],s=i.slice(a,a+t);return r?s:s.reverse()}function H(e,t,n,r,o,i){var a=p(+n);if(a+t>e[A])throw w(g);for(var s=e[C]._b,l=a+e[M],u=r(+o),c=0;c<t;c++)s[l+c]=u[i?c:t-c-1]}if(a.ABV){if(!u(function(){$(1)})||!u(function(){new $(-1)})||u(function(){return new $,new $(1.5),new $(NaN),"ArrayBuffer"!=$.name})){for(var V,q=($=function(e){return c(this,$),new T(p(e))})[b]=T[b],X=m(T),z=0;X.length>z;)(V=X[z++])in $||s($,V,T[V]);i||(q.constructor=$)}var K=new _(new $(2)),Y=_[b].setInt8;K.setInt8(0,2147483648),K.setInt8(1,2147483649),!K.getInt8(0)&&K.getInt8(1)||l(_[b],{setInt8:function(e,t){Y.call(this,e,t<<24>>24)},setUint8:function(e,t){Y.call(this,e,t<<24>>24)}},!0)}else $=function(e){c(this,$,"ArrayBuffer");var t=p(e);this._b=d.call(new Array(t),0),this[A]=t},_=function(e,t,n){c(this,_,"DataView"),c(e,$,"DataView");var r=e[A],o=f(t);if(o<0||o>r)throw w("Wrong offset!");if(o+(n=void 0===n?r-o:h(n))>r)throw w("Wrong length!");this[C]=e,this[M]=o,this[A]=n},o&&(W($,"byteLength","_l"),W(_,"buffer","_b"),W(_,"byteLength","_l"),W(_,"byteOffset","_o")),l(_[b],{getInt8:function(e){return j(this,1,e)[0]<<24>>24},getUint8:function(e){return j(this,1,e)[0]},getInt16:function(e){var t=j(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=j(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return P(j(this,4,e,arguments[1]))},getUint32:function(e){return P(j(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return N(j(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return N(j(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){H(this,1,e,D,t)},setUint8:function(e,t){H(this,1,e,D,t)},setInt16:function(e,t){H(this,2,e,G,t,arguments[2])},setUint16:function(e,t){H(this,2,e,G,t,arguments[2])},setInt32:function(e,t){H(this,4,e,B,t,arguments[2])},setUint32:function(e,t){H(this,4,e,B,t,arguments[2])},setFloat32:function(e,t){H(this,4,e,U,t,arguments[2])},setFloat64:function(e,t){H(this,8,e,F,t,arguments[2])}});v($,"ArrayBuffer"),v(_,"DataView"),s(_[b],a.VIEW,!0),t.ArrayBuffer=$,t.DataView=_},function(e,t,n){var r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/**
 * @license BitSet.js v5.0.4 4/3/2018
 * http://www.xarg.org/2014/03/javascript-bit-array/
 *
 * Copyright (c) 2016, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
/**
 * @license BitSet.js v5.0.4 4/3/2018
 * http://www.xarg.org/2014/03/javascript-bit-array/
 *
 * Copyright (c) 2016, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
!function(n){"use strict";var i=32,a=5;function s(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24}function l(e,t){for(var n=0,r=0;r<e.length;r++){n*=2;var o=(e[r]+n)/t|0;n=(e[r]+n)%t,e[r]=o}return n}function u(e,t){if(null==t)return e.data=[0,0,0,0,0,0,0,0,0,0],void(e._=0);if(t instanceof c)return e.data=t.data,void(e._=t._);switch(o(t)){case"number":e.data=[0|t],e._=0;break;case"string":var n=2,r=i;0===t.indexOf("0b")?t=t.substr(2):0===t.indexOf("0x")&&(t=t.substr(2),n=16,r=8),e.data=[],e._=0;for(var s=t.length-r,l=t.length;;){var u=parseInt(t.slice(s>0?s:0,l),n);if(isNaN(u))throw SyntaxError("Invalid param");if(e.data.push(0|u),s<=0)break;s-=r,l-=r}break;default:e.data=[0];var h=e.data;if(t instanceof Array){for(var p=t.length-1;p>=0;p--){var m=t[p];m===1/0?e._=-1:(f(e,m),h[m>>>a]|=1<<m)}break}if(Uint8Array&&t instanceof Uint8Array){f(e,8*t.length);for(p=0;p<t.length;p++)for(var y=t[p],d=0;d<8;d++){var v=8*p+d;h[v>>>a]|=(y>>d&1)<<v}break}throw SyntaxError("Invalid param")}}function c(e){if(!(this instanceof c))return new c(e);u(this,e),this.data=this.data.slice()}function f(e,t){for(var n=t>>>a,r=e.data,o=e._,i=r.length;n>=i;n--)r.push(o)}var h={data:[],_:0};c.prototype={data:[],_:0,set:function(e,t){return f(this,e|=0),void 0===t||t?this.data[e>>>a]|=1<<e:this.data[e>>>a]&=~(1<<e),this},get:function(e){e|=0;var t=this.data,n=e>>>a;return n>t.length?1&this._:t[n]>>>e&1},not:function(){for(var e=this.clone(),t=e.data,n=0;n<t.length;n++)t[n]=~t[n];return e._=~e._,e},and:function(e){u(h,e);var t=this.clone(),n=t.data,r=h.data,o=r.length,a=h._;0!==t._&&f(t,o*i-1);for(var s=n.length,l=Math.min(o,s),c=0;c<l;c++)n[c]&=r[c];for(;c<s;c++)n[c]&=a;return t._&=a,t},or:function(e){u(h,e);for(var t=this.clone(),n=t.data,r=h.data,o=r.length-1,i=n.length-1,a=Math.min(i,o),s=o;s>a;s--)n[s]=r[s];for(;s>=0;s--)n[s]|=r[s];return t._|=h._,t},xor:function(e){u(h,e);var t=this.clone(),n=t.data,r=h.data,o=t._,i=h._,a=0,s=n.length-1,l=r.length-1;for(a=s;a>l;a--)n[a]^=i;for(a=l;a>s;a--)n[a]=o^r[a];for(;a>=0;a--)n[a]^=r[a];return t._^=i,t},andNot:function(e){return this.and(new c(e).flip())},flip:function(e,t){if(void 0===e){for(var n=this.data,r=0;r<n.length;r++)n[r]=~n[r];this._=~this._}else if(void 0===t)f(this,e),this.data[e>>>a]^=1<<e;else if(0<=e&&e<=t){f(this,t);for(r=e;r<=t;r++)this.data[r>>>a]^=1<<r}return this},clear:function(e,t){var n=this.data;if(void 0===e){for(var r=n.length-1;r>=0;r--)n[r]=0;this._=0}else if(void 0===t)f(this,e|=0),n[e>>>a]&=~(1<<e);else if(e<=t){f(this,t);for(r=e;r<=t;r++)n[r>>>a]&=~(1<<r)}return this},slice:function(e,t){if(void 0===e)return this.clone();if(void 0===t){t=this.data.length*i,(r=Object.create(c.prototype))._=this._,r.data=[0];for(var n=e;n<=t;n++)r.set(n-e,this.get(n));return r}if(e<=t&&0<=e){var r;(r=Object.create(c.prototype)).data=[0];for(n=e;n<=t;n++)r.set(n-e,this.get(n));return r}return null},setRange:function(e,t,n){for(var r=e;r<=t;r++)this.set(r,n);return this},clone:function(){var e=Object.create(c.prototype);return e.data=this.data.slice(),e._=this._,e},toArray:Math.clz32?function(){for(var e=[],t=this.data,n=t.length-1;n>=0;n--)for(var r=t[n];0!==r;){var o=31-Math.clz32(r);r^=1<<o,e.unshift(n*i+o)}return 0!==this._&&e.push(1/0),e}:function(){for(var e=[],t=this.data,n=0;n<t.length;n++)for(var r=t[n];0!==r;){var o=r&-r;r^=o,e.push(n*i+s(o-1))}return 0!==this._&&e.push(1/0),e},toString:function(e){var t=this.data;if(e||(e=2),0==(e&e-1)&&e<36){for(var n="",r=2+Math.log(4294967295)/Math.log(e)|0,o=t.length-1;o>=0;o--){var a=t[o];a<0&&(a+=4294967296);var s=a.toString(e);""!==n&&(n+="0".repeat(r-s.length-1)),n+=s}return 0===this._?(""===(n=n.replace(/^0+/,""))&&(n="0"),n):(n="1111"+n).replace(/^1+/,"...1111")}if(2>e||e>36)throw SyntaxError("Invalid base");n=[];var u=[];for(o=t.length;o--;)for(var c=i;c--;)u.push(t[o]>>>c&1);do{n.unshift(l(u,e).toString(e))}while(!u.every(function(e){return 0===e}));return n.join("")},isEmpty:function(){if(0!==this._)return!1;for(var e=this.data,t=e.length-1;t>=0;t--)if(0!==e[t])return!1;return!0},cardinality:function(){if(0!==this._)return 1/0;for(var e=0,t=this.data,n=0;n<t.length;n++){var r=t[n];0!==r&&(e+=s(r))}return e},msb:Math.clz32?function(){if(0!==this._)return 1/0;for(var e=this.data,t=e.length;t-- >0;){var n=Math.clz32(e[t]);if(n!==i)return t*i+i-1-n}return 1/0}:function(){if(0!==this._)return 1/0;for(var e=this.data,t=e.length;t-- >0;){var n=e[t],r=0;if(n){for(;(n>>>=1)>0;r++);return t*i+r}}return 1/0},ntz:function(){for(var e=this.data,t=0;t<e.length;t++){var n=e[t];if(0!==n)return t*i+s(n=(n^n-1)>>>1)}return 1/0},lsb:function(){for(var e=this.data,t=0;t<e.length;t++){var n=e[t],r=0;if(n){for(var o=n&-n;o>>>=1;r++);return i*t+r}}return 1&this._},equals:function(e){u(h,e);var t=this.data,n=h.data,r=this._,o=h._,i=t.length-1,a=n.length-1;if(o!==r)return!1;for(var s=i<a?i:a,l=0;l<=s;l++)if(t[l]!==n[l])return!1;for(l=i;l>a;l--)if(t[l]!==o)return!1;for(l=a;l>i;l--)if(n[l]!==r)return!1;return!0}},c.fromBinaryString=function(e){return new c("0b"+e)},c.fromHexString=function(e){return new c("0x"+e)},c.Random=function(e){(void 0===e||e<0)&&(e=i);for(var t=e%i,n=[],r=Math.ceil(e/i),o=Object.create(c.prototype),a=0;a<r;a++)n.push(4294967296*Math.random()|0);return t>0&&(n[r-1]&=(1<<t)-1),o.data=n,o._=0,o},void 0===(r=function(){return c}.apply(t,[]))||(e.exports=r)}()},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l,u=[],c=!1,f=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):f=-1,u.length&&p())}function p(){if(!c){var e=s(h);c=!0;for(var t=u.length;t;){for(l=u,u=[];++f<t;)l&&l[f].run();f=-1,t=u.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||c||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";n.d(t,"a",function(){return S});var r,o=n(56),i=n(29),a=n(77),s=n(61),l=n(7),u=n(14),c=n(55),f=n(2);function h(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){m(e,t,n[t])})}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}function g(e){return e}!function(e){e.OR="OR",e.AND="AND",e.SIMPLE="SIMPLE",e.SPRITE="SPRITE"}(r||(r={}));var $=function(){function e(t){d(this,e),this.counter=0,this.prefix=t,this.idMap=new Map,this.jsonMap=new Map}return b(e,[{key:"set",value:function(e,t,n){return this.idMap.has(e)||this.idMap.set(e,n||this.freshId()),this.jsonMap.set(e,t),this.getId(e)}},{key:"get",value:function(e){var t=this.jsonMap.get(e);if(!t)throw new Error("BUG: Element has not been added to the set");return t}},{key:"getId",value:function(e){var t=this.idMap.get(e);if(!t)throw new Error("BUG: Element has not been added to the set");return t}},{key:"toJson",value:function(){var e={},t=!0,n=!1,r=void 0;try{for(var o,i=this.idMap[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=y(o.value,2),s=a[0],l=a[1],u=this.jsonMap.get(s);if(!u)throw new Error('BUG: Could not find matching json representation for "'.concat(l,'"'));e[l]=u}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"freshId",value:function(){return"".concat(this.prefix,"-").concat(this.counter++)}}]),e}(),_=function(){function e(){d(this,e),this.map=new Map}return b(e,[{key:"get",value:function(e){var t=this.map.get(e);if(!t)throw new Error('ERROR: JSON is missing key "'.concat(e,'". Should have already been added'));return t}},{key:"set",value:function(e,t){this.map.set(e,t)}},{key:"values",value:function(){return this.map.values()}}]),e}(),S=function(){function e(t){var n=this;if(d(this,e),this.game=t,this.colorsMap=new Map,this.spritesMap=new $("sprite"),this.soundMap=new $("sound"),this.collisionLayerMap=new $("collision"),this.conditionsMap=new $("bracket"),this.neighborsMap=new $("neighbor"),this.tileWithModifierMap=new $("twm"),this.tileMap=new $("tile"),this.ruleMap=new $("rule"),this.commandMap=new $("command"),this.game.metadata.backgroundColor){var r=this.game.metadata.backgroundColor.toHex();this.colorsMap.set(r,r)}if(this.game.metadata.textColor){var o=this.game.metadata.textColor.toHex();this.colorsMap.set(o,o)}this.game.collisionLayers.forEach(function(e){return n.buildCollisionLayer(e)}),this.game.sounds.forEach(function(e){n.soundMap.set(e,e)}),this.game.objects.forEach(function(e){n.buildSprite(e)}),this.orderedRules=this.game.rules.map(function(e){return n.recBuildRule(e)}),this.game.legends.forEach(function(e){n.buildTile(e)}),this.levels=this.game.levels.map(function(e){return n.buildLevel(e)}),this.winConditions=this.game.winConditions.map(function(e){return e instanceof c.a?{_sourceOffset:e.__source.sourceOffset,type:f.j.ON,qualifier:e.qualifier,tile:n.buildTile(e.tile),onTile:n.buildTile(e.onTile)}:{_sourceOffset:e.__source.sourceOffset,type:f.j.SIMPLE,qualifier:e.qualifier,tile:n.buildTile(e.tile)}})}return b(e,null,[{key:"fromJson",value:function(e,t){for(var n=new _,r=new _,m=new _,d=new _,v=new _,b=new _,g=new _,$=new _,S=new _,w=new _,E=Object.entries(e.colors),T=0;T<E.length;T++){var O=y(E[T],2),R=O[0],k=O[1];n.set(R,new i.a({code:t,sourceOffset:0},k))}for(var L=Object.entries(e.sounds),x=0;x<L.length;x++){var C=y(L[x],2),A=C[0];k=C[1];m.set(A,k)}for(var M=Object.entries(e.commands),I=0;I<M.length;I++){var N=y(M[I],2),P=N[0];switch((k=N[1]).type){case f.c.MESSAGE:w.set(P,k);break;case f.c.SFX:w.set(P,p({},k,{sound:m.get(k.sound)}));break;case f.c.RESTART:case f.c.AGAIN:case f.c.CANCEL:case f.c.CHECKPOINT:case f.c.WIN:w.set(P,k);break;default:throw new Error("ERROR: Unsupported command type")}}for(var D=new _,G=Object.entries(e.collisionLayers),B=0;B<G.length;B++){var F=y(G[B],1)[0];D.set(F,[])}for(var U=new i.b({code:t,sourceOffset:0}),W=0,j=Object.entries(e.sprites),H=0;H<j.length;H++){var V=y(j[H],2),q=V[0],X=(k=V[1])._sourceOffset,z=k.name,K=k.pixels,Y=new u.e({code:t,sourceOffset:X},z,null,K.map(function(e){return e.map(function(e){return e&&n.get(e)||U})}));Y.allSpritesBitSetIndex=W,W++,r.set(q,Y),D.get(k.collisionLayer).push(Y)}for(var J=Object.entries(e.tiles),Z=0;Z<J.length;Z++){var Q=y(J[Z],2),ee=Q[0],te=(X=(k=Q[1])._sourceOffset,void 0);switch(k.type){case"OR":te=new u.b({code:t,sourceOffset:X},k.name,k.sprites.map(function(e){return r.get(e)}));break;case"AND":te=new u.a({code:t,sourceOffset:X},k.name,k.sprites.map(function(e){return r.get(e)}));break;case"SIMPLE":case"SPRITE":te=new u.c({code:t,sourceOffset:X},k.name,r.get(k.sprite));break;default:throw new Error("ERROR: Unsupported tile type")}$.set(ee,te)}for(var ne=Object.entries(e.collisionLayers),re=0;re<ne.length;re++){var oe=y(ne[re],2),ie=oe[0];X=(k=oe[1])._sourceOffset;d.set(ie,new o.a({code:t,sourceOffset:X},D.get(ie)))}for(var ae=Object.entries(e.tilesWithModifiers),se=0;se<ae.length;se++){var le=y(ae[se],2),ue=le[0];X=(k=le[1])._sourceOffset;g.set(ue,new l.h({code:t,sourceOffset:X},k.isNegated,k.isRandom,k.direction,$.get(k.tile),k.debugFlag))}for(var ce=Object.entries(e.neighbors),fe=0;fe<ce.length;fe++){var he=y(ce[fe],2),pe=he[0];X=(k=he[1])._sourceOffset;b.set(pe,new l.d({code:t,sourceOffset:X},new Set(k.tileWithModifiers.map(function(e){return g.get(e)})),k.debugFlag))}for(var me=Object.entries(e.brackets),ye=0;ye<me.length;ye++){var de=y(me[ye],2),ve=de[0];X=(k=de[1])._sourceOffset;switch(k.type){case f.a.SIMPLE:v.set(ve,new l.b({code:t,sourceOffset:X},k.direction,k.neighbors.map(function(e){return b.get(e)}),k.debugFlag));break;case f.a.ELLIPSIS:v.set(ve,new l.c({code:t,sourceOffset:X},k.direction,k.beforeNeighbors.map(function(e){return b.get(e)}),k.afterNeighbors.map(function(e){return b.get(e)}),k.debugFlag));break;default:throw new Error("ERROR: Unsupported bracket type")}}for(var be=Object.entries(e.ruleDefinitions),ge=0;ge<be.length;ge++){var $e=y(be[ge],2),_e=$e[0];X=(k=$e[1])._sourceOffset;switch(k.type){case f.f.SIMPLE:S.set(_e,new l.e({code:t,sourceOffset:X},k.conditions.map(function(e){return v.get(e)}),k.actions.map(function(e){return v.get(e)}),k.commands.map(function(e){return w.get(e)}),k.isLate,k.isRigid,k.debugFlag));break;case f.f.GROUP:S.set(_e,new l.f({code:t,sourceOffset:X},k.isRandom,k.rules.map(function(e){return S.get(e)})));break;case f.f.LOOP:S.set(_e,new l.g({code:t,sourceOffset:X},!1,k.rules.map(function(e){return S.get(e)})));break;default:throw new Error("ERROR: Unsupported rule type")}}for(var Se=e.levels.map(function(e){switch(e.type){case f.d.MAP:return p({},e,{cells:e.cells.map(function(e){return e.map(function(e){return $.get(e)})})});case f.d.MESSAGE:return e;default:throw new Error("ERROR: Invalid level type")}}),we=e.winConditions.map(function(e){var n=e._sourceOffset;switch(e.type){case f.j.SIMPLE:return new c.b({code:t,sourceOffset:n},e.qualifier,$.get(e.tile));case f.j.ON:return new c.a({code:t,sourceOffset:n},e.qualifier,$.get(e.tile),$.get(e.onTile));default:throw new Error("ERROR: Unsupported Win Condition type")}}),Ee=new s.b,Te=Object.entries(e.metadata),Oe=0;Oe<Te.length;Oe++){var Re=y(Te[Oe],2),ke=Re[0];if(k=Re[1])switch(ke){case"backgroundColor":case"textColor":Ee._setValue(ke,n.get(k));break;case"zoomScreen":case"flickScreen":var Le=k.width,xe=k.height;Ee._setValue(ke,new s.a(Le,xe));break;default:Ee._setValue(ke,k)}}return new a.a({code:t,sourceOffset:0},e.title,Ee,h(r.values()),h($.values()),h(m.values()),h(d.values()),e.rules.map(function(e){return S.get(e)}),we,Se)}}]),b(e,[{key:"buildCollisionLayer",value:function(e){return this.collisionLayerMap.set(e,{_sourceOffset:e.__source.sourceOffset})}},{key:"metadataToJson",value:function(){return{author:this.game.metadata.author,homepage:this.game.metadata.homepage,youtube:this.game.metadata.youtube,zoomscreen:this.game.metadata.zoomscreen,flickscreen:this.game.metadata.flickscreen,colorPalette:this.game.metadata.colorPalette,backgroundColor:this.game.metadata.backgroundColor?this.buildColor(this.game.metadata.backgroundColor):null,textColor:this.game.metadata.textColor?this.buildColor(this.game.metadata.textColor):null,realtimeInterval:this.game.metadata.realtimeInterval,keyRepeatInterval:this.game.metadata.keyRepeatInterval,againInterval:this.game.metadata.againInterval,noAction:this.game.metadata.noAction,noUndo:this.game.metadata.noUndo,runRulesOnLevelStart:this.game.metadata.runRulesOnLevelStart,noRepeatAction:this.game.metadata.noRepeatAction,throttleMovement:this.game.metadata.throttleMovement,noRestart:this.game.metadata.noRestart,requirePlayerMovement:this.game.metadata.requirePlayerMovement,verboseLogging:this.game.metadata.verboseLogging}}},{key:"toJson",value:function(){var e={},t=!0,n=!1,r=void 0;try{for(var o,i=this.colorsMap[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=y(o.value,2),s=a[0],l=a[1];e[s]=l}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return{version:1,title:this.game.title,metadata:this.metadataToJson(),colors:e,sounds:this.soundMap.toJson(),collisionLayers:this.collisionLayerMap.toJson(),commands:this.commandMap.toJson(),sprites:this.spritesMap.toJson(),tiles:this.tileMap.toJson(),tilesWithModifiers:this.tileWithModifierMap.toJson(),neighbors:this.neighborsMap.toJson(),brackets:this.conditionsMap.toJson(),ruleDefinitions:this.ruleMap.toJson(),winConditions:this.winConditions,rules:this.orderedRules,levels:this.levels}}},{key:"buildLevel",value:function(e){var t=this;switch(e.type){case f.d.MAP:return p({},e,{cells:e.cells.map(function(e){return e.map(function(e){return t.buildTile(e)})})});case f.d.MESSAGE:return e;default:throw new Error("BUG: Unsupported level subtype")}}},{key:"recBuildRule",value:function(e){var t=this;if(e instanceof l.e)return this.ruleMap.set(e,{type:f.f.SIMPLE,directions:[],conditions:e.conditionBrackets.map(function(e){return t.buildConditionBracket(e)}),actions:e.actionBrackets.map(function(e){return t.buildConditionBracket(e)}),commands:e.commands.map(function(e){return t.buildCommand(e)}),isRandom:null,isLate:e.isLate(),isRigid:e.hasRigid(),_sourceOffset:e.__source.sourceOffset,debugFlag:e.debugFlag});if(e instanceof l.f)return this.ruleMap.set(e,{type:f.f.GROUP,isRandom:e.isRandom,rules:e.getChildRules().map(function(e){return t.recBuildRule(e)}),_sourceOffset:e.__source.sourceOffset,debugFlag:null});if(e instanceof l.g){var n={type:f.f.LOOP,rules:e.getChildRules().map(function(e){return t.recBuildRule(e)}),_sourceOffset:e.__source.sourceOffset,debugFlag:null};return this.ruleMap.set(e,n)}throw new Error("BUG: Unsupported rule type")}},{key:"buildCommand",value:function(e){switch(e.type){case f.c.SFX:return this.commandMap.set(e,p({},e,{sound:this.soundMap.getId(e.sound)}));case f.c.AGAIN:case f.c.CANCEL:case f.c.CHECKPOINT:case f.c.MESSAGE:case f.c.RESTART:case f.c.WIN:return this.commandMap.set(e,e);default:throw new Error("BUG: Unsupoprted command type")}}},{key:"buildConditionBracket",value:function(e){var t=this;if(e instanceof l.c){var n=e,r=n.beforeEllipsisBracket.getNeighbors().map(function(e){return t.buildNeighbor(e)}),o=n.afterEllipsisBracket.getNeighbors().map(function(e){return t.buildNeighbor(e)});return this.conditionsMap.set(e,{type:f.a.ELLIPSIS,direction:g(n.direction),beforeNeighbors:r,afterNeighbors:o,_sourceOffset:e.__source.sourceOffset,debugFlag:n.debugFlag})}if(e instanceof l.b)return this.conditionsMap.set(e,{type:f.a.SIMPLE,direction:g(e.direction),neighbors:e.getNeighbors().map(function(e){return t.buildNeighbor(e)}),_sourceOffset:e.__source.sourceOffset,debugFlag:e.debugFlag});throw new Error("BUG: Unsupported bracket type")}},{key:"buildNeighbor",value:function(e){var t=this;return this.neighborsMap.set(e,{tileWithModifiers:h(e._tilesWithModifier).map(function(e){return t.buildTileWithModifier(e)}),_sourceOffset:e.__source.sourceOffset,debugFlag:null})}},{key:"buildTileWithModifier",value:function(e){return this.tileWithModifierMap.set(e,{direction:e._direction?g(e._direction):null,isNegated:e._isNegated,isRandom:e._isRandom,tile:this.buildTile(e._tile),_sourceOffset:e.__source.sourceOffset,debugFlag:e._debugFlag})}},{key:"buildTile",value:function(e){var t=this;if(e instanceof u.b)return this.tileMap.set(e,{type:r.OR,name:e.getName(),sprites:e.getSprites().map(function(e){return t.buildSprite(e)}),collisionLayers:e.getCollisionLayers().map(function(e){return t.buildCollisionLayer(e)}),_sourceOffset:e.__source.sourceOffset});if(e instanceof u.a)return this.tileMap.set(e,{type:r.AND,name:e.getName(),sprites:e.getSprites().map(function(e){return t.buildSprite(e)}),collisionLayers:e.getCollisionLayers().map(function(e){return t.buildCollisionLayer(e)}),_sourceOffset:e.__source.sourceOffset});if(e instanceof u.c)return this.tileMap.set(e,{type:r.SIMPLE,name:e.getName(),sprite:this.buildSprite(e.getSprites()[0]),collisionLayers:e.getCollisionLayers().map(function(e){return t.buildCollisionLayer(e)}),_sourceOffset:e.__source.sourceOffset});if(e instanceof u.d)return this.tileMap.set(e,{type:r.SPRITE,name:e.getName(),sprite:this.buildSprite(e),collisionLayer:this.buildCollisionLayer(e.getCollisionLayer()),_sourceOffset:e.__source.sourceOffset});throw new Error("BUG: Invalid tile type")}},{key:"buildSprite",value:function(e){var t=this,n=this.game.getSpriteSize(),r=n.spriteHeight,o=n.spriteWidth;return this.spritesMap.set(e,{name:e.getName(),collisionLayer:this.collisionLayerMap.getId(e.getCollisionLayer()),pixels:e.getPixels(r,o).map(function(e){return e.map(function(e){return e.isTransparent()?null:t.buildColor(e)})}),_sourceOffset:e.__source.sourceOffset})}},{key:"buildColor",value:function(e){var t=e.toHex();return this.colorsMap.set(t,t),t}}]),e}()},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},function(e,t,n){e.exports=!n(10)&&!n(5)(function(){return 7!=Object.defineProperty(n(78)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){t.f=n(8)},function(e,t,n){var r=n(20),o=n(21),i=n(63)(!1),a=n(80)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),l=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~i(u,n)||u.push(n));return u}},function(e,t,n){var r=n(11),o=n(3),i=n(42);e.exports=n(10)?Object.defineProperties:function(e,t){o(e);for(var n,a=i(t),s=a.length,l=0;s>l;)r.f(e,n=a[l++],t[n]);return e}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(21),i=n(45).f,a={}.toString,s="object"==("undefined"==typeof window?"undefined":r(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==a.call(e)?function(e){try{return i(e)}catch(e){return s.slice()}}(e):i(o(e))}},function(e,t,n){"use strict";var r=n(42),o=n(64),i=n(58),a=n(12),s=n(57),l=Object.assign;e.exports=!l||n(5)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r})?function(e,t){for(var n=a(e),l=arguments.length,u=1,c=o.f,f=i.f;l>u;)for(var h,p=s(arguments[u++]),m=c?r(p).concat(c(p)):r(p),y=m.length,d=0;y>d;)f.call(p,h=m[d++])&&(n[h]=p[h]);return n}:l},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){"use strict";var r=n(15),o=n(6),i=n(117),a=[].slice,s={};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),l=function r(){var o=n.concat(a.call(arguments));return this instanceof r?function(e,t,n){if(!(t in s)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)}(t,o.length,o):i(t,o,e)};return o(t.prototype)&&(l.prototype=t.prototype),l}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(4).parseInt,o=n(52).trim,i=n(84),a=/^[-+]?0[xX]/;e.exports=8!==r(i+"08")||22!==r(i+"0x16")?function(e,t){var n=o(String(e),3);return r(n,t>>>0||(a.test(n)?16:10))}:r},function(e,t,n){var r=n(4).parseFloat,o=n(52).trim;e.exports=1/r(n(84)+"-0")!=-1/0?function(e){var t=o(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},function(e,t,n){var r=n(26);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},function(e,t,n){var r=n(6),o=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&o(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){var r=n(87),o=Math.pow,i=o(2,-52),a=o(2,-23),s=o(2,127)*(2-a),l=o(2,-126);e.exports=Math.fround||function(e){var t,n,o=Math.abs(e),u=r(e);return o<l?u*(o/l/a+1/i-1/i)*l*a:(n=(t=(1+a/i)*o)-(t-o))>s||n!=n?u*(1/0):u*n}},function(e,t,n){var r=n(3);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(15),o=n(12),i=n(57),a=n(9);e.exports=function(e,t,n,s,l){r(t);var u=o(e),c=i(u),f=a(u.length),h=l?f-1:0,p=l?-1:1;if(n<2)for(;;){if(h in c){s=c[h],h+=p;break}if(h+=p,l?h<0:f<=h)throw TypeError("Reduce of empty array with no initial value")}for(;l?h>=0:f>h;h+=p)h in c&&(s=t(s,c[h],h,u));return s}},function(e,t,n){"use strict";var r=n(12),o=n(43),i=n(9);e.exports=[].copyWithin||function(e,t){var n=r(this),a=i(n.length),s=o(e,a),l=o(t,a),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?a:o(u,a))-l,a-s),f=1;for(l<s&&s<l+c&&(f=-1,l+=c-1,s+=c-1);c-- >0;)l in n?n[s]=n[l]:delete n[s],s+=f,l+=f;return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(99);n(1)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){n(10)&&"g"!=/./g.flags&&n(11).f(RegExp.prototype,"flags",{configurable:!0,get:n(59)})},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(3),o=n(6),i=n(103);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(133),o=n(54);e.exports=n(72)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(o(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(o(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";var r=n(11).f,o=n(44),i=n(49),a=n(25),s=n(47),l=n(48),u=n(89),c=n(127),f=n(46),h=n(10),p=n(36).fastKey,m=n(54),y=h?"_s":"size",d=function(e,t){var n,r=p(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,u){var c=e(function(e,r){s(e,c,t,"_i"),e._t=t,e._i=o(null),e._f=void 0,e._l=void 0,e[y]=0,null!=r&&l(r,n,e[u],e)});return i(c.prototype,{clear:function(){for(var e=m(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[y]=0},delete:function(e){var n=m(this,t),r=d(n,e);if(r){var o=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=o),o&&(o.p=i),n._f==r&&(n._f=o),n._l==r&&(n._l=i),n[y]--}return!!r},forEach:function(e){m(this,t);for(var n,r=a(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!d(m(this,t),e)}}),h&&r(c.prototype,"size",{get:function(){return m(this,t)[y]}}),c},def:function(e,t,n){var r,o,i=d(e,t);return i?i.v=n:(e._l=i={i:o=p(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=i),r&&(r.n=i),e[y]++,"F"!==o&&(e._i[o]=i)),e},getEntry:d,setStrong:function(e,t,n){u(e,t,function(e,n){this._t=m(e,t),this._k=n,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?c(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,c(1))},n?"entries":"values",!n,!0),f(t)}}},function(e,t,n){"use strict";var r=n(133),o=n(54);e.exports=n(72)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(o(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r,o=n(33)(0),i=n(17),a=n(36),s=n(114),l=n(136),u=n(6),c=n(5),f=n(54),h=a.getWeak,p=Object.isExtensible,m=l.ufstore,y={},d=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(e){if(u(e)){var t=h(e);return!0===t?m(f(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return l.def(f(this,"WeakMap"),e,t)}},b=e.exports=n(72)("WeakMap",d,v,l,!0,!0);c(function(){return 7!=(new b).set((Object.freeze||Object)(y),7).get(y)})&&(s((r=l.getConstructor(d,"WeakMap")).prototype,v),a.NEED=!0,o(["delete","has","get","set"],function(e){var t=b.prototype,n=t[e];i(t,e,function(t,o){if(u(t)&&!p(t)){this._f||(this._f=new r);var i=this._f[e](t,o);return"set"==e?this:i}return n.call(this,t,o)})}))},function(e,t,n){"use strict";var r=n(49),o=n(36).getWeak,i=n(3),a=n(6),s=n(47),l=n(48),u=n(33),c=n(20),f=n(54),h=u(5),p=u(6),m=0,y=function(e){return e._l||(e._l=new d)},d=function(){this.a=[]},v=function(e,t){return h(e.a,function(e){return e[0]===t})};d.prototype={get:function(e){var t=v(this,e);if(t)return t[1]},has:function(e){return!!v(this,e)},set:function(e,t){var n=v(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=p(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,i){var u=e(function(e,r){s(e,u,t,"_i"),e._t=t,e._i=m++,e._l=void 0,null!=r&&l(r,n,e[i],e)});return r(u.prototype,{delete:function(e){if(!a(e))return!1;var n=o(e);return!0===n?y(f(this,t)).delete(e):n&&c(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=o(e);return!0===n?y(f(this,t)).has(e):n&&c(n,this._i)}}),u},def:function(e,t,n){var r=o(i(t),!0);return!0===r?y(e).set(t,n):r[e._i]=n,e},ufstore:y}},function(e,t,n){var r=n(27),o=n(9);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=o(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){var r=n(45),o=n(64),i=n(3),a=n(4).Reflect;e.exports=a&&a.ownKeys||function(e){var t=r.f(i(e)),n=o.f;return n?t.concat(n(e)):t}},function(e,t,n){"use strict";var r=n(65),o=n(6),i=n(9),a=n(25),s=n(8)("isConcatSpreadable");e.exports=function e(t,n,l,u,c,f,h,p){for(var m,y,d=c,v=0,b=!!h&&a(h,p,3);v<u;){if(v in l){if(m=b?b(l[v],v,n):l[v],y=!1,o(m)&&(y=void 0!==(y=m[s])?!!y:r(m)),y&&f>0)d=e(t,n,m,i(m.length),d,f-1)-1;else{if(d>=9007199254740991)throw TypeError();t[d]=m}d++}v++}return d}},function(e,t,n){var r=n(9),o=n(86),i=n(31);e.exports=function(e,t,n,a){var s=String(i(e)),l=s.length,u=void 0===n?" ":String(n),c=r(t);if(c<=l||""==u)return s;var f=c-l,h=o.call(u,Math.ceil(f/u.length));return h.length>f&&(h=h.slice(0,f)),a?h+s:s+h}},function(e,t,n){var r=n(42),o=n(21),i=n(58).f;e.exports=function(e){return function(t){for(var n,a=o(t),s=r(a),l=s.length,u=0,c=[];l>u;)i.call(a,n=s[u++])&&c.push(e?[n,a[n]]:a[n]);return c}}},function(e,t,n){var r=n(51),o=n(143);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return o(this)}}},function(e,t,n){var r=n(48);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},function(e,t){e.exports=Math.scale||function(e,t,n,r,o){return 0===arguments.length||e!=e||t!=t||n!=n||r!=r||o!=o?NaN:e===1/0||e===-1/0?e:(e-t)*(o-r)/(n-t)+r}},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(146),o=n.n(r);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lru=new o.a({maxSize:t})}var t,n,r;return t=e,(n=[{key:"get",value:function(e,t){var n=this.lru.get(e);if(void 0!==n)return n;var r=t();return this.lru.set(e,r),r}}])&&i(t.prototype,n),r&&i(t,r),e}()},function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=t.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}var t,n,i;return t=e,(n=[{key:"_set",value:function(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}},{key:"get",value:function(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){var t=this.oldCache.get(e);return this._set(e,t),t}}},{key:"set",value:function(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}},{key:"has",value:function(e){return this.cache.has(e)||this.oldCache.has(e)}},{key:"peek",value:function(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0}},{key:"delete",value:function(e){var t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"keys",value:regeneratorRuntime.mark(function e(){var t,n,o,i,a,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,o=void 0,e.prev=3,i=this[Symbol.iterator]();case 5:if(t=(a=i.next()).done){e.next=12;break}return s=r(a.value,1),l=s[0],e.next=9,l;case 9:t=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),n=!0,o=e.t0;case 18:e.prev=18,e.prev=19,t||null==i.return||i.return();case 21:if(e.prev=21,!n){e.next=24;break}throw o;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])})},{key:"values",value:regeneratorRuntime.mark(function e(){var t,n,o,i,a,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,o=void 0,e.prev=3,i=this[Symbol.iterator]();case 5:if(t=(a=i.next()).done){e.next=12;break}return s=r(a.value,2),l=s[1],e.next=9,l;case 9:t=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),n=!0,o=e.t0;case 18:e.prev=18,e.prev=19,t||null==i.return||i.return();case 21:if(e.prev=21,!n){e.next=24;break}throw o;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])})},{key:Symbol.iterator,value:regeneratorRuntime.mark(function e(){var t,n,o,i,a,s,l,u,c,f,h,p,m,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,o=void 0,e.prev=3,i=this.cache[Symbol.iterator]();case 5:if(t=(a=i.next()).done){e.next=12;break}return s=a.value,e.next=9,s;case 9:t=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),n=!0,o=e.t0;case 18:e.prev=18,e.prev=19,t||null==i.return||i.return();case 21:if(e.prev=21,!n){e.next=24;break}throw o;case 24:return e.finish(21);case 25:return e.finish(18);case 26:l=!0,u=!1,c=void 0,e.prev=29,f=this.oldCache[Symbol.iterator]();case 31:if(l=(h=f.next()).done){e.next=40;break}if(p=h.value,m=r(p,1),y=m[0],this.cache.has(y)){e.next=37;break}return e.next=37,p;case 37:l=!0,e.next=31;break;case 40:e.next=46;break;case 42:e.prev=42,e.t1=e.catch(29),u=!0,c=e.t1;case 46:e.prev=46,e.prev=47,l||null==f.return||f.return();case 49:if(e.prev=49,!u){e.next=52;break}throw c;case 52:return e.finish(49);case 53:return e.finish(46);case 54:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25],[29,42,46,54],[47,,49,53]])})},{key:"size",get:function(){var e=0,t=!0,n=!1,r=void 0;try{for(var o,i=this.oldCache.keys()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.cache.has(a)||e++}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return this._size+e}}])&&o(t.prototype,n),i&&o(t,i),e}();e.exports=i},function(e,t,n){var r,o=n(359).RNG,i=n(360).MakeRiff,a=.25,s=5512,l=8,u=0,c=["square","sawtooth","sine","noise","triangle","breaker"];function f(){try{null==r&&("undefined"!=typeof AudioContext?r=new AudioContext:"undefined"!=typeof webkitAudioContext&&(r=new webkitAudioContext))}catch(e){window.console.log(e)}}f();var h;function p(){var e={};return e.wave_type=u,e.p_env_attack=0,e.p_env_sustain=.3,e.p_env_punch=0,e.p_env_decay=.4,e.p_base_freq=.3,e.p_freq_limit=0,e.p_freq_ramp=0,e.p_freq_dramp=0,e.p_vib_strength=0,e.p_vib_speed=0,e.p_arp_mod=0,e.p_arp_speed=0,e.p_duty=0,e.p_duty_ramp=0,e.p_repeat_speed=0,e.p_pha_offset=0,e.p_pha_ramp=0,e.p_lpf_freq=1,e.p_lpf_ramp=0,e.p_lpf_resonance=0,e.p_hpf_freq=0,e.p_hpf_ramp=0,e.sound_vol=.5,e.sample_rate=44100,e.bit_depth=8,e}var m=!1;function y(e){return m?h.uniform()*e:Math.random()*e}function d(e){return m?Math.floor(h.uniform()*(e+1)):Math.floor(Math.random()*(e+1))}pickupCoin=function(){var e=p();if(e.wave_type=Math.floor(y(c.length)),3===e.wave_type&&(e.wave_type=0),e.p_base_freq=.4+y(.5),e.p_env_attack=0,e.p_env_sustain=y(.1),e.p_env_decay=.1+y(.4),e.p_env_punch=.3+y(.3),d(1)){e.p_arp_speed=.5+y(.2);var t=1+(1|y(7)),n=t+(1|y(7))+2;e.p_arp_mod=+t/+n}return e},laserShoot=function(){var e=p();return e.wave_type=d(2),2===e.wave_type&&d(1)&&(e.wave_type=d(1)),e.wave_type=Math.floor(y(c.length)),3===e.wave_type&&(e.wave_type=u),e.p_base_freq=.5+y(.5),e.p_freq_limit=e.p_base_freq-.2-y(.6),e.p_freq_limit<.2&&(e.p_freq_limit=.2),e.p_freq_ramp=-.15-y(.2),0===d(2)&&(e.p_base_freq=.3+y(.6),e.p_freq_limit=y(.1),e.p_freq_ramp=-.35-y(.3)),d(1)?(e.p_duty=y(.5),e.p_duty_ramp=y(.2)):(e.p_duty=.4+y(.5),e.p_duty_ramp=-y(.7)),e.p_env_attack=0,e.p_env_sustain=.1+y(.2),e.p_env_decay=y(.4),d(1)&&(e.p_env_punch=y(.3)),0===d(2)&&(e.p_pha_offset=y(.2),e.p_pha_ramp=-y(.2)),d(1)&&(e.p_hpf_freq=y(.3)),e},explosion=function(){var e=p();return d(1)?(e.p_base_freq=.1+y(.4),e.p_freq_ramp=-.1+y(.4)):(e.p_base_freq=.2+y(.7),e.p_freq_ramp=-.2-y(.2)),e.p_base_freq*=e.p_base_freq,0===d(4)&&(e.p_freq_ramp=0),0===d(2)&&(e.p_repeat_speed=.3+y(.5)),e.p_env_attack=0,e.p_env_sustain=.1+y(.3),e.p_env_decay=y(.5),0===d(1)&&(e.p_pha_offset=-.3+y(.9),e.p_pha_ramp=-y(.3)),e.p_env_punch=.2+y(.6),d(1)&&(e.p_vib_strength=y(.7),e.p_vib_speed=y(.6)),0===d(2)&&(e.p_arp_speed=.6+y(.3),e.p_arp_mod=.8-y(1.6)),e},birdSound=function(){var e=p();return y(10)<1?(e.wave_type=Math.floor(y(c.length)),3===e.wave_type&&(e.wave_type=u),e.p_env_attack=.4304400932967592+y(.2)-.1,e.p_env_sustain=.15739346034252394+y(.2)-.1,e.p_env_punch=.004488201744871758+y(.2)-.1,e.p_env_decay=.07478075528212291+y(.2)-.1,e.p_base_freq=.9865265720147687+y(.2)-.1,e.p_freq_limit=0+y(.2)-.1,e.p_freq_ramp=-.2995018224359539+y(.2)-.1,y(1)<.5&&(e.p_freq_ramp=.1+y(.15)),e.p_freq_dramp=.004598608156964473+y(.1)-.05,e.p_vib_strength=-.2202799497929496+y(.2)-.1,e.p_vib_speed=.8084998703158364+y(.2)-.1,e.p_arp_mod=0,e.p_arp_speed=0,e.p_duty=-.9031808754347107+y(.2)-.1,e.p_duty_ramp=-.8128699999808343+y(.2)-.1,e.p_repeat_speed=.601486018931999+y(.2)-.1,e.p_pha_offset=-.9424902314367765+y(.2)-.1,e.p_pha_ramp=-.1055482222272056+y(.2)-.1,e.p_lpf_freq=.9989765717851521+y(.2)-.1,e.p_lpf_ramp=-.25051720626043017+y(.2)-.1,e.p_lpf_resonance=.32777871505494693+y(.2)-.1,e.p_hpf_freq=.0023548750981756753+y(.2)-.1,e.p_hpf_ramp=-.002375673204842568+y(.2)-.1,e):y(10)<1?(e.wave_type=Math.floor(y(c.length)),3===e.wave_type&&(e.wave_type=u),e.p_env_attack=.5277795946672003+y(.2)-.1,e.p_env_sustain=.18243733568468432+y(.2)-.1,e.p_env_punch=-.020159754546840117+y(.2)-.1,e.p_env_decay=.1561353422051903+y(.2)-.1,e.p_base_freq=.9028855606533718+y(.2)-.1,e.p_freq_limit=-.008842787837148716,e.p_freq_ramp=-.1,e.p_freq_dramp=-.012891241489551925,e.p_vib_strength=-.17923136138403065+y(.2)-.1,e.p_vib_speed=.908263385610142+y(.2)-.1,e.p_arp_mod=.41690153355414894+y(.2)-.1,e.p_arp_speed=.0010766233195860704+y(.2)-.1,e.p_duty=-.8735363011184684+y(.2)-.1,e.p_duty_ramp=-.7397985366747507+y(.2)-.1,e.p_repeat_speed=.0591789344172107+y(.2)-.1,e.p_pha_offset=-.9961184222777699+y(.2)-.1,e.p_pha_ramp=-.08234769395850523+y(.2)-.1,e.p_lpf_freq=.9412475115697335+y(.2)-.1,e.p_lpf_ramp=-.18261358925834958+y(.2)-.1,e.p_lpf_resonance=.24541438107389477+y(.2)-.1,e.p_hpf_freq=-.01831940280978611+y(.2)-.1,e.p_hpf_ramp=-.03857383633171346+y(.2)-.1,e):y(10)<1?(e.wave_type=Math.floor(y(c.length)),3===e.wave_type&&(e.wave_type=u),e.p_env_attack=.4304400932967592+y(.2)-.1,e.p_env_sustain=.15739346034252394+y(.2)-.1,e.p_env_punch=.004488201744871758+y(.2)-.1,e.p_env_decay=.07478075528212291+y(.2)-.1,e.p_base_freq=.9865265720147687+y(.2)-.1,e.p_freq_limit=0+y(.2)-.1,e.p_freq_ramp=-.2995018224359539+y(.2)-.1,e.p_freq_dramp=.004598608156964473+y(.2)-.1,e.p_vib_strength=-.2202799497929496+y(.2)-.1,e.p_vib_speed=.8084998703158364+y(.2)-.1,e.p_arp_mod=-.46410459213693644+y(.2)-.1,e.p_arp_speed=-.10955361249587248+y(.2)-.1,e.p_duty=-.9031808754347107+y(.2)-.1,e.p_duty_ramp=-.8128699999808343+y(.2)-.1,e.p_repeat_speed=.7014860189319991+y(.2)-.1,e.p_pha_offset=-.9424902314367765+y(.2)-.1,e.p_pha_ramp=-.1055482222272056+y(.2)-.1,e.p_lpf_freq=.9989765717851521+y(.2)-.1,e.p_lpf_ramp=-.25051720626043017+y(.2)-.1,e.p_lpf_resonance=.32777871505494693+y(.2)-.1,e.p_hpf_freq=.0023548750981756753+y(.2)-.1,e.p_hpf_ramp=-.002375673204842568+y(.2)-.1,e):y(5)>1?(e.wave_type=Math.floor(y(c.length)),3===e.wave_type&&(e.wave_type=u),d(1)?(e.p_arp_mod=.2697849293151393+y(.2)-.1,e.p_arp_speed=-.3131172257760948+y(.2)-.1,e.p_base_freq=.8090588299313949+y(.2)-.1,e.p_duty=-.6210022920964955+y(.2)-.1,e.p_duty_ramp=-.00043441813553182567+y(.2)-.1,e.p_env_attack=.004321877246874195+y(.2)-.1,e.p_env_decay=.1+y(.2)-.1,e.p_env_punch=.061737781504416146+y(.2)-.1,e.p_env_sustain=.4987252564798832+y(.2)-.1,e.p_freq_dramp=.31700340314222614+y(.2)-.1,e.p_freq_limit=0+y(.2)-.1,e.p_freq_ramp=-.163380391341416+y(.2)-.1,e.p_hpf_freq=.4709005021145149+y(.2)-.1,e.p_hpf_ramp=.6924667290539194+y(.2)-.1,e.p_lpf_freq=.8351398631384511+y(.2)-.1,e.p_lpf_ramp=.36616557192873134+y(.2)-.1,e.p_lpf_resonance=-.08685777111664439+y(.2)-.1,e.p_pha_offset=-.036084571580025544+y(.2)-.1,e.p_pha_ramp=-.014806445085568108+y(.2)-.1,e.p_repeat_speed=-.8094368475518489+y(.2)-.1,e.p_vib_speed=.4496665457171294+y(.2)-.1,e.p_vib_strength=.23413762515532424+y(.2)-.1):(e.p_arp_mod=-.35697118026766184+y(.2)-.1,e.p_arp_speed=.3581140690559588+y(.2)-.1,e.p_base_freq=1.3260897696157528+y(.2)-.1,e.p_duty=-.30984900436710694+y(.2)-.1,e.p_duty_ramp=-.0014374759133411626+y(.2)-.1,e.p_env_attack=.3160357835682254+y(.2)-.1,e.p_env_decay=.1+y(.2)-.1,e.p_env_punch=.24323114016870148+y(.2)-.1,e.p_env_sustain=.4+y(.2)-.1,e.p_freq_dramp=.2866475886237244+y(.2)-.1,e.p_freq_limit=0+y(.2)-.1,e.p_freq_ramp=-.10956352368742976+y(.2)-.1,e.p_hpf_freq=.20772718017889846+y(.2)-.1,e.p_hpf_ramp=.1564090637378835+y(.2)-.1,e.p_lpf_freq=.6021372770637031+y(.2)-.1,e.p_lpf_ramp=.24016227139979027+y(.2)-.1,e.p_lpf_resonance=-.08787383821160144+y(.2)-.1,e.p_pha_offset=-.381597686151701+y(.2)-.1,e.p_pha_ramp=-.0002481687661373495+y(.2)-.1,e.p_repeat_speed=.07812112809425686+y(.2)-.1,e.p_vib_speed=-.13648848579133943+y(.2)-.1,e.p_vib_strength=.0018874158972302657+y(.2)-.1),e):(e.wave_type=Math.floor(y(c.length)),1!==e.wave_type&&3!==e.wave_type||(e.wave_type=2),e.p_base_freq=.85+y(.15),e.p_freq_ramp=.3+y(.15),e.p_env_attack=0+y(.09),e.p_env_sustain=.2+y(.3),e.p_env_decay=0+y(.1),e.p_duty=y(2)-1,e.p_duty_ramp=Math.pow(y(2)-1,3),e.p_repeat_speed=.5+y(.1),e.p_pha_offset=-.3+y(.9),e.p_pha_ramp=-y(.3),e.p_arp_speed=.4+y(.6),e.p_arp_mod=.8+y(.1),e.p_lpf_resonance=y(2)-1,e.p_lpf_freq=1-Math.pow(y(1),3),e.p_lpf_ramp=Math.pow(y(2)-1,3),e.p_lpf_freq<.1&&e.p_lpf_ramp<-.05&&(e.p_lpf_ramp=-e.p_lpf_ramp),e.p_hpf_freq=Math.pow(y(1),5),e.p_hpf_ramp=Math.pow(y(2)-1,5),e)},pushSound=function(){var e=p();return e.wave_type=Math.floor(y(c.length)),2===e.wave_type&&e.wave_type++,0===e.wave_type&&(e.wave_type=3),e.p_base_freq=.1+y(.4),e.p_freq_ramp=.05+y(.2),e.p_env_attack=.01+y(.09),e.p_env_sustain=.01+y(.09),e.p_env_decay=.01+y(.09),e.p_repeat_speed=.3+y(.5),e.p_pha_offset=-.3+y(.9),e.p_pha_ramp=-y(.3),e.p_arp_speed=.6+y(.3),e.p_arp_mod=.8-y(1.6),e},powerUp=function(){var e=p();return d(1)?e.wave_type=1:e.p_duty=y(.6),e.wave_type=Math.floor(y(c.length)),3===e.wave_type&&(e.wave_type=u),d(1)?(e.p_base_freq=.2+y(.3),e.p_freq_ramp=.1+y(.4),e.p_repeat_speed=.4+y(.4)):(e.p_base_freq=.2+y(.3),e.p_freq_ramp=.05+y(.2),d(1)&&(e.p_vib_strength=y(.7),e.p_vib_speed=y(.6))),e.p_env_attack=0,e.p_env_sustain=y(.4),e.p_env_decay=.1+y(.4),e},hitHurt=function(){return result=p(),result.wave_type=d(2),2===result.wave_type&&(result.wave_type=3),result.wave_type===u&&(result.p_duty=y(.6)),result.wave_type=Math.floor(y(c.length)),result.p_base_freq=.2+y(.6),result.p_freq_ramp=-.3-y(.4),result.p_env_attack=0,result.p_env_sustain=y(.1),result.p_env_decay=.1+y(.2),d(1)&&(result.p_hpf_freq=y(.3)),result},jump=function(){return result=p(),result.wave_type=u,result.wave_type=Math.floor(y(c.length)),3===result.wave_type&&(result.wave_type=u),result.p_duty=y(.6),result.p_base_freq=.3+y(.3),result.p_freq_ramp=.1+y(.2),result.p_env_attack=0,result.p_env_sustain=.1+y(.3),result.p_env_decay=.1+y(.2),d(1)&&(result.p_hpf_freq=y(.3)),d(1)&&(result.p_lpf_freq=1-y(.6)),result},blipSelect=function(){return result=p(),result.wave_type=d(1),result.wave_type=Math.floor(y(c.length)),3===result.wave_type&&(result.wave_type=d(1)),result.wave_type===u&&(result.p_duty=y(.6)),result.p_base_freq=.2+y(.4),result.p_env_attack=0,result.p_env_sustain=.1+y(.1),result.p_env_decay=y(.2),result.p_hpf_freq=.1,result},random=function(){return result=p(),result.wave_type=Math.floor(y(c.length)),result.p_base_freq=Math.pow(y(2)-1,2),d(1)&&(result.p_base_freq=Math.pow(y(2)-1,3)+.5),result.p_freq_limit=0,result.p_freq_ramp=Math.pow(y(2)-1,5),result.p_base_freq>.7&&result.p_freq_ramp>.2&&(result.p_freq_ramp=-result.p_freq_ramp),result.p_base_freq<.2&&result.p_freq_ramp<-.05&&(result.p_freq_ramp=-result.p_freq_ramp),result.p_freq_dramp=Math.pow(y(2)-1,3),result.p_duty=y(2)-1,result.p_duty_ramp=Math.pow(y(2)-1,3),result.p_vib_strength=Math.pow(y(2)-1,3),result.p_vib_speed=y(2)-1,result.p_env_attack=Math.pow(y(2)-1,3),result.p_env_sustain=Math.pow(y(2)-1,2),result.p_env_decay=y(2)-1,result.p_env_punch=Math.pow(y(.8),2),result.p_env_attack+result.p_env_sustain+result.p_env_decay<.2&&(result.p_env_sustain+=.2+y(.3),result.p_env_decay+=.2+y(.3)),result.p_lpf_resonance=y(2)-1,result.p_lpf_freq=1-Math.pow(y(1),3),result.p_lpf_ramp=Math.pow(y(2)-1,3),result.p_lpf_freq<.1&&result.p_lpf_ramp<-.05&&(result.p_lpf_ramp=-result.p_lpf_ramp),result.p_hpf_freq=Math.pow(y(1),5),result.p_hpf_ramp=Math.pow(y(2)-1,5),result.p_pha_offset=Math.pow(y(2)-1,3),result.p_pha_ramp=Math.pow(y(2)-1,3),result.p_repeat_speed=y(2)-1,result.p_arp_speed=y(2)-1,result.p_arp_mod=y(2)-1,result};var v=[pickupCoin,laserShoot,explosion,powerUp,hitHurt,jump,blipSelect,pushSound,random,birdSound];function b(e,t){this._buffer=r.createBuffer(1,e,t)}generateFromSeed=function(e){h=new o(e/100|0),m=!0;var t=(0,v[e%100%v.length])();return t.seed=e,m=!1,t},b.prototype.getBuffer=function(){return this._buffer.getChannelData(0)},b.prototype.play=function(){var e=r.createBufferSource(),t=r.createBiquadFilter(),n=r.createBiquadFilter(),o=r.createBiquadFilter();e.buffer=this._buffer,e.connect(t),t.frequency.value=1600,n.frequency.value=1600,o.frequency.value=1600,t.connect(n),n.connect(o),o.connect(r.destination);var i=r.currentTime;return void 0!==e.start?e.start(i):e.noteOn(i)},b.MIN_SAMPLE_RATE=22050,void 0===r&&((b=function(e,t){this._sample_rate=t,this._buffer=new Array(e),this._audioElement=null}).prototype.getBuffer=function(){return this._audioElement=null,this._buffer},b.prototype.play=function(){if(!this._audioElement){for(var e=0;e<this._buffer.length;e++)this._buffer[e]=255&Math.floor(128*Math.max(0,Math.min(this._buffer[e]+1,2)));var t=i(this._sample_rate,l,this._buffer);return this._audioElement=new Audio,this._audioElement.src=t.dataURI,this._audioElement.play()}this._audioElement.cloneNode(!1).play()},b.MIN_SAMPLE_RATE=1),b.generate=function(e){function t(){n=0,r=100/(e.p_base_freq*e.p_base_freq+.001),o=Math.floor(r),i=100/(e.p_freq_limit*e.p_freq_limit+.001),a=1-.01*Math.pow(e.p_freq_ramp,3),s=1e-6*-Math.pow(e.p_freq_dramp,3),l=.5-.5*e.p_duty,c=5e-5*-e.p_duty_ramp,f=e.p_arp_mod>=0?1-.9*Math.pow(e.p_arp_mod,2):1+10*Math.pow(e.p_arp_mod,2),0,h=Math.floor(2e4*Math.pow(1-e.p_arp_speed,2)+32),1==e.p_arp_speed&&(h=0)}var n,r,o,i,a,s,l,c,f,h;t();var p=0,m=0,y=.1*Math.pow(e.p_lpf_freq,3),d=1+1e-4*e.p_lpf_ramp,v=5/(1+20*Math.pow(e.p_lpf_resonance,2))*(.01+y);v>.8&&(v=.8);var g=0,$=.1*Math.pow(e.p_hpf_freq,2),_=1+3e-4*e.p_hpf_ramp,S=0,w=.01*Math.pow(e.p_vib_speed,2),E=.5*e.p_vib_strength,T=0,O=0,R=0,k=[Math.floor(e.p_env_attack*e.p_env_attack*1e5),Math.floor(e.p_env_sustain*e.p_env_sustain*1e5),Math.floor(e.p_env_decay*e.p_env_decay*1e5)],L=k[0]+k[1]+k[2],x=0,C=1020*Math.pow(e.p_pha_offset,2);e.p_pha_offset<0&&(C=-C);var A=1*Math.pow(e.p_pha_ramp,2);e.p_pha_ramp<0&&(A=-A);for(var M=Math.abs(Math.floor(C)),I=0,N=[],P=0;P<1024;++P)N[P]=0;var D=[];for(P=0;P<32;++P)D[P]=2*Math.random()-1;var G=Math.floor(2e4*Math.pow(1-e.p_repeat_speed,2)+32);0==e.p_repeat_speed&&(G=0);for(var B,F=e.sound_vol,U=(F=Math.exp(e.sound_vol)-1,0),W=0,j=Math.floor(44100/e.sample_rate),H=0,V=Math.ceil(L/j),q=(B=e.sample_rate<b.MIN_SAMPLE_RATE?new b(4*V,b.MIN_SAMPLE_RATE):new b(V,e.sample_rate)).getBuffer(),X=0;;++X){0!=G&&++n>=G&&t(),0!=h&&X>=h&&(h=0,r*=f),(r*=a+=s)>i&&(r=i,e.p_freq_limit>0&&!0);var z=r;if(E>0&&(S+=w,z=r*(1+Math.sin(S)*E)),(o=Math.floor(z))<8&&(o=8),(l+=c)<0&&(l=0),l>.5&&(l=.5),++R>k[O]){for(R=1,O++;O<3&&0===k[O];)O++;if(3===O)break}T=0===O?R/k[0]:1===O?1+2*Math.pow(1-R/k[1],1)*e.p_env_punch:1-R/k[2],C+=A,(M=Math.abs(Math.floor(C)))>1023&&(M=1023),0!=_&&(($*=_)<1e-5&&($=1e-5),$>.1&&($=.1));for(var K=0,Y=0;Y<8;++Y){var J=0;if(++x>=o&&(x%=o,3===e.wave_type))for(P=0;P<32;++P)D[P]=2*Math.random()-1;var Z=x/o;if(e.wave_type===u)J=Z<l?.5:-.5;else if(1===e.wave_type)J=1-2*Z;else if(2===e.wave_type)J=Math.sin(2*Z*Math.PI);else if(3===e.wave_type)J=D[Math.floor(32*x/o)];else if(4===e.wave_type)J=Math.abs(1-2*Z)-1;else{if(5!==e.wave_type)throw new Exception("bad wave type! "+e.wave_type);J=Math.abs(1-Z*Z*2)-1}var Q=p;(y*=d)<0&&(y=0),y>.1&&(y=.1),1!=e.p_lpf_freq?(m+=(J-p)*y,m-=m*v):(p=J,m=0),g+=(p+=m)-Q,J=g-=g*$,N[1023&I]=J,J+=N[I-M+1024&1023],I=I+1&1023,K+=J*T}U+=K,++W>=j&&(W=0,K=U/j,U=0,K=K/8*1,K*=F,q[H++]=K,e.sample_rate<b.MIN_SAMPLE_RATE&&(q[H++]=K,q[H++]=K,q[H++]=K))}return j>0&&(K=(K=U/j)/8*1,K*=F,q[H++]=K,e.sample_rate<b.MIN_SAMPLE_RATE&&(q[H++]=K,q[H++]=K,q[H++]=K)),B};var g={},$=[],_=50;e.exports={playSound:function(e){return f(),function(e){if(e in g)return g[e];var t=generateFromSeed(e);t.sound_vol=a,t.sample_rate=s,t.bit_depth=l;var n=b.generate(t);for(g[e]=n,$.push(e);$.length>_;){var r=$[0];$=$.slice(1),delete g[r]}return n}(e).play()}}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.table=t,this.handler=n,this.columns=1,this.rows=1,this.boundResizeHandler=Object(r.f)(this.trigger.bind(this)),window.addEventListener("resize",this.boundResizeHandler)}var t,n,i;return t=e,(n=[{key:"setLevel",value:function(e,t){this.rows=e,this.columns=t}},{key:"trigger",value:function(){var e=this.columns/this.rows,t=window.innerWidth-this.table.offsetLeft,n=window.innerHeight-this.table.offsetTop,r=0;r=t/n<e?t/e:n*e,this.handler(Math.floor(r))}},{key:"dispose",value:function(){window.removeEventListener("resize",this.boundResizeHandler)}}])&&o(t.prototype,n),i&&o(t,i),e}()},function(e,t,n){"use strict";var r,o,i,a,s,l=n(0),u={id:"Wireless Controller (STANDARD GAMEPAD)",buttons:{ARROW_UP:12,ARROW_DOWN:13,ARROW_LEFT:14,ARROW_RIGHT:15,HOME:16,START:9,SELECT:8,CLUSTER_TOP:3,CLUSTER_LEFT:2,CLUSTER_RIGHT:1,CLUSTER_BOTTOM:0,BUMPER_TOP_LEFT:4,BUMPER_BOTTOM_LEFT:6,BUMPER_TOP_RIGHT:5,BUMPER_BOTTOM_RIGHT:7,STICK_PRESS_LEFT:10,STICK_PRESS_RIGHT:11},sticks:{LEFT:{xAxis:0,yAxis:1},RIGHT:{xAxis:2,yAxis:3}},analogs:{}},c=[u,{id:"54c-9cc-Wireless Controller",buttons:{ARROW_UP:14,ARROW_DOWN:15,ARROW_LEFT:16,ARROW_RIGHT:17,HOME:12,START:9,SELECT:8,CLUSTER_TOP:3,CLUSTER_LEFT:0,CLUSTER_RIGHT:2,CLUSTER_BOTTOM:1,BUMPER_TOP_LEFT:4,BUMPER_BOTTOM_LEFT:6,BUMPER_TOP_RIGHT:5,BUMPER_BOTTOM_RIGHT:7,STICK_PRESS_LEFT:10,STICK_PRESS_RIGHT:11,TOUCHSCREEN:13},sticks:{LEFT:{xAxis:0,yAxis:1},RIGHT:{xAxis:2,yAxis:5}},analogs:{BUMPER_LEFT:3,BUMPER_RIGHT:4}},{id:"[temp xbox id]",buttons:{ARROW_UP:12,ARROW_DOWN:13,ARROW_LEFT:14,ARROW_RIGHT:15,HOME:16,START:9,SELECT:8,CLUSTER_TOP:3,CLUSTER_LEFT:2,CLUSTER_RIGHT:1,CLUSTER_BOTTOM:0,BUMPER_TOP_LEFT:4,BUMPER_BOTTOM_LEFT:6,BUMPER_TOP_RIGHT:5,BUMPER_BOTTOM_RIGHT:7,STICK_PRESS_LEFT:10,STICK_PRESS_RIGHT:11},sticks:{LEFT:{xAxis:0,yAxis:1},RIGHT:{xAxis:2,yAxis:3}},analogs:{}},{id:"54c-268-PLAYSTATION(R)3 Controller",buttons:{ARROW_UP:4,ARROW_DOWN:6,ARROW_LEFT:7,ARROW_RIGHT:5,HOME:16,START:3,SELECT:0,CLUSTER_TOP:12,CLUSTER_LEFT:15,CLUSTER_RIGHT:13,CLUSTER_BOTTOM:14,BUMPER_TOP_LEFT:10,BUMPER_BOTTOM_LEFT:8,BUMPER_TOP_RIGHT:11,BUMPER_BOTTOM_RIGHT:9,STICK_PRESS_LEFT:1,STICK_PRESS_RIGHT:2},sticks:{LEFT:{xAxis:0,yAxis:1},RIGHT:{xAxis:2,yAxis:3}},analogs:{}},{id:"45e-28e-Xbox 360 Wired Controller",buttons:{ARROW_UP:0,ARROW_DOWN:1,ARROW_LEFT:2,ARROW_RIGHT:3,HOME:10,START:4,SELECT:5,CLUSTER_TOP:14,CLUSTER_LEFT:13,CLUSTER_RIGHT:12,CLUSTER_BOTTOM:11,BUMPER_TOP_LEFT:8,BUMPER_TOP_RIGHT:9,STICK_PRESS_LEFT:6,STICK_PRESS_RIGHT:7},sticks:{LEFT:{xAxis:0,yAxis:1},RIGHT:{xAxis:3,yAxis:4}},analogs:{BUMPER_LEFT:2,BUMPER_RIGHT:5}},{id:"79-6-Generic   USB  Joystick  ",buttons:{ARROW_UP:12,ARROW_DOWN:13,ARROW_LEFT:14,ARROW_RIGHT:15,START:9,CLUSTER_TOP:3,CLUSTER_LEFT:8,CLUSTER_RIGHT:2,CLUSTER_BOTTOM:6,BUMPER_TOP_LEFT:4,BUMPER_BOTTOM_LEFT:7,BUMPER_TOP_RIGHT:5,STICK_PRESS_LEFT:0,STICK_PRESS_RIGHT:1},sticks:{LEFT:{xAxis:1,yAxis:2}},analogs:{}}];function f(e){return"standard"===e.mapping?u:c.find(function(t){return e.id===t.id})||null}function h(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}!function(e){e.ARROW_UP="ARROW_UP",e.ARROW_DOWN="ARROW_DOWN",e.ARROW_LEFT="ARROW_LEFT",e.ARROW_RIGHT="ARROW_RIGHT",e.HOME="HOME",e.START="START",e.SELECT="SELECT",e.CLUSTER_TOP="CLUSTER_TOP",e.CLUSTER_LEFT="CLUSTER_LEFT",e.CLUSTER_RIGHT="CLUSTER_RIGHT",e.CLUSTER_BOTTOM="CLUSTER_BOTTOM",e.BUMPER_TOP_LEFT="BUMPER_TOP_LEFT",e.BUMPER_BOTTOM_LEFT="BUMPER_BOTTOM_LEFT",e.BUMPER_TOP_RIGHT="BUMPER_TOP_RIGHT",e.BUMPER_BOTTOM_RIGHT="BUMPER_BOTTOM_RIGHT",e.STICK_PRESS_LEFT="STICK_PRESS_LEFT",e.STICK_PRESS_RIGHT="STICK_PRESS_RIGHT",e.TOUCHSCREEN="TOUCHSCREEN"}(r||(r={})),function(e){e.LEFT="LEFT",e.RIGHT="RIGHT"}(o||(o={})),function(e){e.BUMPER_LEFT="BUMPER_LEFT",e.BUMPER_RIGHT="BUMPER_RIGHT"}(i||(i={})),function(e){e.UP="UP",e.DOWN="DOWN",e.LEFT="LEFT",e.RIGHT="RIGHT"}(a||(a={})),function(e){e.ALT="ALT",e.CTRL="CTRL",e.META="META",e.SHIFT="SHIFT"}(s||(s={}));var d=function(){function e(t){if(p(this,e),!(t>=0))throw new Error("Must provide an index. Or, use the AnyGamepad class");this.index=t}return y(e,[{key:"isSomethingConnected",value:function(){return!!this.raw()}},{key:"isRecognized",value:function(){var e=this.raw();return!!e&&null!==f(e)}},{key:"isButtonPressed",value:function(e){var t=this.raw();if(t){var n=this.buttonIndex(e);return null!==n&&t.buttons[n].pressed}return!1}},{key:"hasButton",value:function(e){return null!==this.buttonIndex(e)}},{key:"button",value:function(e){var t=this;return{has:function(){return t.hasButton(e)},query:function(){return t.isButtonPressed(e)}}}},{key:"getStickValue",value:function(e){var t=this.raw();if(t){var n=this.stickIndex(e);if(n){var r=n.xAxis,o=n.yAxis;return{x:t.axes[r],y:t.axes[o]}}}return{x:0,y:0}}},{key:"getStickDirection",value:function(e){var t=this.getStickValue(e),n=t.x,r=t.y,o=Math.abs(n),i=Math.abs(r);return o<.5&&i<.5?null:o>i?n>0?a.LEFT:a.RIGHT:r>0?a.DOWN:a.UP}},{key:"hasStick",value:function(e){return null!==this.stickIndex(e)}},{key:"stick",value:function(e){var t=this;return{has:function(){return t.hasStick(e)},query:function(){return t.getStickValue(e)},direction:function(){return t.getStickDirection(e)}}}},{key:"raw",value:function(){return h(navigator.getGamepads())[this.index]||null}},{key:"buttonIndex",value:function(e){var t=this.raw();return t&&function(e,t){var n=f(e);if(n){var r=n.buttons[t];if(void 0!==r)return r}return null}(t,e)}},{key:"stickIndex",value:function(e){var t=this.raw();return t&&function(e,t){var n=f(e);return n&&n.sticks[t]||null}(t,e)}}]),e}(),v=function(){function e(){p(this,e)}return y(e,[{key:"isSomethingConnected",value:function(){return!!b.getGamepads().find(function(e){return!!e&&e.isSomethingConnected()})}},{key:"isRecognized",value:function(){return!!b.getGamepads().find(function(e){return!!e&&e.isRecognized()})}},{key:"hasButton",value:function(e){return!!b.getGamepads().find(function(t){return!!t&&t.hasButton(e)})}},{key:"isButtonPressed",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=b.getGamepads()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(a&&a.isButtonPressed(e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return!1}},{key:"button",value:function(e){var t=this;return{has:function(){return t.hasButton(e)},query:function(){return t.isButtonPressed(e)}}}},{key:"hasStick",value:function(e){return!!b.getGamepads().find(function(t){return!!t&&t.hasStick(e)})}},{key:"getStickValue",value:function(e){var t=0,n=0,r=!0,o=!1,i=void 0;try{for(var a,s=b.getGamepads()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(l){var u=l.getStickValue(e),c=u.x,f=u.y;t+=c,n+=f}}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return{x:t,y:n}}},{key:"getStickDirection",value:function(e){var t=b.getGamepads().find(function(t){return!!t&&null!==t.getStickDirection(e)})||null;return t&&t.getStickDirection(e)}},{key:"stick",value:function(e){var t=this;return{has:function(){return t.hasStick(e)},query:function(){return t.getStickValue(e)},direction:function(){return t.getStickDirection(e)}}}}]),e}(),b=new(function(){function e(){p(this,e),this.cache=[],this.any=null}return y(e,[{key:"getGamepads",value:function(){var e=this;return h(navigator.getGamepads()).map(function(t,n){return t&&e.getGamepad(n)})}},{key:"getGamepad",value:function(e){return this.cache[e]=this.cache[e]||new d(e),this.cache[e]}},{key:"getAnyGamepad",value:function(){if(this.any)return this.any;var e=new v;return this.any=e,e}},{key:"key",value:function(e,t,n){var r=new Set(n||[]),o=!1,i=function(e,t){return e.has(s.ALT)===t.altKey&&e.has(s.CTRL)===t.ctrlKey&&e.has(s.META)===t.metaKey&&e.has(s.SHIFT)===t.shiftKey},a=function e(t,n){return t===n||!(null===n||!n.parentElement)&&e(t,n.parentElement)},l=function(n){n.key===e&&i(r,n)&&(t&&!a(t,window.document.activeElement)||(o=!0,n.preventDefault()))},u=function(n){n.key===e&&i(r,n)&&(t&&!a(t,window.document.activeElement)||(o=!1,n.preventDefault()))};return window.addEventListener("keydown",l),window.addEventListener("keyup",u),{has:function(){return!0},query:function(){return o},dispose:function(){window.removeEventListener("keydown",l),window.removeEventListener("keyup",u)}}}},{key:"or",value:function(e){return{has:function(){return!!e.find(function(e){return e.has()})},query:function(){return!!e.find(function(e){return e.query()})}}}},{key:"asStick",value:function(e,t,n,r){function o(){return{x:0+(e.query()?-1:0)+(t.query()?1:0),y:0+(n.query()?-1:0)+(r.query()?1:0)}}return{query:o,has:function(){return e.has()&&t.has()&&n.has()&&r.has()},direction:function(){var e=o(),t=e.x,n=e.y;return t<0&&0===n?a.UP:t>0&&0===n?a.DOWN:n<0&&0===t?a.LEFT:n>0&&0===t?a.RIGHT:null}}}},{key:"orSticks",value:function(e){function t(){var t=0,n=0,r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value.query(),u=l.x,c=l.y;t+=u,n+=c}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return{x:t,y:n}}return{query:t,has:function(){return!!e.find(function(e){return e.has()})},direction:function(){var e=t(),n=e.x,r=e.y;return n<0&&0===r?a.UP:n>0&&0===r?a.DOWN:r<0&&0===n?a.LEFT:r>0&&0===n?a.RIGHT:null}}}}]),e}());function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",function(){return $});var $=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gamepad=b.getAnyGamepad(),this.table=t,this.polledInput=null,this.repeatIntervalInSeconds=null,this.boundKeys=[],this.touchStart=null,this.touchStartedAt=0,this.touchHoldInterval=null;var i=function(e){var r=b.key(e,t);return n.boundKeys.push(r),r};this.controls={up:{lastPressed:null,button:b.or([this.gamepad.button(r.ARROW_UP),i("w"),i("ArrowUp")])},down:{lastPressed:null,button:b.or([this.gamepad.button(r.ARROW_DOWN),i("s"),i("ArrowDown")])},left:{lastPressed:null,button:b.or([this.gamepad.button(r.ARROW_LEFT),i("a"),i("ArrowLeft")])},right:{lastPressed:null,button:b.or([this.gamepad.button(r.ARROW_RIGHT),i("d"),i("ArrowRight")])},action:{lastPressed:null,button:b.or([this.gamepad.button(r.CLUSTER_BOTTOM),i("x"),i(" "),i("Enter")])},undo:{lastPressed:null,button:b.or([this.gamepad.button(r.CLUSTER_LEFT),this.gamepad.button(r.BUMPER_TOP_LEFT),i("z"),i("u")])},restart:{lastPressed:null,button:b.or([this.gamepad.button(r.CLUSTER_TOP),i("r")])}},this.stickControls={left:{lastPressed:null,stick:this.gamepad.stick(o.LEFT)},right:{lastPressed:null,stick:this.gamepad.stick(o.RIGHT)}};var a=function(e,t){return function(){var r=Date.now(),o=1e3*(n.repeatIntervalInSeconds||.25),i=n.controls[e],a=i.button,s=i.lastPressed;a.query()?(!s||s+o<r)&&(t(),n.controls[e].lastPressed=r):n.controls[e].lastPressed=null}},s=function(e){return function(){var t=Date.now(),r=1e3*(n.repeatIntervalInSeconds||.25),o=n.stickControls[e],i=o.stick,a=o.lastPressed,s=i.query(),u=s.x,c=s.y,f=Math.abs(c),h=Math.abs(u);if(f>h){if(f>.5)return void((!a||a+r<t)&&(o.lastPressed=t,n.polledInput=c<0?l.b.UP:l.b.DOWN))}else if(h>.5)return void((!a||a+r<t)&&(o.lastPressed=t,n.polledInput=u<0?l.b.LEFT:l.b.RIGHT));o.lastPressed=null}};this.controlCheckers=[s("left"),s("right"),a("up",function(){return n.polledInput=l.b.UP}),a("down",function(){return n.polledInput=l.b.DOWN}),a("left",function(){return n.polledInput=l.b.LEFT}),a("right",function(){return n.polledInput=l.b.RIGHT}),a("action",function(){return n.polledInput=l.b.ACTION}),a("undo",function(){return n.polledInput=l.b.UNDO}),a("restart",function(){return n.polledInput=l.b.RESTART})],this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.table.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.table.addEventListener("touchmove",this.onTouchMove),this.table.addEventListener("touchend",this.onTouchEnd)}var t,n,i;return t=e,(n=[{key:"pollControls",value:function(){if(window.document.activeElement!==this.table)return null;this.controlCheckers.forEach(function(e){return e()});var e=this.polledInput;return this.polledInput=null,e}},{key:"isSomethingPressed",value:function(){for(var e=Object.values(this.controls),t=0;t<e.length;t++){if(e[t].button.query())return!0}return!1}},{key:"setKeyRepeatInterval",value:function(e){this.repeatIntervalInSeconds=e}},{key:"dispose",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.boundKeys[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.dispose()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}this.table.removeEventListener("touchstart",this.onTouchStart),this.table.removeEventListener("touchmove",this.onTouchMove),this.table.removeEventListener("touchend",this.onTouchEnd)}},{key:"startTouchHoldInterval",value:function(){var e=this;this.touchHoldInterval=setInterval(function(){return e.polledInput=l.b.UNDO},500)}},{key:"endTouchHoldInterval",value:function(){this.touchHoldInterval&&clearInterval(this.touchHoldInterval),this.touchHoldInterval=null}},{key:"onTouchStart",value:function(e){1===e.changedTouches.length&&(this.table.focus(),this.touchStart=e.changedTouches[0],this.touchStartedAt=Date.now(),this.startTouchHoldInterval())}},{key:"onTouchMove",value:function(e){this.touchStart&&1===e.touches.length&&e.preventDefault()}},{key:"onTouchEnd",value:function(e){var t=this,n=function(){var e=Date.now()-t.touchStartedAt;if(e>=2e3){var n=confirm("You were holding for a while. Do you want to restart the level?");t.polledInput=n?l.b.RESTART:null}else e<200&&(t.polledInput=l.b.ACTION)};if(this.endTouchHoldInterval(),this.touchStart&&1===e.changedTouches.length){var r=e.changedTouches[0],o=r.pageX-this.touchStart.pageX,i=r.pageY-this.touchStart.pageY,a=Math.abs(o),s=Math.abs(i);a>s?a>this.table.clientWidth/15?this.polledInput=o>0?l.b.RIGHT:l.b.LEFT:n():s>this.table.clientWidth/15?this.polledInput=i>0?l.b.DOWN:l.b.UP:n(),this.touchStart=null,e.preventDefault()}}}])&&g(t.prototype,n),i&&g(t,i),e}()},function(e,t,n){"use strict";var r=n(7),o=n(147),i=n(0);function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}var c=function(){function e(){s(this,e),this.cache=new Map}return u(e,[{key:"get",value:function(e,t,n,r){var o=e.map(function(e){return e.getName()}).join(" "),i=this.cache.get(o);return i||(i=function(e,t,n,r){if(0===e.length){for(var o=[],i=0;i<n;i++){o[i]=o[i]||[];for(var a=0;a<r;a++)t&&(o[i][a]=t)}return o}0;if(1===e.length)return e[0].getPixels(n,r);var s=e[0].getPixels(n,r);return e.slice(1).forEach(function(e,t){for(var o=e.getPixels(n,r),i=0;i<n;i++){s[i]=s[i]||[];for(var a=0;a<r;a++){var l=o[i][a];s[i][a]&&!s[i][a].isTransparent()||!l||l.isTransparent()||(s[i][a]=l)}}}),s}(e,t,n,r),this.cache.set(o,i)),i}},{key:"clear",value:function(){this.cache.clear()}}]),e}();var f=function(){function e(){s(this,e),this.cellColorCache=new c,this.renderedPixels=[],this.windowOffsetColStart=0,this.windowOffsetRowStart=0,this.isDumpingScreen=!1,this.PIXEL_HEIGHT=1,this.PIXEL_WIDTH=2,this.SPRITE_HEIGHT=5,this.SPRITE_WIDTH=5,this.hasVisualUi=!0,this.gameData=null,this.currentLevelMessage=null,this.currentLevelCells=null,this.windowOffsetWidth=null,this.windowOffsetHeight=null}return u(e,[{key:"destroy",value:function(){this.gameData=null,this.currentLevelMessage=null,this.currentLevelCells=null,this.renderedPixels=[],this.cellColorCache.clear()}},{key:"onGameChange",value:function(e){if(this.gameData=e,this.renderedPixels=[],this.cellColorCache.clear(),this.clearScreen(),this.windowOffsetColStart=0,this.windowOffsetRowStart=0,this.windowOffsetWidth=null,this.windowOffsetHeight=null,this.gameData.metadata.flickscreen){var t=this.gameData.metadata.flickscreen,n=t.width,r=t.height;this.windowOffsetWidth=n,this.windowOffsetHeight=r}else if(this.gameData.metadata.zoomscreen){var o=this.gameData.metadata.zoomscreen,i=o.width,a=o.height;this.windowOffsetWidth=i,this.windowOffsetHeight=a}var s=this.gameData.getSpriteSize(),l=s.spriteHeight,u=s.spriteWidth;this.SPRITE_HEIGHT=l,this.SPRITE_WIDTH=u}},{key:"getGameData",value:function(){if(!this.gameData)throw new Error("BUG: Game has not been specified yet");return this.gameData}},{key:"onLevelChange",value:function(e,t,n){if(!t&&!n||t&&n)throw new Error("BUG: Must provide either cells or a message (but not both)");this.currentLevelCells=t,this.currentLevelMessage=n}},{key:"getCurrentLevelCells",value:function(){if(!this.currentLevelCells)throw new Error("BUG: There are no cells to render. Maybe it is a message level? Or no level has been set yet");return this.currentLevelCells}},{key:"debugRenderScreen",value:function(){this.renderScreen(!0)}},{key:"renderMessageScreen",value:function(e){var t=this.windowOffsetColStart,n=this.windowOffsetRowStart,r=this.windowOffsetHeight,o=this.windowOffsetWidth;this.windowOffsetColStart=0,this.windowOffsetRowStart=0,this.windowOffsetHeight=13,this.windowOffsetWidth=34,this.clearScreen(),this.windowOffsetColStart=t,this.windowOffsetRowStart=n,this.windowOffsetHeight=r,this.windowOffsetWidth=o}},{key:"renderScreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.gameData)throw new Error("BUG: gameData was not set yet");this.currentLevelMessage?this.renderMessageScreen(this.currentLevelMessage):this.currentLevelCells&&(e&&(this.cellColorCache.clear(),this.renderedPixels=[]),this.renderLevelScreen(this.currentLevelCells,t))}},{key:"drawCells",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.gameData)throw new Error("BUG: gameData was not set yet");var r=Object(i.g)(this.getCurrentLevelCells()),o=this.gameData.getPlayer().getCellsThatMatch(r);if(1===o.size&&n<=1){var s=a(o)[0],l=this.cellPosToXY(s).isOnScreen;this.recenterPlayerIfNeeded(s,l)&&(e=Object(i.g)(this.getCurrentLevelCells()))}this.hasVisualUi&&this.drawCellsAfterRecentering(e,n)}},{key:"getPixelsForCell",value:function(e){if(!this.gameData)throw new Error("BUG: gameData was not set yet");var t=e.getSprites().filter(function(e){return!e.isTransparent()}),n=this.gameData.getMagicBackgroundSprite();return n&&t.push(n),this.cellColorCache.get(t,this.gameData.metadata.backgroundColor,this.SPRITE_HEIGHT,this.SPRITE_WIDTH)}},{key:"createMessageTextScreen",value:function(e){var t=["                                  ","                                  ","                                  ","                                  ","                                  ","                                  ","                                  ","                                  ","                                  ","                                  ","          X to continue           ","                                  ","                                  "];var n=t[9],r=t[10];t[10]=n;var o=t[0].length,i=function(e,t){if(!e)return e;var n=".{1,"+(t=t||75)+"}(\\s|$)|.{"+t+"}|.+$",r=e.match(RegExp(n,"g"));if(r)return r;throw new Error("BUG: Match did not work")}(e,t[0].length),a=5-(i.length/2|0);a<0&&(a=0);for(var s=Math.min(i.length,12),l=0;l<s;l++){var u=i[l],c=a+l,f=(o-u.length)/2|0,h=t[c];t[c]=h.slice(0,f)+u+h.slice(f+u.length)}var p=10;return s>=10&&(p=s<12?s+1:12),t[p]=r,t}},{key:"createMessageSprites",value:function(e){if(!this.gameData)throw new Error("BUG: gameData was not set yet");var t=this.createMessageTextScreen(e),n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=[];n.push(u);var c=!0,f=!1,h=void 0;try{for(var p,m=l[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var y=p.value,d=this.gameData.getLetterSprite(y);u.push(new Set([d]))}}catch(e){f=!0,h=e}finally{try{c||null==m.return||m.return()}finally{if(f)throw h}}}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}},{key:"cellPosToXY",value:function(e){var t,n,r=e.colIndex,o=e.rowIndex,i=!0;return this.windowOffsetHeight&&this.windowOffsetWidth&&(this.windowOffsetColStart>r||this.windowOffsetRowStart>o||this.windowOffsetColStart+this.windowOffsetWidth<=r||this.windowOffsetRowStart+this.windowOffsetHeight<=o)&&(i=!1),t=(r-this.windowOffsetColStart)*this.SPRITE_WIDTH,n=(o-this.windowOffsetRowStart)*this.SPRITE_HEIGHT,i&&(i=this.checkIfCellCanBeDrawnOnScreen(t,n)),(t<0||n<0)&&(i=!1),{isOnScreen:i,cellStartX:t,cellStartY:n}}},{key:"clearScreen",value:function(){this.renderedPixels=[]}},{key:"recenterPlayerIfNeeded",value:function(e,t){if(!this.gameData)throw new Error("BUG: gameData was not set yet");var n,r,o,i,a,s,l=this.windowOffsetColStart,u=this.windowOffsetRowStart,c=this.gameData.metadata.flickscreen,f=this.gameData.metadata.zoomscreen,h=this.getMaxSize(),p=h.columns,m=h.rows,y=Math.floor(p/this.SPRITE_WIDTH/this.PIXEL_WIDTH),d=Math.floor(m/this.SPRITE_HEIGHT/this.PIXEL_HEIGHT);if(c?(r=e.rowIndex-e.rowIndex%c.height,n=e.colIndex-e.colIndex%c.width,i=c.height,o=c.width):(n=0,r=0,i=this.getCurrentLevelCells().length,o=this.getCurrentLevelCells()[0].length),f?(s=Math.min(f.height,d),a=Math.min(f.width,y)):(s=d,a=y),!(i<=s&&o<=a)){var v=!1;if(o>a&&(l+Math.round(a/4)>e.colIndex||l+Math.round(3*a/4)<=e.colIndex)){var b=e.colIndex-Math.floor(a/2);(b=Math.max(b,n))+a>n+o&&(b=n+o-a),b!==this.windowOffsetColStart&&(this.windowOffsetColStart=b,v=!0)}if(i>s&&(u+Math.round(s/4)>e.rowIndex||u+Math.round(3*s/4)<=e.rowIndex)){var g=e.rowIndex-Math.floor(s/2);(g=Math.max(g,r))+s>r+i&&(g=r+i-s),g!==this.windowOffsetRowStart&&(this.windowOffsetRowStart=g,v=!0)}return v||t?v:(this.windowOffsetColStart=n,this.windowOffsetRowStart=r,!0)}return!t&&(this.windowOffsetColStart=n,this.windowOffsetRowStart=r,!0)}}]),e}();function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){y(i,r,o,a,s,"next",e)}function s(e){y(i,r,o,a,s,"throw",e)}a(void 0)})}}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var S=function(e){function t(e,n){var r,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(r=!(a=g(t).call(this))||"object"!==h(a)&&"function"!=typeof a?_(o):a).table=e,r.tableCells=[],r.inputsProcessed=0,r.interactsWithPlayer=new Set,r.usedInMessages=new Set,e.classList.add("ps-table"),r.markAcceptingInput(!1),r.onPress=r.onPress.bind(_(_(r))),r.onLevelChange=r.onLevelChange.bind(_(_(r))),r.handler=new i.a(n?[n]:[]);var s=e.querySelector("[aria-live]")||document.querySelector("[aria-live]");if(!s)throw new Error("Error: For screenreaders to work, an element inside the table (for now) with an aria-live attribute needs to exist in the initial page. See https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/ARIA_Live_Regions");return r.liveLog=s,r.didPressCauseTick=!1,r.silencedOutput=!1,r.messagesSincePress=0,r.isCollecting=!1,r.collectedSprites=new Map,r.collectingTickCount=0,r}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(t,f),n=t,(a=[{key:"onPause",value:function(){this.table.setAttribute("data-ps-state","paused"),this.handler.onPause()}},{key:"onResume",value:function(){this.table.setAttribute("data-ps-state","running"),this.handler.onResume()}},{key:"onGameChange",value:function(e){b(g(t.prototype),"onGameChange",this).call(this,e),this.silencedOutput=!1,this.didPressCauseTick=!1,this.interactsWithPlayer=Object(i.q)(this.getGameData()),this.usedInMessages=new Set(this.interactsWithPlayer),this.collectedSprites.clear(),this.handler.onGameChange(e)}},{key:"onPress",value:function(e){switch(this.didPressCauseTick=!0,this.liveLog.innerHTML="",this.markAcceptingInput(!1),e){case i.b.UNDO:case i.b.RESTART:this.renderScreen(!1)}this.handler.onPress(e)}},{key:"onLevelChange",value:function(e,n,r){if(this.clearScreen(),this.table.setAttribute("data-ps-current-level","".concat(e)),n){b(g(t.prototype),"onLevelChange",this).call(this,e,n,r),this.tableCells=[];var o=this.getGameData(),i=o.metadata.flickscreen||o.metadata.zoomscreen||{width:n[0].length,height:n.length},a=i.width,s=i.height;this.table.setAttribute("tabindex","0");for(var l=document.createElement("tbody"),u=0;u<s;u++){for(var c=document.createElement("tr"),f=[],h=0;h<a;h++){var p=document.createElement("td"),m=[];p.classList.add("ps-cell");var y=document.createElement("span");y.classList.add("ps-cell-label"),p.appendChild(y);var d=document.createElement("div");d.classList.add("ps-sprite-whole"),d.setAttribute("aria-hidden","true");for(var v=0;v<this.SPRITE_HEIGHT;v++){var $=document.createElement("div");$.classList.add("ps-sprite-row");for(var _=[],S=0;S<this.SPRITE_WIDTH;S++){var w=document.createElement("span");w.classList.add("ps-sprite-pixel"),$.appendChild(w),_.push(w)}d.appendChild($),m.push(_)}p.appendChild(d),c.appendChild(p),f.push({td:p,label:y,pixels:m})}l.appendChild(c),this.tableCells.push(f)}this.table.prepend(l);var E=!0,T=!1,O=void 0;try{for(var R,k=n[Symbol.iterator]();!(E=(R=k.next()).done);E=!0){var L=R.value;this.drawCells(L,!1)}}catch(e){T=!0,O=e}finally{try{E||null==k.return||k.return()}finally{if(T)throw O}}}this.markAcceptingInput(!0),this.handler.onLevelChange(e,n,r)}},{key:"onMessage",value:function(){var e=d(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler.onMessage(t);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onWin",value:function(){this.handler.onWin()}},{key:"onSound",value:function(){var e=d(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Object(o.playSound)(t.soundCode),e.next=3,this.handler.onSound(t);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onTick",value:function(e,t,n){this.collectingTickCount++,this.printMessageLog(n,t),this.drawCells(e,!1),this.markAcceptingInput(!t),this.didPressCauseTick=!1,this.handler.onTick(e,t,n)}},{key:"willAllLevelsFitOnScreen",value:function(e){return!0}},{key:"_drawPixel",value:function(e,t,n,r,o){var i=Math.floor(t/this.SPRITE_HEIGHT),a=Math.floor(e/this.SPRITE_WIDTH),s=t%this.SPRITE_HEIGHT,l=e%this.SPRITE_WIDTH,u=this.tableCells[i][a].pixels[s][l];if(!u)throw new Error("BUG: Could not set pixel because table is too small");var c="color: ".concat(n,";");r&&(c+=" background-color: ".concat(r,";")),u.setAttribute("style",c)}},{key:"clearScreen",value:function(){b(g(t.prototype),"clearScreen",this).call(this);var e=this.table.querySelector("tbody");e&&e.remove(),this.liveLog.innerHTML="",this.tableCells=[]}},{key:"renderLevelScreen",value:function(e,t){this.drawCells(Object(i.g)(e),!1,t)}},{key:"setPixel",value:function(e,t,n,r,o){var i=Math.floor(t/this.SPRITE_HEIGHT),a=Math.floor(e/this.SPRITE_WIDTH),s=t%this.SPRITE_HEIGHT,l=e%this.SPRITE_WIDTH,u=this.tableCells[i][a].pixels[s][l];if(!u)throw new Error("BUG: Could not set pixel because table is too small");o&&0!==o.trim().length||(o=""),this.renderedPixels[t]||(this.renderedPixels[t]=[]);var c=this.renderedPixels[t][e];c&&c.hex===n&&c.chars===o||(this.renderedPixels[t][e]={hex:n,chars:o},u.setAttribute("style","background-color: ".concat(n)))}},{key:"drawCellsAfterRecentering",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;this._drawCell(s,t)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"checkIfCellCanBeDrawnOnScreen",value:function(e,t){return!0}},{key:"getMaxSize",value:function(){return{columns:1e3,rows:1e3}}},{key:"printMessageLog",value:function(e,t){var n=this;if(!this.silencedOutput||this.didPressCauseTick){var o=[],a=function(e,t){if(o.push(e),n.isCollecting){var r=!0,i=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value;c=n.collectedSprites,f=u,h=void 0,h=c.get(f),c.set(f,h?h+1:1)}}catch(e){i=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw a}}}var c,f,h};t&&a("game tick",[]);var s=!0,l=!1,u=void 0;try{for(var c,f=e[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var h=c.value;switch(h.type){case r.a.ADD:var y=!0,d=!1,v=void 0;try{for(var b,g=Object(i.o)(this.usedInMessages,h.sprites)[Symbol.iterator]();!(y=(b=g.next()).done);y=!0){var $=b.value;a("Added ".concat($.getName()," @ ").concat(h.cell.rowIndex,",").concat(h.cell.colIndex),[$])}}catch(e){d=!0,v=e}finally{try{y||null==g.return||g.return()}finally{if(d)throw v}}break;case r.a.REPLACE:var _=!0,S=!1,w=void 0;try{for(var E,T=h.replacements[Symbol.iterator]();!(_=(E=T.next()).done);_=!0){var O=E.value,R=O.oldSprite,k=O.newSprite;this.usedInMessages.has(R)?this.usedInMessages.has(k)?a("Replaced ".concat(R.getName()," with ").concat(k.getName()," @ ").concat(h.cell.rowIndex,",").concat(h.cell.colIndex),[R,k]):a("Removed* ".concat(R.getName()," @ ").concat(h.cell.rowIndex,",").concat(h.cell.colIndex),[R]):this.usedInMessages.has(k)&&a("Added* ".concat(k.getName()," @ ").concat(h.cell.rowIndex,",").concat(h.cell.colIndex),[k])}}catch(e){S=!0,w=e}finally{try{_||null==T.return||T.return()}finally{if(S)throw w}}break;case r.a.REMOVE:var L=!0,x=!1,C=void 0;try{for(var A,M=Object(i.o)(this.usedInMessages,h.sprites)[Symbol.iterator]();!(L=(A=M.next()).done);L=!0){var I=A.value;a("Removed ".concat(I.getName()," @ ").concat(h.cell.rowIndex,",").concat(h.cell.colIndex),[I])}}catch(e){x=!0,C=e}finally{try{L||null==M.return||M.return()}finally{if(x)throw C}}break;case r.a.MOVE:a("Moved ".concat(h.sprite.getName()," ").concat(h.direction," to ").concat(h.newCell.rowIndex,",").concat(h.newCell.colIndex),[h.sprite]);break;default:throw new Error("BUG: unsupported a11y message type ".concat(h))}}}catch(e){l=!0,u=e}finally{try{s||null==f.return||f.return()}finally{if(l)throw u}}if(this.didPressCauseTick)o.length>10&&(o=[].concat(m(o.slice(0,4)),["(truncated messages)"],m(o.slice(o.length-4,o.length))));else if(this.silencedOutput)o=[];else if(!this.isCollecting&&(this.messagesSincePress>10||o.length>10))this.collectedSprites.size>0?(this.silencedOutput=!0,o=["Things keep changing so switching to a quieter mode"]):(this.isCollecting=!0,this.collectingTickCount=0,o=["Many things changed (probably animations). Collecting data for a few ticks to see what to ignore"]);else if(this.isCollecting&&this.collectingTickCount<20)o=[];else if(this.isCollecting){this.isCollecting=!1,o=["Done collecting. Found ".concat(this.collectedSprites.size," sprites to ignore: ").concat(m(this.collectedSprites.keys()).map(function(e){return e.getName()}).join(", "))],this.messagesSincePress=0;var N=!0,P=!1,D=void 0;try{for(var G,B=this.collectedSprites[Symbol.iterator]();!(N=(G=B.next()).done);N=!0){var F=p(G.value,2);$=F[0];F[1]>4&&this.usedInMessages.delete($)}}catch(e){P=!0,D=e}finally{try{N||null==B.return||B.return()}finally{if(P)throw D}}}!function(){for(var e=0;e<o.length;e++){var t=o[e],r=document.createElement("p");r.textContent=t,n.liveLog.append(r),n.didPressCauseTick||n.messagesSincePress++}}(),this.didPressCauseTick&&(this.messagesSincePress=0)}}},{key:"markAcceptingInput",value:function(e){e?this.table.setAttribute("data-ps-accepting-input","true"):(this.inputsProcessed++,this.table.setAttribute("data-ps-accepting-input","false")),this.table.setAttribute("data-ps-last-input-processed","".concat(this.inputsProcessed))}},{key:"_drawCell",value:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.gameData)throw new Error("BUG: gameData was not set yet");if(!this.hasVisualUi)throw new Error("BUG: Should not get to this point");var n=e.getSprites().filter(function(e){return t.interactsWithPlayer.has(e)}),r=this.cellPosToXY(e),o=r.isOnScreen,i=r.cellStartX,a=r.cellStartY;if(o){var s=this.tableCells[e.rowIndex-this.windowOffsetRowStart];if(!s)throw new Error("BUG: Should not be trying to draw when there are no table cells");var l=s[e.colIndex-this.windowOffsetColStart];if(!l)throw new Error("BUG: Should not be trying to draw when there is not a matching table cell");var u=l.label;if(!u)throw new Error("BUG: Could not find cell in the table: [".concat(e.rowIndex," - ").concat(this.windowOffsetRowStart,"][").concat(e.colIndex," - ").concat(this.windowOffsetColStart,"]"));if(n.length>0)u.classList.remove("ps-cell-empty"),this.gameData.getPlayer().getSpritesThatMatch(e).size>0?u.classList.add("ps-player"):u.classList.remove("ps-player"),u.textContent=n.map(function(e){return e.getName()}).join(", ");else u.classList.remove("ps-player"),u.classList.add("ps-cell-empty"),u.textContent="(empty)";this.getPixelsForCell(e).forEach(function(e,n){e.forEach(function(e,r){if(!t.gameData)throw new Error("BUG: gameData was not set yet");var o=i+r,s=a+n,l=null;if(e&&(l=e.isTransparent()?t.gameData.metadata.backgroundColor?t.gameData.metadata.backgroundColor:null:e),l){var u=l.toRgb(),c=(u.r,u.g,u.b,l.toHex());t.setPixel(o,s,c,null," ")}})})}}}])&&v(n.prototype,a),s&&v(n,s),t}();t.a=S},function(e,t,n){(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n,r;n=this,r=function(){function e(t,n,r){return this.id=++e.highestId,this.name=t,this.symbols=n,this.postprocess=r,this}function t(e,t,n,r){this.rule=e,this.dot=t,this.reference=n,this.data=[],this.wantedBy=r,this.isComplete=this.dot===e.symbols.length}function n(e,t){this.grammar=e,this.index=t,this.states=[],this.wants={},this.scannable=[],this.completed={}}function r(e,t){this.rules=e,this.start=t||this.rules[0].name;var n=this.byName={};this.rules.forEach(function(e){n.hasOwnProperty(e.name)||(n[e.name]=[]),n[e.name].push(e)})}function o(){this.reset("")}function i(e,t,i){if(e instanceof r){var a=e;i=t}else a=r.fromCompiled(e,t);for(var s in this.grammar=a,this.options={keepHistory:!1,lexer:a.lexer||new o},i||{})this.options[s]=i[s];this.lexer=this.options.lexer,this.lexerState=void 0;var l=new n(a,0);this.table=[l];l.wants[a.start]=[],l.predict(a.start),l.process(),this.current=0}return e.highestId=0,e.prototype.toString=function(e){function t(e){return e.literal?JSON.stringify(e.literal):e.type?"%"+e.type:e.toString()}var n=void 0===e?this.symbols.map(t).join(" "):this.symbols.slice(0,e).map(t).join(" ")+"  "+this.symbols.slice(e).map(t).join(" ");return this.name+"  "+n},t.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},t.prototype.nextState=function(e){var n=new t(this.rule,this.dot+1,this.reference,this.wantedBy);return n.left=this,n.right=e,n.isComplete&&(n.data=n.build()),n},t.prototype.build=function(){var e=[],t=this;do{e.push(t.right.data),t=t.left}while(t.left);return e.reverse(),e},t.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,i.fail))},n.prototype.process=function(e){for(var t=this.states,n=this.wants,r=this.completed,o=0;o<t.length;o++){var a=t[o];if(a.isComplete){if(a.finish(),a.data!==i.fail){for(var s=a.wantedBy,l=s.length;l--;){var u=s[l];this.complete(u,a)}if(a.reference===this.index){var c=a.rule.name;(this.completed[c]=this.completed[c]||[]).push(a)}}}else{if("string"!=typeof(c=a.rule.symbols[a.dot])){this.scannable.push(a);continue}if(n[c]){if(n[c].push(a),r.hasOwnProperty(c)){var f=r[c];for(l=0;l<f.length;l++){var h=f[l];this.complete(a,h)}}}else n[c]=[a],this.predict(c)}}},n.prototype.predict=function(e){for(var n=this.grammar.byName[e]||[],r=0;r<n.length;r++){var o=n[r],i=this.wants[e],a=new t(o,0,this.index,i);this.states.push(a)}},n.prototype.complete=function(e,t){var n=e.nextState(t);this.states.push(n)},r.fromCompiled=function(t,n){var o=t.Lexer;t.ParserStart&&(n=t.ParserStart,t=t.ParserRules);var i=new r(t=t.map(function(t){return new e(t.name,t.symbols,t.postprocess)}),n);return i.lexer=o,i},o.prototype.reset=function(e,t){this.buffer=e,this.index=0,this.line=t?t.line:1,this.lastLineBreak=t?-t.col:0},o.prototype.next=function(){if(this.index<this.buffer.length){var e=this.buffer[this.index++];return"\n"===e&&(this.line+=1,this.lastLineBreak=this.index),{value:e}}},o.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},o.prototype.formatError=function(e,t){var n=this.buffer;if("string"==typeof n){var r=n.indexOf("\n",this.index);-1===r&&(r=n.length);var o=n.substring(this.lastLineBreak,r),i=this.index-this.lastLineBreak;return t+=" at line "+this.line+" col "+i+":\n\n",t+="  "+o+"\n",t+="  "+Array(i).join(" ")+"^"}return t+" at index "+(this.index-1)},i.fail={},i.prototype.feed=function(e){var t,r=this.lexer;for(r.reset(e,this.lexerState);t=r.next();){var i=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var a=this.current+1,s=new n(this.grammar,a);this.table.push(s);for(var l=void 0!==t.text?t.text:t.value,u=r.constructor===o?t.value:t,c=i.scannable,f=c.length;f--;){var h=c[f],p=h.rule.symbols[h.dot];if(p.test?p.test(u):p.type?p.type===t.type:p.literal===l){var m=h.nextState({data:u,token:t,isToken:!0,reference:a-1});s.states.push(m)}}if(s.process(),0===s.states.length){var y=this.lexer.formatError(t,"invalid syntax")+"\n";y+="Unexpected "+(t.type?t.type+" token: ":""),y+=JSON.stringify(void 0!==t.value?t.value:t)+"\n";var d=new Error(y);throw d.offset=this.current,d.token=t,d}this.options.keepHistory&&(i.lexerState=r.save()),this.current++}return i&&(this.lexerState=r.save()),this.results=this.finish(),this},i.prototype.save=function(){var e=this.table[this.current];return e.lexerState=this.lexerState,e},i.prototype.restore=function(e){var t=e.index;this.current=t,this.table[t]=e,this.table.splice(t+1),this.lexerState=e.lexerState,this.results=this.finish()},i.prototype.rewind=function(e){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[e])},i.prototype.finish=function(){var e=[],t=this.grammar.start;return this.table[this.table.length-1].states.forEach(function(n){n.rule.name===t&&n.dot===n.rule.symbols.length&&0===n.reference&&n.data!==i.fail&&e.push(n)}),e.map(function(e){return e.data})},{Parser:i,Grammar:r,Rule:e}},"object"===t(e)&&e.exports?e.exports=r():n.nearley=r()}).call(this,n(148)(e))},function(e,t,n){"use strict";(function(e){if(n(154),n(350),n(351),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var t="defineProperty";function r(e,n,r){e[n]||Object[t](e,n,{writable:!0,configurable:!0,value:r})}r(String.prototype,"padLeft","".padStart),r(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&r(Array,e,Function.call.bind([][e]))})}).call(this,n(108))},function(e,t,n){n(155),n(157),n(158),n(159),n(160),n(161),n(162),n(163),n(164),n(165),n(166),n(167),n(168),n(169),n(170),n(171),n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(234),n(235),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(98),n(258),n(128),n(259),n(129),n(260),n(261),n(262),n(263),n(264),n(132),n(134),n(135),n(265),n(266),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),e.exports=n(24)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(4),i=n(20),a=n(10),s=n(1),l=n(17),u=n(36).KEY,c=n(5),f=n(62),h=n(50),p=n(41),m=n(8),y=n(110),d=n(79),v=n(156),b=n(65),g=n(3),$=n(6),_=n(21),S=n(30),w=n(40),E=n(44),T=n(113),O=n(22),R=n(11),k=n(42),L=O.f,x=R.f,C=T.f,A=o.Symbol,M=o.JSON,I=M&&M.stringify,N=m("_hidden"),P=m("toPrimitive"),D={}.propertyIsEnumerable,G=f("symbol-registry"),B=f("symbols"),F=f("op-symbols"),U=Object.prototype,W="function"==typeof A,j=o.QObject,H=!j||!j.prototype||!j.prototype.findChild,V=a&&c(function(){return 7!=E(x({},"a",{get:function(){return x(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=L(U,t);r&&delete U[t],x(e,t,n),r&&e!==U&&x(U,t,r)}:x,q=function(e){var t=B[e]=E(A.prototype);return t._k=e,t},X=W&&"symbol"==r(A.iterator)?function(e){return"symbol"==r(e)}:function(e){return e instanceof A},z=function(e,t,n){return e===U&&z(F,t,n),g(e),t=S(t,!0),g(n),i(B,t)?(n.enumerable?(i(e,N)&&e[N][t]&&(e[N][t]=!1),n=E(n,{enumerable:w(0,!1)})):(i(e,N)||x(e,N,w(1,{})),e[N][t]=!0),V(e,t,n)):x(e,t,n)},K=function(e,t){g(e);for(var n,r=v(t=_(t)),o=0,i=r.length;i>o;)z(e,n=r[o++],t[n]);return e},Y=function(e){var t=D.call(this,e=S(e,!0));return!(this===U&&i(B,e)&&!i(F,e))&&(!(t||!i(this,e)||!i(B,e)||i(this,N)&&this[N][e])||t)},J=function(e,t){if(e=_(e),t=S(t,!0),e!==U||!i(B,t)||i(F,t)){var n=L(e,t);return!n||!i(B,t)||i(e,N)&&e[N][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=C(_(e)),r=[],o=0;n.length>o;)i(B,t=n[o++])||t==N||t==u||r.push(t);return r},Q=function(e){for(var t,n=e===U,r=C(n?F:_(e)),o=[],a=0;r.length>a;)!i(B,t=r[a++])||n&&!i(U,t)||o.push(B[t]);return o};W||(l((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var e=p(arguments.length>0?arguments[0]:void 0);return a&&H&&V(U,e,{configurable:!0,set:function t(n){this===U&&t.call(F,n),i(this,N)&&i(this[N],e)&&(this[N][e]=!1),V(this,e,w(1,n))}}),q(e)}).prototype,"toString",function(){return this._k}),O.f=J,R.f=z,n(45).f=T.f=Z,n(58).f=Y,n(64).f=Q,a&&!n(37)&&l(U,"propertyIsEnumerable",Y,!0),y.f=function(e){return q(m(e))}),s(s.G+s.W+s.F*!W,{Symbol:A});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)m(ee[te++]);for(var ne=k(m.store),re=0;ne.length>re;)d(ne[re++]);s(s.S+s.F*!W,"Symbol",{for:function(e){return i(G,e+="")?G[e]:G[e]=A(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in G)if(G[t]===e)return t},useSetter:function(){H=!0},useSimple:function(){H=!1}}),s(s.S+s.F*!W,"Object",{create:function(e,t){return void 0===t?E(e):K(E(e),t)},defineProperty:z,defineProperties:K,getOwnPropertyDescriptor:J,getOwnPropertyNames:Z,getOwnPropertySymbols:Q}),M&&s(s.S+s.F*(!W||c(function(){var e=A();return"[null]"!=I([e])||"{}"!=I({a:e})||"{}"!=I(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],o=1;arguments.length>o;)r.push(arguments[o++]);if(n=t=r[1],($(t)||void 0!==e)&&!X(e))return b(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!X(t))return t}),r[1]=t,I.apply(M,r)}}),A.prototype[P]||n(16)(A.prototype,P,A.prototype.valueOf),h(A,"Symbol"),h(Math,"Math",!0),h(o.JSON,"JSON",!0)},function(e,t,n){var r=n(42),o=n(64),i=n(58);e.exports=function(e){var t=r(e),n=o.f;if(n)for(var a,s=n(e),l=i.f,u=0;s.length>u;)l.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,n){var r=n(1);r(r.S,"Object",{create:n(44)})},function(e,t,n){var r=n(1);r(r.S+r.F*!n(10),"Object",{defineProperty:n(11).f})},function(e,t,n){var r=n(1);r(r.S+r.F*!n(10),"Object",{defineProperties:n(112)})},function(e,t,n){var r=n(21),o=n(22).f;n(32)("getOwnPropertyDescriptor",function(){return function(e,t){return o(r(e),t)}})},function(e,t,n){var r=n(12),o=n(23);n(32)("getPrototypeOf",function(){return function(e){return o(r(e))}})},function(e,t,n){var r=n(12),o=n(42);n(32)("keys",function(){return function(e){return o(r(e))}})},function(e,t,n){n(32)("getOwnPropertyNames",function(){return n(113).f})},function(e,t,n){var r=n(6),o=n(36).onFreeze;n(32)("freeze",function(e){return function(t){return e&&r(t)?e(o(t)):t}})},function(e,t,n){var r=n(6),o=n(36).onFreeze;n(32)("seal",function(e){return function(t){return e&&r(t)?e(o(t)):t}})},function(e,t,n){var r=n(6),o=n(36).onFreeze;n(32)("preventExtensions",function(e){return function(t){return e&&r(t)?e(o(t)):t}})},function(e,t,n){var r=n(6);n(32)("isFrozen",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(6);n(32)("isSealed",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(6);n(32)("isExtensible",function(e){return function(t){return!!r(t)&&(!e||e(t))}})},function(e,t,n){var r=n(1);r(r.S+r.F,"Object",{assign:n(114)})},function(e,t,n){var r=n(1);r(r.S,"Object",{is:n(115)})},function(e,t,n){var r=n(1);r(r.S,"Object",{setPrototypeOf:n(83).set})},function(e,t,n){"use strict";var r=n(51),o={};o[n(8)("toStringTag")]="z",o+""!="[object z]"&&n(17)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(e,t,n){var r=n(1);r(r.P,"Function",{bind:n(116)})},function(e,t,n){var r=n(11).f,o=Function.prototype,i=/^\s*function ([^ (]*)/;"name"in o||n(10)&&r(o,"name",{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(6),o=n(23),i=n(8)("hasInstance"),a=Function.prototype;i in a||n(11).f(a,i,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=o(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){var r=n(1),o=n(118);r(r.G+r.F*(parseInt!=o),{parseInt:o})},function(e,t,n){var r=n(1),o=n(119);r(r.G+r.F*(parseFloat!=o),{parseFloat:o})},function(e,t,n){"use strict";var r=n(4),o=n(20),i=n(26),a=n(85),s=n(30),l=n(5),u=n(45).f,c=n(22).f,f=n(11).f,h=n(52).trim,p=r.Number,m=p,y=p.prototype,d="Number"==i(n(44)(y)),v="trim"in String.prototype,b=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){var n,r,o,i=(t=v?t.trim():h(t,3)).charCodeAt(0);if(43===i||45===i){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===i){switch(t.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+t}for(var a,l=t.slice(2),u=0,c=l.length;u<c;u++)if((a=l.charCodeAt(u))<48||a>o)return NaN;return parseInt(l,r)}}return+t};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof p&&(d?l(function(){y.valueOf.call(n)}):"Number"!=i(n))?a(new m(b(t)),n,p):b(t)};for(var g,$=n(10)?u(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;$.length>_;_++)o(m,g=$[_])&&!o(p,g)&&f(p,g,c(m,g));p.prototype=y,y.constructor=p,n(17)(r,"Number",p)}},function(e,t,n){"use strict";var r=n(1),o=n(27),i=n(120),a=n(86),s=1..toFixed,l=Math.floor,u=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",f=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*u[n],u[n]=r%1e7,r=l(r/1e7)},h=function(e){for(var t=6,n=0;--t>=0;)n+=u[t],u[t]=l(n/e),n=n%e*1e7},p=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==u[e]){var n=String(u[e]);t=""===t?n:t+a.call("0",7-n.length)+n}return t},m=function e(t,n,r){return 0===n?r:n%2==1?e(t,n-1,r*t):e(t*t,n/2,r)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(5)(function(){s.call({})})),"Number",{toFixed:function(e){var t,n,r,s,l=i(this,c),u=o(e),y="",d="0";if(u<0||u>20)throw RangeError(c);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(y="-",l=-l),l>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(l*m(2,69,1))-69)<0?l*m(2,-t,1):l/m(2,t,1),n*=4503599627370496,(t=52-t)>0){for(f(0,n),r=u;r>=7;)f(1e7,0),r-=7;for(f(m(10,r,1),0),r=t-1;r>=23;)h(1<<23),r-=23;h(1<<r),f(1,1),h(2),d=p()}else f(0,n),f(1<<-t,0),d=p()+a.call("0",u);return d=u>0?y+((s=d.length)<=u?"0."+a.call("0",u-s)+d:d.slice(0,s-u)+"."+d.slice(s-u)):y+d}})},function(e,t,n){"use strict";var r=n(1),o=n(5),i=n(120),a=1..toPrecision;r(r.P+r.F*(o(function(){return"1"!==a.call(1,void 0)})||!o(function(){a.call({})})),"Number",{toPrecision:function(e){var t=i(this,"Number#toPrecision: incorrect invocation!");return void 0===e?a.call(t):a.call(t,e)}})},function(e,t,n){var r=n(1);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var r=n(1),o=n(4).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&o(e)}})},function(e,t,n){var r=n(1);r(r.S,"Number",{isInteger:n(121)})},function(e,t,n){var r=n(1);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(1),o=n(121),i=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return o(e)&&i(e)<=9007199254740991}})},function(e,t,n){var r=n(1);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(1);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(1),o=n(119);r(r.S+r.F*(Number.parseFloat!=o),"Number",{parseFloat:o})},function(e,t,n){var r=n(1),o=n(118);r(r.S+r.F*(Number.parseInt!=o),"Number",{parseInt:o})},function(e,t,n){var r=n(1),o=n(122),i=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:o(e-1+i(e-1)*i(e+1))}})},function(e,t,n){var r=n(1),o=Math.asinh;r(r.S+r.F*!(o&&1/o(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,n){var r=n(1),o=Math.atanh;r(r.S+r.F*!(o&&1/o(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var r=n(1),o=n(87);r(r.S,"Math",{cbrt:function(e){return o(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){var r=n(1);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var r=n(1),o=Math.exp;r(r.S,"Math",{cosh:function(e){return(o(e=+e)+o(-e))/2}})},function(e,t,n){var r=n(1),o=n(88);r(r.S+r.F*(o!=Math.expm1),"Math",{expm1:o})},function(e,t,n){var r=n(1);r(r.S,"Math",{fround:n(123)})},function(e,t,n){var r=n(1),o=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,i=0,a=0,s=arguments.length,l=0;a<s;)l<(n=o(arguments[a++]))?(i=i*(r=l/n)*r+1,l=n):i+=n>0?(r=n/l)*r:n;return l===1/0?1/0:l*Math.sqrt(i)}})},function(e,t,n){var r=n(1),o=Math.imul;r(r.S+r.F*n(5)(function(){return-5!=o(4294967295,5)||2!=o.length}),"Math",{imul:function(e,t){var n=+e,r=+t,o=65535&n,i=65535&r;return 0|o*i+((65535&n>>>16)*i+o*(65535&r>>>16)<<16>>>0)}})},function(e,t,n){var r=n(1);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){var r=n(1);r(r.S,"Math",{log1p:n(122)})},function(e,t,n){var r=n(1);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var r=n(1);r(r.S,"Math",{sign:n(87)})},function(e,t,n){var r=n(1),o=n(88),i=Math.exp;r(r.S+r.F*n(5)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(o(e)-o(-e))/2:(i(e-1)-i(-e-1))*(Math.E/2)}})},function(e,t,n){var r=n(1),o=n(88),i=Math.exp;r(r.S,"Math",{tanh:function(e){var t=o(e=+e),n=o(-e);return t==1/0?1:n==1/0?-1:(t-n)/(i(e)+i(-e))}})},function(e,t,n){var r=n(1);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){var r=n(1),o=n(43),i=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,a=0;r>a;){if(t=+arguments[a++],o(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?i(t):i(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var r=n(1),o=n(21),i=n(9);r(r.S,"String",{raw:function(e){for(var t=o(e.raw),n=i(t.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(t[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(e,t,n){"use strict";n(52)("trim",function(e){return function(){return e(this,3)}})},function(e,t,n){"use strict";var r=n(66)(!0);n(89)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var r=n(1),o=n(66)(!1);r(r.P,"String",{codePointAt:function(e){return o(this,e)}})},function(e,t,n){"use strict";var r=n(1),o=n(9),i=n(91),a="".endsWith;r(r.P+r.F*n(92)("endsWith"),"String",{endsWith:function(e){var t=i(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=o(t.length),s=void 0===n?r:Math.min(o(n),r),l=String(e);return a?a.call(t,l,s):t.slice(s-l.length,s)===l}})},function(e,t,n){"use strict";var r=n(1),o=n(91);r(r.P+r.F*n(92)("includes"),"String",{includes:function(e){return!!~o(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(1);r(r.P,"String",{repeat:n(86)})},function(e,t,n){"use strict";var r=n(1),o=n(9),i=n(91),a="".startsWith;r(r.P+r.F*n(92)("startsWith"),"String",{startsWith:function(e){var t=i(this,e,"startsWith"),n=o(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return a?a.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(18)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},function(e,t,n){"use strict";n(18)("big",function(e){return function(){return e(this,"big","","")}})},function(e,t,n){"use strict";n(18)("blink",function(e){return function(){return e(this,"blink","","")}})},function(e,t,n){"use strict";n(18)("bold",function(e){return function(){return e(this,"b","","")}})},function(e,t,n){"use strict";n(18)("fixed",function(e){return function(){return e(this,"tt","","")}})},function(e,t,n){"use strict";n(18)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},function(e,t,n){"use strict";n(18)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},function(e,t,n){"use strict";n(18)("italics",function(e){return function(){return e(this,"i","","")}})},function(e,t,n){"use strict";n(18)("link",function(e){return function(t){return e(this,"a","href",t)}})},function(e,t,n){"use strict";n(18)("small",function(e){return function(){return e(this,"small","","")}})},function(e,t,n){"use strict";n(18)("strike",function(e){return function(){return e(this,"strike","","")}})},function(e,t,n){"use strict";n(18)("sub",function(e){return function(){return e(this,"sub","","")}})},function(e,t,n){"use strict";n(18)("sup",function(e){return function(){return e(this,"sup","","")}})},function(e,t,n){var r=n(1);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(1),o=n(12),i=n(30);r(r.P+r.F*n(5)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=o(this),n=i(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(1),o=n(233);r(r.P+r.F*(Date.prototype.toISOString!==o),"Date",{toISOString:o})},function(e,t,n){"use strict";var r=n(5),o=Date.prototype.getTime,i=Date.prototype.toISOString,a=function(e){return e>9?e:"0"+e};e.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=i.call(new Date(-5e13-1))})||!r(function(){i.call(new Date(NaN))})?function(){if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:i},function(e,t,n){var r=Date.prototype,o=r.toString,i=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(17)(r,"toString",function(){var e=i.call(this);return e==e?o.call(this):"Invalid Date"})},function(e,t,n){var r=n(8)("toPrimitive"),o=Date.prototype;r in o||n(16)(o,r,n(236))},function(e,t,n){"use strict";var r=n(3),o=n(30);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return o(r(this),"number"!=e)}},function(e,t,n){var r=n(1);r(r.S,"Array",{isArray:n(65)})},function(e,t,n){"use strict";var r=n(25),o=n(1),i=n(12),a=n(124),s=n(93),l=n(9),u=n(94),c=n(95);o(o.S+o.F*!n(68)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,o,f,h=i(e),p="function"==typeof this?this:Array,m=arguments.length,y=m>1?arguments[1]:void 0,d=void 0!==y,v=0,b=c(h);if(d&&(y=r(y,m>2?arguments[2]:void 0,2)),null==b||p==Array&&s(b))for(n=new p(t=l(h.length));t>v;v++)u(n,v,d?y(h[v],v):h[v]);else for(f=b.call(h),n=new p;!(o=f.next()).done;v++)u(n,v,d?a(f,y,[o.value,v],!0):o.value);return n.length=v,n}})},function(e,t,n){"use strict";var r=n(1),o=n(94);r(r.S+r.F*n(5)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)o(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(1),o=n(21),i=[].join;r(r.P+r.F*(n(57)!=Object||!n(28)(i)),"Array",{join:function(e){return i.call(o(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(1),o=n(82),i=n(26),a=n(43),s=n(9),l=[].slice;r(r.P+r.F*n(5)(function(){o&&l.call(o)}),"Array",{slice:function(e,t){var n=s(this.length),r=i(this);if(t=void 0===t?n:t,"Array"==r)return l.call(this,e,t);for(var o=a(e,n),u=a(t,n),c=s(u-o),f=new Array(c),h=0;h<c;h++)f[h]="String"==r?this.charAt(o+h):this[o+h];return f}})},function(e,t,n){"use strict";var r=n(1),o=n(15),i=n(12),a=n(5),s=[].sort,l=[1,2,3];r(r.P+r.F*(a(function(){l.sort(void 0)})||!a(function(){l.sort(null)})||!n(28)(s)),"Array",{sort:function(e){return void 0===e?s.call(i(this)):s.call(i(this),o(e))}})},function(e,t,n){"use strict";var r=n(1),o=n(33)(0),i=n(28)([].forEach,!0);r(r.P+r.F*!i,"Array",{forEach:function(e){return o(this,e,arguments[1])}})},function(e,t,n){var r=n(6),o=n(65),i=n(8)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(1),o=n(33)(1);r(r.P+r.F*!n(28)([].map,!0),"Array",{map:function(e){return o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(1),o=n(33)(2);r(r.P+r.F*!n(28)([].filter,!0),"Array",{filter:function(e){return o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(1),o=n(33)(3);r(r.P+r.F*!n(28)([].some,!0),"Array",{some:function(e){return o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(1),o=n(33)(4);r(r.P+r.F*!n(28)([].every,!0),"Array",{every:function(e){return o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(1),o=n(125);r(r.P+r.F*!n(28)([].reduce,!0),"Array",{reduce:function(e){return o(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(1),o=n(125);r(r.P+r.F*!n(28)([].reduceRight,!0),"Array",{reduceRight:function(e){return o(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(1),o=n(63)(!1),i=[].indexOf,a=!!i&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(28)(i)),"Array",{indexOf:function(e){return a?i.apply(this,arguments)||0:o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(1),o=n(21),i=n(27),a=n(9),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(l||!n(28)(s)),"Array",{lastIndexOf:function(e){if(l)return s.apply(this,arguments)||0;var t=o(this),n=a(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,i(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){var r=n(1);r(r.P,"Array",{copyWithin:n(126)}),n(38)("copyWithin")},function(e,t,n){var r=n(1);r(r.P,"Array",{fill:n(97)}),n(38)("fill")},function(e,t,n){"use strict";var r=n(1),o=n(33)(5),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),r(r.P+r.F*i,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(38)("find")},function(e,t,n){"use strict";var r=n(1),o=n(33)(6),i="findIndex",a=!0;i in[]&&Array(1)[i](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(38)(i)},function(e,t,n){n(46)("Array")},function(e,t,n){var r=n(4),o=n(85),i=n(11).f,a=n(45).f,s=n(67),l=n(59),u=r.RegExp,c=u,f=u.prototype,h=/a/g,p=/a/g,m=new u(h)!==h;if(n(10)&&(!m||n(5)(function(){return p[n(8)("match")]=!1,u(h)!=h||u(p)==p||"/a/i"!=u(h,"i")}))){u=function(e,t){var n=this instanceof u,r=s(e),i=void 0===t;return!n&&r&&e.constructor===u&&i?e:o(m?new c(r&&!i?e.source:e,t):c((r=e instanceof u)?e.source:e,r&&i?l.call(e):t),n?this:f,u)};for(var y=function(e){e in u||i(u,e,{configurable:!0,get:function(){return c[e]},set:function(t){c[e]=t}})},d=a(c),v=0;d.length>v;)y(d[v++]);f.constructor=u,u.prototype=f,n(17)(r,"RegExp",u)}n(46)("RegExp")},function(e,t,n){"use strict";n(129);var r=n(3),o=n(59),i=n(10),a=/./.toString,s=function(e){n(17)(RegExp.prototype,"toString",e,!0)};n(5)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!i&&e instanceof RegExp?o.call(e):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(e,t,n){"use strict";var r=n(3),o=n(9),i=n(100),a=n(69);n(70)("match",1,function(e,t,n,s){return[function(n){var r=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=s(n,e,this);if(t.done)return t.value;var l=r(e),u=String(this);if(!l.global)return a(l,u);var c=l.unicode;l.lastIndex=0;for(var f,h=[],p=0;null!==(f=a(l,u));){var m=String(f[0]);h[p]=m,""===m&&(l.lastIndex=i(u,o(l.lastIndex),c)),p++}return 0===p?null:h}]})},function(e,t,n){"use strict";var r=n(3),o=n(12),i=n(9),a=n(27),s=n(100),l=n(69),u=Math.max,c=Math.min,f=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;n(70)("replace",2,function(e,t,n,m){return[function(r,o){var i=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,i,o):n.call(String(i),r,o)},function(e,t){var o=m(n,e,this,t);if(o.done)return o.value;var f=r(e),h=String(this),p="function"==typeof t;p||(t=String(t));var d=f.global;if(d){var v=f.unicode;f.lastIndex=0}for(var b=[];;){var g=l(f,h);if(null===g)break;if(b.push(g),!d)break;""===String(g[0])&&(f.lastIndex=s(h,i(f.lastIndex),v))}for(var $,_="",S=0,w=0;w<b.length;w++){g=b[w];for(var E=String(g[0]),T=u(c(a(g.index),h.length),0),O=[],R=1;R<g.length;R++)O.push(void 0===($=g[R])?$:String($));var k=g.groups;if(p){var L=[E].concat(O,T,h);void 0!==k&&L.push(k);var x=String(t.apply(void 0,L))}else x=y(E,h,T,O,k,t);T>=S&&(_+=h.slice(S,T)+x,S=T+E.length)}return _+h.slice(S)}];function y(e,t,r,i,a,s){var l=r+e.length,u=i.length,c=p;return void 0!==a&&(a=o(a),c=h),n.call(s,c,function(n,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(l);case"<":s=a[o.slice(1,-1)];break;default:var c=+o;if(0===c)return o;if(c>u){var h=f(c/10);return 0===h?o:h<=u?void 0===i[h-1]?o.charAt(1):i[h-1]+o.charAt(1):o}s=i[c-1]}return void 0===s?"":s})}})},function(e,t,n){"use strict";var r=n(3),o=n(115),i=n(69);n(70)("search",1,function(e,t,n,a){return[function(n){var r=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=a(n,e,this);if(t.done)return t.value;var s=r(e),l=String(this),u=s.lastIndex;o(u,0)||(s.lastIndex=0);var c=i(s,l);return o(s.lastIndex,u)||(s.lastIndex=u),null===c?-1:c.index}]})},function(e,t,n){"use strict";var r=n(67),o=n(3),i=n(60),a=n(100),s=n(9),l=n(69),u=n(99),c=Math.min,f=[].push,h=!!function(){try{return new RegExp("x","y")}catch(e){}}();n(70)("split",2,function(e,t,n,p){var m=n;return"c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?m=function(e,t){var o=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(o,e,t);for(var i,a,s,l=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,p=void 0===t?4294967295:t>>>0,m=new RegExp(e.source,c+"g");(i=u.call(m,o))&&!((a=m.lastIndex)>h&&(l.push(o.slice(h,i.index)),i.length>1&&i.index<o.length&&f.apply(l,i.slice(1)),s=i[0].length,h=a,l.length>=p));)m.lastIndex===i.index&&m.lastIndex++;return h===o.length?!s&&m.test("")||l.push(""):l.push(o.slice(h)),l.length>p?l.slice(0,p):l}:"0".split(void 0,0).length&&(m=function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}),[function(n,r){var o=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,o,r):m.call(String(o),n,r)},function(e,t){var r=p(m,e,this,t,m!==n);if(r.done)return r.value;var u=o(e),f=String(this),y=i(u,RegExp),d=u.unicode,v=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(h?"y":"g"),b=new y(h?u:"^(?:"+u.source+")",v),g=void 0===t?4294967295:t>>>0;if(0===g)return[];if(0===f.length)return null===l(b,f)?[f]:[];for(var $=0,_=0,S=[];_<f.length;){b.lastIndex=h?_:0;var w,E=l(b,h?f:f.slice(_));if(null===E||(w=c(s(b.lastIndex+(h?0:_)),f.length))===$)_=a(f,_,d);else{if(S.push(f.slice($,_)),S.length===g)return S;for(var T=1;T<=E.length-1;T++)if(S.push(E[T]),S.length===g)return S;_=$=w}}return S.push(f.slice($)),S}]})},function(e,t,n){"use strict";var r,o,i,a,s=n(37),l=n(4),u=n(25),c=n(51),f=n(1),h=n(6),p=n(15),m=n(47),y=n(48),d=n(60),v=n(101).set,b=n(102)(),g=n(103),$=n(130),_=n(71),S=n(131),w=l.TypeError,E=l.process,T=E&&E.versions,O=T&&T.v8||"",R=l.Promise,k="process"==c(E),L=function(){},x=o=g.f,C=!!function(){try{var e=R.resolve(1),t=(e.constructor={})[n(8)("species")]=function(e){e(L,L)};return(k||"function"==typeof PromiseRejectionEvent)&&e.then(L)instanceof t&&0!==O.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(e){}}(),A=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;b(function(){for(var r=e._v,o=1==e._s,i=0,a=function(t){var n,i,a,s=o?t.ok:t.fail,l=t.resolve,u=t.reject,c=t.domain;try{s?(o||(2==e._h&&P(e),e._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&(c.exit(),a=!0)),n===t.promise?u(w("Promise-chain cycle")):(i=A(n))?i.call(n,l,u):l(n)):u(r)}catch(e){c&&!a&&c.exit(),u(e)}};n.length>i;)a(n[i++]);e._c=[],e._n=!1,t&&!e._h&&I(e)})}},I=function(e){v.call(l,function(){var t,n,r,o=e._v,i=N(e);if(i&&(t=$(function(){k?E.emit("unhandledRejection",o,e):(n=l.onunhandledrejection)?n({promise:e,reason:o}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",o)}),e._h=k||N(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},N=function(e){return 1!==e._h&&0===(e._a||e._c).length},P=function(e){v.call(l,function(){var t;k?E.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},D=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},G=function e(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw w("Promise can't be resolved itself");(n=A(t))?b(function(){var o={_w:r,_d:!1};try{n.call(t,u(e,o,1),u(D,o,1))}catch(e){D.call(o,e)}}):(r._v=t,r._s=1,M(r,!1))}catch(e){D.call({_w:r,_d:!1},e)}}};C||(R=function(e){m(this,R,"Promise","_h"),p(e),r.call(this);try{e(u(G,this,1),u(D,this,1))}catch(e){D.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(49)(R.prototype,{then:function(e,t){var n=x(d(this,R));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=k?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=u(G,e,1),this.reject=u(D,e,1)},g.f=x=function(e){return e===R||e===a?new i(e):o(e)}),f(f.G+f.W+f.F*!C,{Promise:R}),n(50)(R,"Promise"),n(46)("Promise"),a=n(24).Promise,f(f.S+f.F*!C,"Promise",{reject:function(e){var t=x(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(s||!C),"Promise",{resolve:function(e){return S(s&&this===a?R:this,e)}}),f(f.S+f.F*!(C&&n(68)(function(e){R.all(e).catch(L)})),"Promise",{all:function(e){var t=this,n=x(t),r=n.resolve,o=n.reject,i=$(function(){var n=[],i=0,a=1;y(e,!1,function(e){var s=i++,l=!1;n.push(void 0),a++,t.resolve(e).then(function(e){l||(l=!0,n[s]=e,--a||r(n))},o)}),--a||r(n)});return i.e&&o(i.v),n.promise},race:function(e){var t=this,n=x(t),r=n.reject,o=$(function(){y(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(e,t,n){"use strict";var r=n(136),o=n(54);n(72)("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(o(this,"WeakSet"),e,!0)}},r,!1,!0)},function(e,t,n){"use strict";var r=n(1),o=n(73),i=n(104),a=n(3),s=n(43),l=n(9),u=n(6),c=n(4).ArrayBuffer,f=n(60),h=i.ArrayBuffer,p=i.DataView,m=o.ABV&&c.isView,y=h.prototype.slice,d=o.VIEW;r(r.G+r.W+r.F*(c!==h),{ArrayBuffer:h}),r(r.S+r.F*!o.CONSTR,"ArrayBuffer",{isView:function(e){return m&&m(e)||u(e)&&d in e}}),r(r.P+r.U+r.F*n(5)(function(){return!new h(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==y&&void 0===t)return y.call(a(this),e);for(var n=a(this).byteLength,r=s(e,n),o=s(void 0===t?n:t,n),i=new(f(this,h))(l(o-r)),u=new p(this),c=new p(i),m=0;r<o;)c.setUint8(m++,u.getUint8(r++));return i}}),n(46)("ArrayBuffer")},function(e,t,n){var r=n(1);r(r.G+r.W+r.F*!n(73).ABV,{DataView:n(104).DataView})},function(e,t,n){n(34)("Int8",1,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(34)("Uint8",1,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(34)("Uint8",1,function(e){return function(t,n,r){return e(this,t,n,r)}},!0)},function(e,t,n){n(34)("Int16",2,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(34)("Uint16",2,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(34)("Int32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(34)("Uint32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(34)("Float32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(34)("Float64",8,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){var r=n(1),o=n(15),i=n(3),a=(n(4).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(5)(function(){a(function(){})}),"Reflect",{apply:function(e,t,n){var r=o(e),l=i(n);return a?a(r,t,l):s.call(r,t,l)}})},function(e,t,n){var r=n(1),o=n(44),i=n(15),a=n(3),s=n(6),l=n(5),u=n(116),c=(n(4).Reflect||{}).construct,f=l(function(){function e(){}return!(c(function(){},[],e)instanceof e)}),h=!l(function(){c(function(){})});r(r.S+r.F*(f||h),"Reflect",{construct:function(e,t){i(e),a(t);var n=arguments.length<3?e:i(arguments[2]);if(h&&!f)return c(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(u.apply(e,r))}var l=n.prototype,p=o(s(l)?l:Object.prototype),m=Function.apply.call(e,p,t);return s(m)?m:p}})},function(e,t,n){var r=n(11),o=n(1),i=n(3),a=n(30);o(o.S+o.F*n(5)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,n){i(e),t=a(t,!0),i(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(1),o=n(22).f,i=n(3);r(r.S,"Reflect",{deleteProperty:function(e,t){var n=o(i(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){"use strict";var r=n(1),o=n(3),i=function(e){this._t=o(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(90)(i,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),r(r.S,"Reflect",{enumerate:function(e){return new i(e)}})},function(e,t,n){var r=n(22),o=n(23),i=n(20),a=n(1),s=n(6),l=n(3);a(a.S,"Reflect",{get:function e(t,n){var a,u,c=arguments.length<3?t:arguments[2];return l(t)===c?t[n]:(a=r.f(t,n))?i(a,"value")?a.value:void 0!==a.get?a.get.call(c):void 0:s(u=o(t))?e(u,n,c):void 0}})},function(e,t,n){var r=n(22),o=n(1),i=n(3);o(o.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(i(e),t)}})},function(e,t,n){var r=n(1),o=n(23),i=n(3);r(r.S,"Reflect",{getPrototypeOf:function(e){return o(i(e))}})},function(e,t,n){var r=n(1);r(r.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){var r=n(1),o=n(3),i=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return o(e),!i||i(e)}})},function(e,t,n){var r=n(1);r(r.S,"Reflect",{ownKeys:n(138)})},function(e,t,n){var r=n(1),o=n(3),i=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){o(e);try{return i&&i(e),!0}catch(e){return!1}}})},function(e,t,n){var r=n(11),o=n(22),i=n(23),a=n(20),s=n(1),l=n(40),u=n(3),c=n(6);s(s.S,"Reflect",{set:function e(t,n,s){var f,h,p=arguments.length<4?t:arguments[3],m=o.f(u(t),n);if(!m){if(c(h=i(t)))return e(h,n,s,p);m=l(0)}if(a(m,"value")){if(!1===m.writable||!c(p))return!1;if(f=o.f(p,n)){if(f.get||f.set||!1===f.writable)return!1;f.value=s,r.f(p,n,f)}else r.f(p,n,l(0,s));return!0}return void 0!==m.set&&(m.set.call(p,s),!0)}})},function(e,t,n){var r=n(1),o=n(83);o&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){o.check(e,t);try{return o.set(e,t),!0}catch(e){return!1}}})},function(e,t,n){"use strict";var r=n(1),o=n(63)(!0);r(r.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(38)("includes")},function(e,t,n){"use strict";var r=n(1),o=n(139),i=n(12),a=n(9),s=n(15),l=n(96);r(r.P,"Array",{flatMap:function(e){var t,n,r=i(this);return s(e),t=a(r.length),n=l(r,0),o(n,r,r,t,0,1,e,arguments[1]),n}}),n(38)("flatMap")},function(e,t,n){"use strict";var r=n(1),o=n(139),i=n(12),a=n(9),s=n(27),l=n(96);r(r.P,"Array",{flatten:function(){var e=arguments[0],t=i(this),n=a(t.length),r=l(t,0);return o(r,t,t,n,0,void 0===e?1:s(e)),r}}),n(38)("flatten")},function(e,t,n){"use strict";var r=n(1),o=n(66)(!0);r(r.P,"String",{at:function(e){return o(this,e)}})},function(e,t,n){"use strict";var r=n(1),o=n(140),i=n(71);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(i),"String",{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){"use strict";var r=n(1),o=n(140),i=n(71);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(i),"String",{padEnd:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){"use strict";n(52)("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},function(e,t,n){"use strict";n(52)("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},function(e,t,n){"use strict";var r=n(1),o=n(31),i=n(9),a=n(67),s=n(59),l=RegExp.prototype,u=function(e,t){this._r=e,this._s=t};n(90)(u,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),r(r.P,"String",{matchAll:function(e){if(o(this),!a(e))throw TypeError(e+" is not a regexp!");var t=String(this),n="flags"in l?String(e.flags):s.call(e),r=new RegExp(e.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=i(e.lastIndex),new u(r,t)}})},function(e,t,n){n(79)("asyncIterator")},function(e,t,n){n(79)("observable")},function(e,t,n){var r=n(1),o=n(138),i=n(21),a=n(22),s=n(94);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=i(e),l=a.f,u=o(r),c={},f=0;u.length>f;)void 0!==(n=l(r,t=u[f++]))&&s(c,t,n);return c}})},function(e,t,n){var r=n(1),o=n(141)(!1);r(r.S,"Object",{values:function(e){return o(e)}})},function(e,t,n){var r=n(1),o=n(141)(!0);r(r.S,"Object",{entries:function(e){return o(e)}})},function(e,t,n){"use strict";var r=n(1),o=n(12),i=n(15),a=n(11);n(10)&&r(r.P+n(74),"Object",{__defineGetter__:function(e,t){a.f(o(this),e,{get:i(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(1),o=n(12),i=n(15),a=n(11);n(10)&&r(r.P+n(74),"Object",{__defineSetter__:function(e,t){a.f(o(this),e,{set:i(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(1),o=n(12),i=n(30),a=n(23),s=n(22).f;n(10)&&r(r.P+n(74),"Object",{__lookupGetter__:function(e){var t,n=o(this),r=i(e,!0);do{if(t=s(n,r))return t.get}while(n=a(n))}})},function(e,t,n){"use strict";var r=n(1),o=n(12),i=n(30),a=n(23),s=n(22).f;n(10)&&r(r.P+n(74),"Object",{__lookupSetter__:function(e){var t,n=o(this),r=i(e,!0);do{if(t=s(n,r))return t.set}while(n=a(n))}})},function(e,t,n){var r=n(1);r(r.P+r.R,"Map",{toJSON:n(142)("Map")})},function(e,t,n){var r=n(1);r(r.P+r.R,"Set",{toJSON:n(142)("Set")})},function(e,t,n){n(75)("Map")},function(e,t,n){n(75)("Set")},function(e,t,n){n(75)("WeakMap")},function(e,t,n){n(75)("WeakSet")},function(e,t,n){n(76)("Map")},function(e,t,n){n(76)("Set")},function(e,t,n){n(76)("WeakMap")},function(e,t,n){n(76)("WeakSet")},function(e,t,n){var r=n(1);r(r.G,{global:n(4)})},function(e,t,n){var r=n(1);r(r.S,"System",{global:n(4)})},function(e,t,n){var r=n(1),o=n(26);r(r.S,"Error",{isError:function(e){return"Error"===o(e)}})},function(e,t,n){var r=n(1);r(r.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}})},function(e,t,n){var r=n(1);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(e,t,n){var r=n(1),o=180/Math.PI;r(r.S,"Math",{degrees:function(e){return e*o}})},function(e,t,n){var r=n(1),o=n(144),i=n(123);r(r.S,"Math",{fscale:function(e,t,n,r,a){return i(o(e,t,n,r,a))}})},function(e,t,n){var r=n(1);r(r.S,"Math",{iaddh:function(e,t,n,r){var o=e>>>0,i=n>>>0;return(t>>>0)+(r>>>0)+((o&i|(o|i)&~(o+i>>>0))>>>31)|0}})},function(e,t,n){var r=n(1);r(r.S,"Math",{isubh:function(e,t,n,r){var o=e>>>0,i=n>>>0;return(t>>>0)-(r>>>0)-((~o&i|~(o^i)&o-i>>>0)>>>31)|0}})},function(e,t,n){var r=n(1);r(r.S,"Math",{imulh:function(e,t){var n=+e,r=+t,o=65535&n,i=65535&r,a=n>>16,s=r>>16,l=(a*i>>>0)+(o*i>>>16);return a*s+(l>>16)+((o*s>>>0)+(65535&l)>>16)}})},function(e,t,n){var r=n(1);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(e,t,n){var r=n(1),o=Math.PI/180;r(r.S,"Math",{radians:function(e){return e*o}})},function(e,t,n){var r=n(1);r(r.S,"Math",{scale:n(144)})},function(e,t,n){var r=n(1);r(r.S,"Math",{umulh:function(e,t){var n=+e,r=+t,o=65535&n,i=65535&r,a=n>>>16,s=r>>>16,l=(a*i>>>0)+(o*i>>>16);return a*s+(l>>>16)+((o*s>>>0)+(65535&l)>>>16)}})},function(e,t,n){var r=n(1);r(r.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}})},function(e,t,n){"use strict";var r=n(1),o=n(24),i=n(4),a=n(60),s=n(131);r(r.P+r.R,"Promise",{finally:function(e){var t=a(this,o.Promise||i.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:e,n?function(n){return s(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){"use strict";var r=n(1),o=n(103),i=n(130);r(r.S,"Promise",{try:function(e){var t=o.f(this),n=i(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){var r=n(35),o=n(3),i=r.key,a=r.set;r.exp({defineMetadata:function(e,t,n,r){a(e,t,o(n),i(r))}})},function(e,t,n){var r=n(35),o=n(3),i=r.key,a=r.map,s=r.store;r.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:i(arguments[2]),r=a(o(t),n,!1);if(void 0===r||!r.delete(e))return!1;if(r.size)return!0;var l=s.get(t);return l.delete(n),!!l.size||s.delete(t)}})},function(e,t,n){var r=n(35),o=n(3),i=n(23),a=r.has,s=r.get,l=r.key;r.exp({getMetadata:function(e,t){return function e(t,n,r){if(a(t,n,r))return s(t,n,r);var o=i(n);return null!==o?e(t,o,r):void 0}(e,o(t),arguments.length<3?void 0:l(arguments[2]))}})},function(e,t,n){var r=n(134),o=n(143),i=n(35),a=n(3),s=n(23),l=i.keys,u=i.key;i.exp({getMetadataKeys:function(e){return function e(t,n){var i=l(t,n),a=s(t);if(null===a)return i;var u=e(a,n);return u.length?i.length?o(new r(i.concat(u))):u:i}(a(e),arguments.length<2?void 0:u(arguments[1]))}})},function(e,t,n){var r=n(35),o=n(3),i=r.get,a=r.key;r.exp({getOwnMetadata:function(e,t){return i(e,o(t),arguments.length<3?void 0:a(arguments[2]))}})},function(e,t,n){var r=n(35),o=n(3),i=r.keys,a=r.key;r.exp({getOwnMetadataKeys:function(e){return i(o(e),arguments.length<2?void 0:a(arguments[1]))}})},function(e,t,n){var r=n(35),o=n(3),i=n(23),a=r.has,s=r.key;r.exp({hasMetadata:function(e,t){return function e(t,n,r){if(a(t,n,r))return!0;var o=i(n);return null!==o&&e(t,o,r)}(e,o(t),arguments.length<3?void 0:s(arguments[2]))}})},function(e,t,n){var r=n(35),o=n(3),i=r.has,a=r.key;r.exp({hasOwnMetadata:function(e,t){return i(e,o(t),arguments.length<3?void 0:a(arguments[2]))}})},function(e,t,n){var r=n(35),o=n(3),i=n(15),a=r.key,s=r.set;r.exp({metadata:function(e,t){return function(n,r){s(e,t,(void 0!==r?o:i)(n),a(r))}}})},function(e,t,n){var r=n(1),o=n(102)(),i=n(4).process,a="process"==n(26)(i);r(r.G,{asap:function(e){var t=a&&i.domain;o(t?t.bind(e):e)}})},function(e,t,n){"use strict";var r=n(1),o=n(4),i=n(24),a=n(102)(),s=n(8)("observable"),l=n(15),u=n(3),c=n(47),f=n(49),h=n(16),p=n(48),m=p.RETURN,y=function(e){return null==e?void 0:l(e)},d=function(e){var t=e._c;t&&(e._c=void 0,t())},v=function(e){return void 0===e._o},b=function(e){v(e)||(e._o=void 0,d(e))},g=function(e,t){u(e),this._c=void 0,this._o=e,e=new $(this);try{var n=t(e),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:l(n),this._c=n)}catch(t){return void e.error(t)}v(this)&&d(this)};g.prototype=f({},{unsubscribe:function(){b(this)}});var $=function(e){this._s=e};$.prototype=f({},{next:function(e){var t=this._s;if(!v(t)){var n=t._o;try{var r=y(n.next);if(r)return r.call(n,e)}catch(e){try{b(t)}finally{throw e}}}},error:function(e){var t=this._s;if(v(t))throw e;var n=t._o;t._o=void 0;try{var r=y(n.error);if(!r)throw e;e=r.call(n,e)}catch(e){try{d(t)}finally{throw e}}return d(t),e},complete:function(e){var t=this._s;if(!v(t)){var n=t._o;t._o=void 0;try{var r=y(n.complete);e=r?r.call(n,e):void 0}catch(e){try{d(t)}finally{throw e}}return d(t),e}}});var _=function(e){c(this,_,"Observable","_f")._f=l(e)};f(_.prototype,{subscribe:function(e){return new g(e,this._f)},forEach:function(e){var t=this;return new(i.Promise||o.Promise)(function(n,r){l(e);var o=t.subscribe({next:function(t){try{return e(t)}catch(e){r(e),o.unsubscribe()}},error:r,complete:n})})}}),f(_,{from:function(e){var t="function"==typeof this?this:_,n=y(u(e)[s]);if(n){var r=u(n.call(e));return r.constructor===t?r:new t(function(e){return r.subscribe(e)})}return new t(function(t){var n=!1;return a(function(){if(!n){try{if(p(e,!1,function(e){if(t.next(e),n)return m})===m)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}}),function(){n=!0}})},of:function(){for(var e=0,t=arguments.length,n=new Array(t);e<t;)n[e]=arguments[e++];return new("function"==typeof this?this:_)(function(e){var t=!1;return a(function(){if(!t){for(var r=0;r<n.length;++r)if(e.next(n[r]),t)return;e.complete()}}),function(){t=!0}})}}),h(_.prototype,s,function(){return this}),r(r.G,{Observable:_}),n(46)("Observable")},function(e,t,n){var r=n(4),o=n(1),i=n(71),a=[].slice,s=/MSIE .\./.test(i),l=function(e){return function(t,n){var r=arguments.length>2,o=!!r&&a.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,o)}:t,n)}};o(o.G+o.B+o.F*s,{setTimeout:l(r.setTimeout),setInterval:l(r.setInterval)})},function(e,t,n){var r=n(1),o=n(101);r(r.G+r.B,{setImmediate:o.set,clearImmediate:o.clear})},function(e,t,n){for(var r=n(98),o=n(42),i=n(17),a=n(4),s=n(16),l=n(53),u=n(8),c=u("iterator"),f=u("toStringTag"),h=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},m=o(p),y=0;y<m.length;y++){var d,v=m[y],b=p[v],g=a[v],$=g&&g.prototype;if($&&($[c]||s($,c,h),$[f]||s($,f,v),l[v]=h,b))for(d in r)$[d]||i($,d,r[d],!0)}},function(e,t,n){(function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){"use strict";var r,o=Object.prototype,i=o.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag",c="object"===n(t),f=e.regeneratorRuntime;if(f)c&&(t.exports=f);else{(f=e.regeneratorRuntime=c?t.exports:{}).wrap=_;var h="suspendedStart",p="suspendedYield",m="executing",y="completed",d={},v={};v[s]=function(){return this};var b=Object.getPrototypeOf,g=b&&b(b(A([])));g&&g!==o&&i.call(g,s)&&(v=g);var $=T.prototype=w.prototype=Object.create(v);E.prototype=$.constructor=T,T.constructor=E,T[u]=E.displayName="GeneratorFunction",f.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===E||"GeneratorFunction"===(t.displayName||t.name))},f.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,T):(e.__proto__=T,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create($),e},f.awrap=function(e){return{__await:e}},O(R.prototype),R.prototype[l]=function(){return this},f.AsyncIterator=R,f.async=function(e,t,n,r){var o=new R(_(e,t,n,r));return f.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},O($),$[u]="Generator",$[s]=function(){return this},$.toString=function(){return"[object Generator]"},f.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},f.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,o){return s.type="throw",s.arg=e,t.next=n,o&&(t.method="next",t.arg=r),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),d}}}function _(e,t,n,r){var o=t&&t.prototype instanceof w?t:w,i=Object.create(o.prototype),a=new C(r||[]);return i._invoke=function(e,t,n){var r=h;return function(o,i){if(r===m)throw new Error("Generator is already running");if(r===y){if("throw"===o)throw i;return M()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=k(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=m;var l=S(e,t,n);if("normal"===l.type){if(r=n.done?y:p,l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=y,n.method="throw",n.arg=l.arg)}}}(e,n,a),i}function S(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function w(){}function E(){}function T(){}function O(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function R(t){function r(e,o,a,s){var l=S(t[e],t,o);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"===n(c)&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(e){r("next",e,a,s)},function(e){r("throw",e,a,s)}):Promise.resolve(c).then(function(e){u.value=e,a(u)},s)}s(l.arg)}var o;"object"===n(e.process)&&e.process.domain&&(r=e.process.domain.bind(r)),this._invoke=function(e,t){function n(){return new Promise(function(n,o){r(e,t,n,o)})}return o=o?o.then(n,n):n()}}function k(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,k(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var o=S(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function A(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return o.next=o}}return{next:M}}function M(){return{value:r,done:!0}}}("object"===(void 0===e?"undefined":n(e))?e:"object"===("undefined"==typeof window?"undefined":n(window))?window:"object"===("undefined"==typeof self?"undefined":n(self))?self:this)}).call(this,n(108),n(148)(e))},function(e,t,n){n(352),e.exports=n(24).RegExp.escape},function(e,t,n){var r=n(1),o=n(353)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(e){return o(e)}})},function(e,t){e.exports=function(e,t){var n=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,n)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return b});var r=n(7),o=n(2),i=n(107),a=n(151),s=n(0),l=n(150),u=n(149);function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){p(e,t,n[t])})}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}var v=function(){function e(t,n,r){m(this,e),this.rowIndex=t,this.colIndex=n,this.sprites=r}return d(e,[{key:"getSprites",value:function(){return this.sprites}},{key:"getSpritesAsSet",value:function(){return new Set(this.sprites)}},{key:"getWantsToMove",value:function(){return s.d.STATIONARY}}]),e}(),b=function(){function e(t,n,r){var o=this;m(this,e),this.worker=t,this.table=n;r&&r.onMessage||(r=h({},r,{onMessage:function(e){return Object(s.j)(10,function(){return!o.inputWatcher.isSomethingPressed()&&(alert(e),!0)})}})),this.cellCache=[],this.levelNum=-123456,this.gameData=null,this.ui=new a.a(n,r),this.resizeWatcher=new u.a(n,this.handleResize.bind(this)),this.inputWatcher=new l.a(n),this.boundPause=this.pause.bind(this),this.boundResume=this.resume.bind(this),this.boundMessageListener=this.messageListener.bind(this),n.addEventListener("blur",this.boundPause),n.addEventListener("focus",this.boundResume),t.addEventListener("message",this.boundMessageListener),this.inputInterval=window.setInterval(function(){var e=o.inputWatcher.pollControls();e&&o.press(e)},10)}return d(e,[{key:"setGame",value:function(e,t){this.worker.postMessage({type:s.c.ON_GAME_CHANGE,code:e,level:t})}},{key:"dispose",value:function(){this.inputWatcher.dispose(),this.resizeWatcher.dispose(),clearInterval(this.inputInterval)}},{key:"press",value:function(e){this.worker.postMessage({type:s.c.PRESS,button:e})}},{key:"pause",value:function(){this.worker.postMessage({type:s.c.PAUSE})}},{key:"resume",value:function(){this.worker.postMessage({type:s.c.RESUME})}},{key:"messageListener",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var n,r,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.data,e.t0=n.type,e.next=e.t0===s.c.ON_GAME_CHANGE?4:e.t0===s.c.ON_LEVEL_CHANGE?8:e.t0===s.c.ON_MESSAGE?14:e.t0===s.c.ON_PRESS?19:e.t0===s.c.ON_TICK?21:e.t0===s.c.ON_SOUND?23:e.t0===s.c.ON_PAUSE?26:e.t0===s.c.ON_RESUME?28:e.t0===s.c.TICK?30:e.t0===s.c.PRESS?30:e.t0===s.c.PAUSE?30:e.t0===s.c.RESUME?30:31;break;case 4:return r=i.a.fromJson(n.payload,"**source not included because of laziness**"),this.gameData=r,this.ui.onGameChange(r),e.abrupt("break",32);case 8:return this.cellCache=[],this.levelNum=n.level,n.cells?this.ui.onLevelChange(n.level,n.cells.map(function(e){return e.map(function(e){return o.convertToCellish(e)})}),null):this.ui.onLevelChange(n.level,null,n.message),this.resizeWatcher.trigger(),this.table.focus(),e.abrupt("break",32);case 14:return e.next=16,this.ui.onMessage(n.message);case 16:return this.worker.postMessage({type:s.c.ON_MESSAGE_DONE}),this.table.focus(),e.abrupt("break",32);case 19:return this.ui.onPress(n.direction),e.abrupt("break",32);case 21:return this.ui.onTick(new Set(n.changedCells.map(function(e){return o.convertToCellish(e)})),n.hasAgain,this.convertToA11yMessages(n.a11yMessages)),e.abrupt("break",32);case 23:return e.next=25,this.ui.onSound({soundCode:n.soundCode});case 25:return e.abrupt("break",32);case 26:return this.ui.onPause(),e.abrupt("break",32);case 28:return this.ui.onResume(),e.abrupt("break",32);case 30:return e.abrupt("break",32);case 31:console.log('BUG: Unhandled Event occurred. Ignoring "'.concat(n.type,'"'),n);case 32:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"convertToA11yMessages",value:function(e){var t=this;return e.map(function(e){switch(e.type){case r.a.ADD:return h({},e,{cell:t.convertToCellish(e.cell),sprites:c(e.sprites).map(function(e){return t.lookupSprite(e)})});case r.a.MOVE:return h({},e,{oldCell:t.convertToCellish(e.oldCell),newCell:t.convertToCellish(e.newCell),sprite:t.lookupSprite(e.sprite)});case r.a.REMOVE:return h({},e,{cell:t.convertToCellish(e.cell),sprites:c(e.sprites).map(function(e){return t.lookupSprite(e)})});case r.a.REPLACE:return h({},e,{cell:t.convertToCellish(e.cell),replacements:c(e.replacements).map(function(e){var n=e.oldSprite,r=e.newSprite;return{oldSprite:t.lookupSprite(n),newSprite:t.lookupSprite(r)}})})}})}},{key:"lookupSprite",value:function(e){var t=this.getGameData()._getSpriteByName(e);if(!t)throw new Error('Could not find sprite "'.concat(e,'"'));return t}},{key:"convertToCellish",value:function(e){var t=this,n=e.rowIndex,r=e.colIndex,o=e.spriteNames;this.cellCache[n]||(this.cellCache[n]=[]),this.cellCache[n][r]||(this.cellCache[n][r]=new v(n,r,[]));var i=this.cellCache[n][r];return i.sprites=o.map(function(e){return t.lookupSprite(e)}),i}},{key:"getGameData",value:function(){if(!this.gameData)throw new Error("BUG: Game Data has not been retreived from the worker yet");return this.gameData}},{key:"isCurrentLevelAMessage",value:function(){return this.getGameData().levels[this.levelNum].type===o.d.MESSAGE}},{key:"handleResize",value:function(e){this.isCurrentLevelAMessage()||this.table.setAttribute("style","width: ".concat(e,"px;"))}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return S});var r=n(356),o=n(19),i=n(7),a=n(2),s=n(39),l=n(0);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}var g=function(){function e(t,n,r,o){d(this,e),this.level=t,this.rowIndex=r,this.colIndex=o,this.state=new Map,this.cacheCollisionLayers=[],this.spriteBitSet=new s.a(n),this.cachedKeyValue=null;var i=!0,a=!1,u=void 0;try{for(var c,f=n[Symbol.iterator]();!(i=(c=f.next()).done);i=!0){var h=c.value;this._setWantsToMove(h,l.d.STATIONARY)}}catch(e){a=!0,u=e}finally{try{i||null==f.return||f.return()}finally{if(a)throw u}}}return b(e,[{key:"_setWantsToMove",value:function(e,t){var n=e.getCollisionLayer(),r=this.getStateForCollisionLayer(n),o=r.wantsToMove,i=r.sprite,a=o!==t,s=i!==e;if(i!==e){if(i)throw new Error("BUG: Should have already been removed?");this.spriteBitSet.add(e)}return this._setState(n,e,t),i!==e&&this.replaceSpriteInLevel(i,e),s||a}},{key:"_deleteWantsToMove",value:function(e){var t=e.getCollisionLayer(),n=this.getSpriteByCollisionLayer(t),r=!!n;return n&&this.spriteBitSet.remove(n),this._setState(t,null,null),r}},{key:"setWantsToMoveCollisionLayer",value:function(e,t){var n=this.getStateForCollisionLayer(e),r=n.sprite,o=n.wantsToMove;if(!r)throw new Error("BUG: No sprite for collision layer. Cannot set direction.\n".concat(e.toString()));var i=o!==t;return this._setState(e,r,t),r.updateCell(this,t),i}},{key:"getSpriteByCollisionLayer",value:function(e){return this.getStateForCollisionLayer(e).sprite||null}},{key:"getCollisionLayers",value:function(){return this.cacheCollisionLayers}},{key:"getSprites",value:function(){var e=[],t=this.getCollisionLayers(),n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l=this.getSpriteByCollisionLayer(s);l&&e.push(l)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return e.reverse()}},{key:"getSpritesAsSet",value:function(){var e=new Set,t=!0,n=!1,r=void 0;try{for(var o,i=this.state.values()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value.sprite;e.add(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"getSpriteAndWantsToMoves",value:function(){var e=new Map,t=!0,n=!1,r=void 0;try{for(var o,i=this.getCollisionLayers()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=this.getStateForCollisionLayer(a),l=s.sprite,u=s.wantsToMove;e.set(l,u)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"getCollisionLayerWantsToMove",value:function(e){return this.getStateForCollisionLayer(e).wantsToMove||null}},{key:"hasSprite",value:function(e){var t=this.getSpriteByCollisionLayer(e.getCollisionLayer());return e===t}},{key:"getNeighbor",value:function(e){switch(e){case l.d.UP:return this.getRelativeNeighbor(-1,0);case l.d.DOWN:return this.getRelativeNeighbor(1,0);case l.d.LEFT:return this.getRelativeNeighbor(0,-1);case l.d.RIGHT:return this.getRelativeNeighbor(0,1);default:throw new Error('BUG: Unsupported direction "'.concat(e,'"'))}}},{key:"getWantsToMove",value:function(e){return this.getCollisionLayerWantsToMove(e.getCollisionLayer())}},{key:"hasCollisionWithSprite",value:function(e){return!!this.getCollisionLayerWantsToMove(e.getCollisionLayer())}},{key:"clearWantsToMove",value:function(e){this._setWantsToMove(e,l.d.STATIONARY),e.updateCell(this,l.d.STATIONARY)}},{key:"addSprite",value:function(e,t){var n=!1,r=this.getSpriteByCollisionLayer(e.getCollisionLayer()),o=this.getCollisionLayerWantsToMove(e.getCollisionLayer());return r&&r!==e&&this.removeSprite(r),t?n=this._setWantsToMove(e,t):this.hasSprite(e)||(t=o||l.d.STATIONARY,n=this._setWantsToMove(e,t)),e.addCell(this,t),n}},{key:"updateSprite",value:function(e,t){var n=!1;if(this.getSpriteByCollisionLayer(e.getCollisionLayer())!==e)throw new Error("BUG: Should not be trying to update the direction of a sprite that is not in the cell");if(t)n=this._setWantsToMove(e,t);else if(!this.hasSprite(e))throw new Error("BUG: sprite should already be in the cell since we are updating it");return e.updateCell(this,t),n}},{key:"removeSprite",value:function(e){var t=this._deleteWantsToMove(e);return e.removeCell(this),t}},{key:"toString",value:function(){return"Cell [".concat(this.rowIndex,"][").concat(this.colIndex,"] ").concat(y(this.getSpriteAndWantsToMoves().entries()).map(function(e){var t=m(e,2),n=t[0],r=t[1];return"".concat(r," ").concat(n.getName())}).join(" "))}},{key:"toKey",value:function(){return this.cachedKeyValue||(this.cachedKeyValue=y(this.state.values()).map(function(e){var t=e.sprite,n=e.wantsToMove;return"".concat(n," ").concat(t.getName())}).join(" ")),this.cachedKeyValue}},{key:"toSnapshot",value:function(){return this.getSpritesAsSet()}},{key:"fromSnapshot",value:function(e){var t=this.getSpritesAsSet(),n=Object(l.m)(t,e),r=Object(l.m)(e,t);this.removeSprites(n),this.addSprites(r)}},{key:"replaceSpriteInLevel",value:function(e,t){this.getLevel().replaceSprite(this,e,t)}},{key:"_setState",value:function(e,t,n){var r;t?(r=this.cacheCollisionLayers.indexOf(e)<0,this.state.set(e,{wantsToMove:n,sprite:t})):(this.state.delete(e),r=!0),r&&(this.cacheCollisionLayers=y(this.state.keys()).sort(function(e,t){return e.id-t.id})),this.invalidateKey()}},{key:"getLevel",value:function(){if(!this.level)throw new Error("BUG: we need an engine Level in order to find neighbors. It is optional for letters in messages");return this.level}},{key:"getStateForCollisionLayer",value:function(e){var t=this.state.get(e);return t||{wantsToMove:null,sprite:null}}},{key:"getRelativeNeighbor",value:function(e,t){return this.getLevel().getCellOrNull(this.rowIndex+e,this.colIndex+t)}},{key:"removeSprites",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.removeSprite(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"addSprites",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this.addSprite(a,null)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"invalidateKey",value:function(){this.cachedKeyValue=null}}]),e}(),$=function(){function e(){d(this,e),this.rowCache=[],this.colCache=[],this.cells=null}return b(e,[{key:"setCells",value:function(e){this.cells=e}},{key:"getCells",value:function(){if(!this.cells)throw new Error("BUG: Should have called setCells() first");return this.cells}},{key:"getCellOrNull",value:function(e,t){var n=this.getCells()[e];return n?n[t]:null}},{key:"getCell",value:function(e,t){return this.getCells()[e][t]}},{key:"replaceSprite",value:function(e,t,n){this.cells&&(this.rowCache[e.rowIndex]=null,this.colCache[e.colIndex]=null)}},{key:"rowContainsSprites",value:function(e,t,n){var r=this.rowCache[e];return r||(r=this.computeRowCache(e),this.rowCache[e]=r),!(!r.containsAll(t)||!n.isEmpty())||r.containsAny(n)}},{key:"colContainsSprites",value:function(e,t,n){var r=this.colCache[e];return r||(r=this.computeColCache(e),this.colCache[e]=r),!(!r.containsAll(t)||!n.isEmpty())||r.containsAny(n)}},{key:"computeRowCache",value:function(e){for(var t=this.getCells()[0].length,n=[],r=0;r<t;r++)n.push(this.getCell(e,r).spriteBitSet);return(new s.a).union(n)}},{key:"computeColCache",value:function(e){for(var t=this.getCells().length,n=[],r=0;r<t;r++)n.push(this.getCell(r,e).spriteBitSet);return(new s.a).union(n)}}]),e}(),_=function(e){function t(e){var n;return d(this,t),(n=f(this,h(t).call(this))).gameData=e,n.hasAgainThatNeedsToRun=!1,n.undoStack=[],n.pendingPlayerWantsToMove=null,n.currentLevel=null,n.tempOldLevel=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,r["EventEmitter2"]),b(t,[{key:"setLevel",value:function(e){var t=this;this.undoStack=[],this.gameData.clearCaches();var n=this.gameData.levels[e];if(!n)throw new Error("Invalid levelNum: ".concat(e));if(n.type===a.d.MAP){Object(l.k)();var r=n.cells.map(function(e){return e.map(function(e){var n=new Set(e.getSprites()),r=t.gameData.getMagicBackgroundSprite();return r&&n.add(r),n})});if(this._setLevel(r),this.gameData.metadata.runRulesOnLevelStart){var o=this.tick(),i=o.messageToShow,s=o.isWinning,u=o.hasRestart;(i||s||u)&&console.log('Error: Game should not cause a sound/message/win/restart during the initial tick. "'.concat(i,'" "').concat(s,'" "').concat(u,'"'))}return this.takeSnapshot(this.createSnapshot()),this.getCells()}throw new Error("BUG: LEVEL_MESSAGE should not reach this point")}},{key:"setMessageLevel",value:function(e){this.tempOldLevel=this.currentLevel,this._setLevel(e)}},{key:"restoreFromMessageLevel",value:function(){this.currentLevel=this.tempOldLevel,this.tempOldLevel=null}},{key:"getCurrentLevel",value:function(){if(this.currentLevel)return this.currentLevel;throw new Error("BUG: There is no current level. Maybe it is a message level or maybe setLevel was never called")}},{key:"toSnapshot",value:function(){return this.getCurrentLevel().getCells().map(function(e){return e.map(function(e){var t=[];return e.getSpriteAndWantsToMoves().forEach(function(e,n){t.push("".concat(e," ").concat(n.getName()))}),t})})}},{key:"tick",value:function(){switch(o.b.debug(function(){return""}),this.hasAgainThatNeedsToRun&&(this.hasAgainThatNeedsToRun=!1),this.pendingPlayerWantsToMove){case l.b.UNDO:return this.doUndo(),this.pendingPlayerWantsToMove=null,{changedCells:new Set(this.getCells()),soundToPlay:null,messageToShow:null,hasRestart:!1,isWinning:!1,mutations:[],a11yMessages:[]};case l.b.RESTART:return this.doRestart(),this.pendingPlayerWantsToMove=null,{changedCells:new Set(this.getCells()),soundToPlay:null,messageToShow:null,hasRestart:!0,isWinning:!1,mutations:[],a11yMessages:[]}}var e=this.tickNormal(),t=null,n=null,r=!1,i=!1,s=!0,u=!1,c=void 0;try{for(var f,h=e.commands[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value;switch(p.type){case a.c.RESTART:i=!0;break;case a.c.SFX:t=p.sound;break;case a.c.MESSAGE:this.hasAgainThatNeedsToRun=!1,n=p.message;break;case a.c.WIN:r=!0;break;case a.c.AGAIN:case a.c.CANCEL:case a.c.CHECKPOINT:break;default:throw new Error('BUG: Unsupported command "'.concat(p,'"'))}}}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}return o.b.debug(function(){return"checking win condition."}),this.hasAgainThatNeedsToRun&&o.b.debug(function(){return"AGAIN command executed, with changes detected - will execute another turn."}),{changedCells:new Set(e.changedCells.keys()),soundToPlay:t,messageToShow:n,hasRestart:i,isWinning:r||this.isWinning(),mutations:e.mutations,a11yMessages:e.a11yMessages}}},{key:"hasAgain",value:function(){return this.hasAgainThatNeedsToRun}},{key:"canUndo",value:function(){return this.undoStack.length>1}},{key:"press",value:function(e){return this.pressDir(e)}},{key:"tickUpdateCells",value:function(){return o.b.debug(function(){return"applying rules"}),this._tickUpdateCells(this.gameData.rules.filter(function(e){return!e.isLate()}))}},{key:"tickMoveSprites",value:function(e){var t,n=new Set,r=[];do{t=!1;var o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var f=u.value,h=!0,p=!1,y=void 0;try{for(var d,v=f.getSpriteAndWantsToMoves()[Symbol.iterator]();!(h=(d=v.next()).done);h=!0){var b=m(d.value,2),g=b[0],$=b[1];switch($){case l.d.STATIONARY:break;case l.d.ACTION:t=!0,f.clearWantsToMove(g);break;case l.d.UP:case l.d.DOWN:case l.d.LEFT:case l.d.RIGHT:var _=f.getNeighbor($);_&&!_.hasCollisionWithSprite(g)&&(f.removeSprite(g),_.addSprite(g,l.d.STATIONARY),n.add(_),n.add(f),t=!0,r.push({type:i.a.MOVE,oldCell:f,newCell:_,sprite:g,direction:$}));break;default:throw new Error("BUG: wantsToMove should have been handled earlier: ".concat($))}}}catch(e){p=!0,y=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw y}}}}catch(e){a=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}}while(t);var S=!0,w=!1,E=void 0;try{for(var T,O=e[Symbol.iterator]();!(S=(T=O.next()).done);S=!0){var R=T.value,k=!0,L=!1,x=void 0;try{for(var C,A=R.getSpriteAndWantsToMoves()[Symbol.iterator]();!(k=(C=A.next()).done);k=!0){var M=m(C.value,1)[0];R.clearWantsToMove(M)}}catch(e){L=!0,x=e}finally{try{k||null==A.return||A.return()}finally{if(L)throw x}}}}catch(e){w=!0,E=e}finally{try{S||null==O.return||O.return()}finally{if(w)throw E}}return{movedCells:n,a11yMessages:r}}},{key:"pressDir",value:function(e){this.pendingPlayerWantsToMove=e}},{key:"doRestart",value:function(){var e=this.undoStack[0];this.undoStack.push(e),this.applySnapshot(e)}},{key:"doUndo",value:function(){var e=this.undoStack.pop();e&&this.undoStack.length>0?this.applySnapshot(e):e&&this.undoStack.push(e)}},{key:"_setLevel",value:function(e){var t=this,n=new $;this.currentLevel=n;var r=e.map(function(e,r){return e.map(function(e,o){var i=t.gameData.getMagicBackgroundSprite();return i&&e.add(i),new g(n,e,r,o)})});n.setCells(r);var o=new Map;function i(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=y(e).map(function(e){return e.getName()}).sort()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;t.push(s)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t.join(" ")}var a=this.getCells(),s=!0,u=!1,c=void 0;try{for(var f,h=this.gameData.rules[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){f.value.addCellsToEmptyRules(a)}}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}var p=!0,d=!1,v=void 0;try{for(var b,_=a[Symbol.iterator]();!(p=(b=_.next()).done);p=!0){var S=b.value,w=i(S.getSpritesAsSet()),E=o.get(w);E||(E=[],o.set(w,E)),E.push(S)}}catch(e){d=!0,v=e}finally{try{p||null==_.return||_.return()}finally{if(d)throw v}}var T=0,O=!0,R=!1,k=void 0;try{for(var L,x=o[Symbol.iterator]();!(O=(L=x.next()).done);O=!0){var C=m(L.value,2),A=C[0],M=C[1];(o.size>100&&T%10==0||M.length>100)&&this.emit("loading-cells",{cellStart:T,cellEnd:T+M.length,cellTotal:a.length,key:A});var I=!0,N=!1,P=void 0;try{for(var D,G=this.gameData.objects[Symbol.iterator]();!(I=(D=G.next()).done);I=!0){var B=D.value,F=M[0].getSpritesAsSet().has(B);(F||B.hasNegationTileWithModifier())&&(F?B.addCells(B,M,l.d.STATIONARY):B.removeCells(B,M))}}catch(e){N=!0,P=e}finally{try{I||null==G.return||G.return()}finally{if(N)throw P}}T+=M.length}}catch(e){R=!0,k=e}finally{try{O||null==x.return||x.return()}finally{if(R)throw k}}return n}},{key:"getCells",value:function(){return Object(l.g)(this.getCurrentLevel().getCells())}},{key:"tickUpdateCellsLate",value:function(){return o.b.debug(function(){return"applying late rules"}),this._tickUpdateCells(this.gameData.rules.filter(function(e){return e.isLate()}))}},{key:"_tickUpdateCells",value:function(e){var t=new Set,n=[],r=[];if(!this.currentLevel)throw new Error("BUG: Level Cells do not exist yet");var o=!0,i=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value,c=u.evaluate(this.currentLevel,!1);c.length>0&&r.push(u);var f=!0,h=!1,p=void 0;try{for(var m,y=c[Symbol.iterator]();!(f=(m=y.next()).done);f=!0){var d=m.value;t.add(d);var v=!0,b=!1,g=void 0;try{for(var $,_=d.messages[Symbol.iterator]();!(v=($=_.next()).done);v=!0){var S=$.value;n.push(S)}}catch(e){b=!0,g=e}finally{try{v||null==_.return||_.return()}finally{if(b)throw g}}}}catch(e){h=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(h)throw p}}}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}var w=new Set,E=new Set,T=!0,O=!1,R=void 0;try{for(var k,L=t[Symbol.iterator]();!(T=(k=L.next()).done);T=!0){var x=k.value;x.hasCell()?w.add(x.getCell()):E.add(x.getCommand())}}catch(e){O=!0,R=e}finally{try{T||null==L.return||L.return()}finally{if(O)throw R}}return{evaluatedRules:r,changedCells:w,commands:E,mutations:t,a11yMessages:n}}},{key:"tickNormal",value:function(){var e=new Set,t=this.createSnapshot();if(this.pendingPlayerWantsToMove){this.takeSnapshot(t),o.b.debug("=======================\nTurn starts with input of ".concat(this.pendingPlayerWantsToMove.toLowerCase(),"."));var n=this.gameData.getPlayer(),r=!0,i=!1,s=void 0;try{for(var u,c=n.getCellsThatMatch(Object(l.g)(this.getCurrentLevel().getCells()))[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var f=u.value,h=!0,p=!1,m=void 0;try{for(var d,v=n.getSpritesThatMatch(f)[Symbol.iterator]();!(h=(d=v.next()).done);h=!0){var b=d.value;f.updateSprite(b,w(this.pendingPlayerWantsToMove)),e.add(f)}}catch(e){p=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw m}}}}catch(e){i=!0,s=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw s}}this.pendingPlayerWantsToMove=null}else o.b.debug(function(){return"Turn starts with no input."});var g=this.tickUpdateCells(),$=g.changedCells,_=g.evaluatedRules,S=g.commands,E=g.mutations,T=g.a11yMessages;e=Object(l.l)(e,$);var O=this.tickMoveSprites(new Set(e.keys())),R=O.movedCells,k=O.a11yMessages,L=this.tickUpdateCellsLate(),x=L.changedCells,C=L.evaluatedRules,A=L.commands,M=L.mutations,I=L.a11yMessages,N=[].concat(y(S),y(A));if(!!N.filter(function(e){return e.type===a.c.CANCEL})[0])return this.hasAgainThatNeedsToRun=!1,this.undoStack.length>0&&this.applySnapshot(this.undoStack[this.undoStack.length-1]),{changedCells:new Set,commands:new Set,evaluatedRules:_,mutations:new Set,a11yMessages:[]};!!N.find(function(e){return e.type===a.c.CHECKPOINT})&&(this.undoStack=[],this.takeSnapshot(this.createSnapshot()));var P=Object(l.l)(Object(l.l)(e,x),R);return N.find(function(e){return e.type===a.c.AGAIN})&&(this.hasAgainThatNeedsToRun=this.doSnapshotsDiffer(t,this.createSnapshot())),{changedCells:P,evaluatedRules:_.concat(C),commands:N,mutations:new Set([].concat(y(E),y(M))),a11yMessages:[].concat(y(T),y(k),y(I))}}},{key:"isWinning",value:function(){var e=this,t=this.gameData.winConditions.length>0;return this.gameData.winConditions.forEach(function(n){n.isSatisfied(e.getCells())||(t=!1)}),t}},{key:"createSnapshot",value:function(){return this.getCurrentLevel().getCells().map(function(e){return e.map(function(e){return e.toSnapshot()})})}},{key:"takeSnapshot",value:function(e){this.undoStack.push(e)}},{key:"applySnapshot",value:function(e){for(var t=this.getCurrentLevel().getCells(),n=0;n<t.length;n++)for(var r=t[n],o=e[n],i=0;i<r.length;i++){var a=r[i],s=o[i];a.fromSnapshot(s)}}},{key:"doSnapshotsDiffer",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++){var o=e[n][r],i=t[n][r];if(!Object(l.n)(o,i))return!0}return!1}}]),t}(),S=function(){function e(t,n){d(this,e),this.currentLevelNum=-1234567,this.handler=n,this.levelEngine=new _(t)}return b(e,[{key:"on",value:function(e,t){this.levelEngine.on(e,t)}},{key:"getGameData",value:function(){return this.levelEngine.gameData}},{key:"getCurrentLevelCells",value:function(){return this.levelEngine.getCurrentLevel().getCells()}},{key:"getCurrentLevel",value:function(){return this.getGameData().levels[this.getCurrentLevelNum()]}},{key:"getCurrentLevelNum",value:function(){return this.currentLevelNum}},{key:"hasAgain",value:function(){return this.levelEngine.hasAgain()}},{key:"setLevel",value:function(e){this.levelEngine.hasAgainThatNeedsToRun=!1,this.currentLevelNum=e;var t=this.getGameData().levels[e];t.type===a.d.MAP?(this.levelEngine.setLevel(e),this.handler.onLevelChange(this.currentLevelNum,this.levelEngine.getCurrentLevel().getCells(),null)):this.handler.onLevelChange(this.currentLevelNum,null,t.message)}},{key:"tick",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(){var t,n,r,o,i,s,l,u,c,f,h,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.getCurrentLevel()).type!==a.d.MESSAGE){e.next=8;break}return e.next=4,this.handler.onMessage(t.message);case 4:return n=!1,this.currentLevelNum===this.levelEngine.gameData.levels.length-1?(this.handler.onWin(),n=!0):this.setLevel(this.currentLevelNum+1),this.levelEngine.pendingPlayerWantsToMove=null,e.abrupt("return",{changedCells:new Set,didWinGame:n,didLevelChange:!0,wasAgainTick:!1});case 8:if((r=this.levelEngine.hasAgain())||this.levelEngine.gameData.metadata.realtimeInterval||this.levelEngine.pendingPlayerWantsToMove){e.next=11;break}return e.abrupt("return",{changedCells:new Set,didWinGame:!1,didLevelChange:!1,wasAgainTick:!1});case 11:if(o=this.levelEngine.pendingPlayerWantsToMove,i=this.levelEngine.tick(),s=i.changedCells,l=i.soundToPlay,u=i.messageToShow,c=i.isWinning,f=i.hasRestart,h=i.a11yMessages,o&&!this.levelEngine.pendingPlayerWantsToMove&&this.handler.onPress(o),!f){e.next=17;break}return this.handler.onTick(s,r,h),e.abrupt("return",{changedCells:s,didWinGame:!1,didLevelChange:!1,wasAgainTick:!1});case 17:if(r=this.levelEngine.hasAgain(),this.handler.onTick(s,r,h),p=!1,c&&(this.currentLevelNum===this.levelEngine.gameData.levels.length-1?(p=!0,this.handler.onWin()):this.setLevel(this.currentLevelNum+1)),!l){e.next=24;break}return e.next=24,this.handler.onSound(l);case 24:if(!u){e.next=27;break}return e.next=27,this.handler.onMessage(u);case 27:return e.abrupt("return",{changedCells:s,didWinGame:p,didLevelChange:c,wasAgainTick:r});case 28:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"press",value:function(e){this.levelEngine.press(e)}},{key:"saveSnapshotToJSON",value:function(){return this.getCurrentLevelCells().map(function(e){return e.map(function(e){return y(e.toSnapshot()).map(function(e){return e.getName()})})})}},{key:"loadSnapshotFromJSON",value:function(e){var t=this;e.forEach(function(e,n){e.forEach(function(e,r){var o=t.levelEngine.getCurrentLevel().getCell(n,r),i=e.map(function(e){var n=t.getGameData()._getSpriteByName(e);if(n)return n;throw new Error("BUG: Could not find sprite to add named ".concat(e))});o.fromSnapshot(new Set(i))})})}},{key:"isCurrentLevelAMessage",value:function(){return this.getCurrentLevel().type===a.d.MESSAGE}}]),e}();function w(e){switch(e){case l.b.UP:return l.d.UP;case l.b.DOWN:return l.d.DOWN;case l.b.LEFT:return l.d.LEFT;case l.b.RIGHT:return l.d.RIGHT;case l.b.ACTION:return l.d.ACTION;default:throw new Error('BUG: Invalid input button at this point. Only up/down/left/right/action are allowed. "'.concat(e,'"'))}}},function(e,t,n){(function(r){var o;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */!function(a){var s=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},l=10;function u(){this._events={},this._conf&&c.call(this,this._conf)}function c(e){e?(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),this._maxListeners=e.maxListeners!==a?e.maxListeners:l,e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),this.wildcard&&(this.listenerTree={})):this._maxListeners=l}function f(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),void 0!==r&&r.emitWarning){var o=new Error(n);o.name="MaxListenersExceededWarning",o.emitter=this,o.count=e,r.emitWarning(o)}else console.error(n),console.trace&&console.trace()}function h(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,c.call(this,e)}function p(e,t,n,r){if(!n)return[];var o,i,a,s,l,u,c,f=[],h=t.length,m=t[r],y=t[r+1];if(r===h&&n._listeners){if("function"==typeof n._listeners)return e&&e.push(n._listeners),[n];for(o=0,i=n._listeners.length;o<i;o++)e&&e.push(n._listeners[o]);return[n]}if("*"===m||"**"===m||n[m]){if("*"===m){for(a in n)"_listeners"!==a&&n.hasOwnProperty(a)&&(f=f.concat(p(e,t,n[a],r+1)));return f}if("**"===m){for(a in(c=r+1===h||r+2===h&&"*"===y)&&n._listeners&&(f=f.concat(p(e,t,n,h))),n)"_listeners"!==a&&n.hasOwnProperty(a)&&("*"===a||"**"===a?(n[a]._listeners&&!c&&(f=f.concat(p(e,t,n[a],h))),f=f.concat(p(e,t,n[a],r))):f=a===y?f.concat(p(e,t,n[a],r+2)):f.concat(p(e,t,n[a],r)));return f}f=f.concat(p(e,t,n[m],r+1))}if((s=n["*"])&&p(e,t,s,r+1),l=n["**"])if(r<h)for(a in l._listeners&&p(e,t,l,h),l)"_listeners"!==a&&l.hasOwnProperty(a)&&(a===y?p(e,t,l[a],r+2):a===m?p(e,t,l[a],r+1):((u={})[a]=l[a],p(e,t,{"**":u},r+1)));else l._listeners?p(e,t,l,h):l["*"]&&l["*"]._listeners&&p(e,t,l["*"],h);return f}h.EventEmitter2=h,h.prototype.delimiter=".",h.prototype.setMaxListeners=function(e){e!==a&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},h.prototype.event="",h.prototype.once=function(e,t){return this._once(e,t,!1)},h.prototype.prependOnceListener=function(e,t){return this._once(e,t,!0)},h.prototype._once=function(e,t,n){return this._many(e,1,t,n),this},h.prototype.many=function(e,t,n){return this._many(e,t,n,!1)},h.prototype.prependMany=function(e,t,n){return this._many(e,t,n,!0)},h.prototype._many=function(e,t,n,r){var o=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function i(){return 0==--t&&o.off(e,i),n.apply(this,arguments)}return i._origin=n,this._on(e,i,r),o},h.prototype.emit=function(){this._events||u.call(this);var e=arguments[0];if("newListener"===e&&!this._newListener&&!this._events.newListener)return!1;var t,n,r,o,i,a=arguments.length;if(this._all&&this._all.length){if(i=this._all.slice(),a>3)for(t=new Array(a),o=0;o<a;o++)t[o]=arguments[o];for(r=0,n=i.length;r<n;r++)switch(this.event=e,a){case 1:i[r].call(this,e);break;case 2:i[r].call(this,e,arguments[1]);break;case 3:i[r].call(this,e,arguments[1],arguments[2]);break;default:i[r].apply(this,t)}}if(this.wildcard){i=[];var s="string"==typeof e?e.split(this.delimiter):e.slice();p.call(this,i,s,this.listenerTree,0)}else{if("function"==typeof(i=this._events[e])){switch(this.event=e,a){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(a-1),o=1;o<a;o++)t[o-1]=arguments[o];i.apply(this,t)}return!0}i&&(i=i.slice())}if(i&&i.length){if(a>3)for(t=new Array(a-1),o=1;o<a;o++)t[o-1]=arguments[o];for(r=0,n=i.length;r<n;r++)switch(this.event=e,a){case 1:i[r].call(this);break;case 2:i[r].call(this,arguments[1]);break;case 3:i[r].call(this,arguments[1],arguments[2]);break;default:i[r].apply(this,t)}return!0}if(!this._all&&"error"===e)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},h.prototype.emitAsync=function(){this._events||u.call(this);var e=arguments[0];if("newListener"===e&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);var t,n,r,o,i,a=[],s=arguments.length;if(this._all){if(s>3)for(t=new Array(s),o=1;o<s;o++)t[o]=arguments[o];for(r=0,n=this._all.length;r<n;r++)switch(this.event=e,s){case 1:a.push(this._all[r].call(this,e));break;case 2:a.push(this._all[r].call(this,e,arguments[1]));break;case 3:a.push(this._all[r].call(this,e,arguments[1],arguments[2]));break;default:a.push(this._all[r].apply(this,t))}}if(this.wildcard){i=[];var l="string"==typeof e?e.split(this.delimiter):e.slice();p.call(this,i,l,this.listenerTree,0)}else i=this._events[e];if("function"==typeof i)switch(this.event=e,s){case 1:a.push(i.call(this));break;case 2:a.push(i.call(this,arguments[1]));break;case 3:a.push(i.call(this,arguments[1],arguments[2]));break;default:for(t=new Array(s-1),o=1;o<s;o++)t[o-1]=arguments[o];a.push(i.apply(this,t))}else if(i&&i.length){if(i=i.slice(),s>3)for(t=new Array(s-1),o=1;o<s;o++)t[o-1]=arguments[o];for(r=0,n=i.length;r<n;r++)switch(this.event=e,s){case 1:a.push(i[r].call(this));break;case 2:a.push(i[r].call(this,arguments[1]));break;case 3:a.push(i[r].call(this,arguments[1],arguments[2]));break;default:a.push(i[r].apply(this,t))}}else if(!this._all&&"error"===e)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(a)},h.prototype.on=function(e,t){return this._on(e,t,!1)},h.prototype.prependListener=function(e,t){return this._on(e,t,!0)},h.prototype.onAny=function(e){return this._onAny(e,!1)},h.prototype.prependAny=function(e){return this._onAny(e,!0)},h.prototype.addListener=h.prototype.on,h.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},h.prototype._on=function(e,t,n){if("function"==typeof e)return this._onAny(e,t),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");return this._events||u.call(this),this._newListener&&this.emit("newListener",e,t),this.wildcard?(function(e,t){for(var n=0,r=(e="string"==typeof e?e.split(this.delimiter):e.slice()).length;n+1<r;n++)if("**"===e[n]&&"**"===e[n+1])return;for(var o=this.listenerTree,i=e.shift();i!==a;){if(o[i]||(o[i]={}),o=o[i],0===e.length)return o._listeners?("function"==typeof o._listeners&&(o._listeners=[o._listeners]),o._listeners.push(t),!o._listeners.warned&&this._maxListeners>0&&o._listeners.length>this._maxListeners&&(o._listeners.warned=!0,f.call(this,o._listeners.length,i))):o._listeners=t,!0;i=e.shift()}return!0}.call(this,e,t),this):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,f.call(this,this._events[e].length,e))):this._events[e]=t,this)},h.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,r=[];if(this.wildcard){var o="string"==typeof e?e.split(this.delimiter):e.slice();r=p.call(this,null,o,this.listenerTree,0)}else{if(!this._events[e])return this;n=this._events[e],r.push({_listeners:n})}for(var l=0;l<r.length;l++){var u=r[l];if(n=u._listeners,s(n)){for(var c=-1,f=0,h=n.length;f<h;f++)if(n[f]===t||n[f].listener&&n[f].listener===t||n[f]._origin&&n[f]._origin===t){c=f;break}if(c<0)continue;return this.wildcard?u._listeners.splice(c,1):this._events[e].splice(c,1),0===n.length&&(this.wildcard?delete u._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete u._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return function e(t){if(t!==a){var n=Object.keys(t);for(var r in n){var o=n[r],s=t[o];s instanceof Function||"object"!==i(s)||null===s||(Object.keys(s).length>0&&e(t[o]),0===Object.keys(s).length&&delete t[o])}}}(this.listenerTree),this},h.prototype.offAny=function(e){var t,n=0,r=0;if(e&&this._all&&this._all.length>0){for(n=0,r=(t=this._all).length;n<r;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,r=t.length;n<r;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},h.prototype.removeListener=h.prototype.off,h.prototype.removeAllListeners=function(e){if(e===a)return!this._events||u.call(this),this;if(this.wildcard)for(var t="string"==typeof e?e.split(this.delimiter):e.slice(),n=p.call(this,null,t,this.listenerTree,0),r=0;r<n.length;r++){n[r]._listeners=null}else this._events&&(this._events[e]=null);return this},h.prototype.listeners=function(e){if(this.wildcard){var t=[],n="string"==typeof e?e.split(this.delimiter):e.slice();return p.call(this,t,n,this.listenerTree,0),t}return this._events||u.call(this),this._events[e]||(this._events[e]=[]),s(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},h.prototype.eventNames=function(){return Object.keys(this._events)},h.prototype.listenerCount=function(e){return this.listeners(e).length},h.prototype.listenersAny=function(){return this._all?this._all:[]},(o=function(){return h}.call(t,n,t,e))===a||(e.exports=o)}()}).call(this,n(106))},function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"Lexer",function(){return F}),n.d(r,"ParserRules",function(){return U}),n.d(r,"ParserStart",function(){return W});var o=n(152),i=["arnecolors","mastersystem","gameboycolour","amiga","arnecolors","famicom","atari","pastel","ega","amstrad","proteus_mellow","proteus_rich","proteus_night","c64","whitingjp"],a=new Map;a.set("mastersystem",{black:"#000000",white:"#FFFFFF",grey:"#555555",darkgrey:"#555500",lightgrey:"#AAAAAA",gray:"#555555",darkgray:"#555500",lightgray:"#AAAAAA",red:"#FF0000",darkred:"#AA0000",lightred:"#FF5555",brown:"#AA5500",darkbrown:"#550000",lightbrown:"#FFAA00",orange:"#FF5500",yellow:"#FFFF55",green:"#55AA00",darkgreen:"#005500",lightgreen:"#AAFF00",blue:"#5555AA",lightblue:"#AAFFFF",darkblue:"#000055",purple:"#550055",pink:"#FFAAFF"}),a.set("gameboycolour",{black:"#000000",white:"#FFFFFF",grey:"#7F7F7C",darkgrey:"#3E3E44",lightgrey:"#BAA7A7",gray:"#7F7F7C",darkgray:"#3E3E44",lightgray:"#BAA7A7",red:"#A7120C",darkred:"#880606",lightred:"#BA381F",brown:"#57381F",darkbrown:"#3E2519",lightbrown:"#8E634B",orange:"#BA4B32",yellow:"#C0BA6F",green:"#517525",darkgreen:"#385D12",lightgreen:"#6F8E44",blue:"#5D6FA7",lightblue:"#8EA7A7",darkblue:"#4B575D",purple:"#3E3E44",pink:"#BA381F"}),a.set("amiga",{black:"#000000",white:"#FFFFFF",grey:"#BBBBBB",darkgrey:"#333333",lightgrey:"#FFEEDD",gray:"#BBBBBB",darkgray:"#333333",lightgray:"#FFEEDD",red:"#DD1111",darkred:"#990000",lightred:"#FF4422",brown:"#663311",darkbrown:"#331100",lightbrown:"#AA6644",orange:"#FF6644",yellow:"#FFDD66",green:"#448811",darkgreen:"#335500",lightgreen:"#88BB77",blue:"#8899DD",lightblue:"#BBDDEE",darkblue:"#666688",purple:"#665555",pink:"#997788"}),a.set("arnecolors",{black:"#000000",white:"#FFFFFF",grey:"#9d9d9d",darkgrey:"#697175",lightgrey:"#cccccc",gray:"#9d9d9d",darkgray:"#697175",lightgray:"#cccccc",red:"#be2633",darkred:"#732930",lightred:"#e06f8b",brown:"#a46422",darkbrown:"#493c2b",lightbrown:"#eeb62f",orange:"#eb8931",yellow:"#f7e26b",green:"#44891a",darkgreen:"#2f484e",lightgreen:"#a3ce27",blue:"#1d57f7",lightblue:"#B2DCEF",darkblue:"#1B2632",purple:"#342a97",pink:"#de65e2"}),a.set("famicom",{black:"#000000",white:"#ffffff",grey:"#7c7c7c",darkgrey:"#080808",lightgrey:"#bcbcbc",gray:"#7c7c7c",darkgray:"#080808",lightgray:"#bcbcbc",red:"#f83800",darkred:"#881400",lightred:"#f87858",brown:"#AC7C00",darkbrown:"#503000",lightbrown:"#FCE0A8",orange:"#FCA044",yellow:"#F8B800",green:"#00B800",darkgreen:"#005800",lightgreen:"#B8F8B8",blue:"#0058F8",lightblue:"#3CBCFC",darkblue:"#0000BC",purple:"#6644FC",pink:"#F878F8"}),a.set("atari",{black:"#000000",white:"#FFFFFF",grey:"#909090",darkgrey:"#404040",lightgrey:"#b0b0b0",gray:"#909090",darkgray:"#404040",lightgray:"#b0b0b0",red:"#A03C50",darkred:"#700014",lightred:"#DC849C",brown:"#805020",darkbrown:"#703400",lightbrown:"#CB9870",orange:"#CCAC70",yellow:"#ECD09C",green:"#58B06C",darkgreen:"#006414",lightgreen:"#70C484",blue:"#1C3C88",lightblue:"#6888C8",darkblue:"#000088",purple:"#3C0080",pink:"#B484DC"}),a.set("pastel",{black:"#000000",white:"#FFFFFF",grey:"#3e3e3e",darkgrey:"#313131",lightgrey:"#9cbcbc",gray:"#3e3e3e",darkgray:"#313131",lightgray:"#9cbcbc",red:"#f56ca2",darkred:"#a63577",lightred:"#ffa9cf",brown:"#b58c53",darkbrown:"#787562",lightbrown:"#B58C53",orange:"#EB792D",yellow:"#FFe15F",green:"#00FF4F",darkgreen:"#2b732c",lightgreen:"#97c04f",blue:"#0f88d3",lightblue:"#00fffe",darkblue:"#293a7b",purple:"#ff6554",pink:"#eb792d"}),a.set("ega",{black:"#000000",white:"#ffffff",grey:"#555555",darkgrey:"#555555",lightgrey:"#aaaaaa",gray:"#555555",darkgray:"#555555",lightgray:"#aaaaaa",red:"#ff5555",darkred:"#aa0000",lightred:"#ff55ff",brown:"#aa5500",darkbrown:"#aa5500",lightbrown:"#ffff55",orange:"#ff5555",yellow:"#ffff55",green:"#00aa00",darkgreen:"#00aaaa",lightgreen:"#55ff55",blue:"#5555ff",lightblue:"#55ffff",darkblue:"#0000aa",purple:"#aa00aa",pink:"#ff55ff"}),a.set("proteus_mellow",{black:"#3d2d2e",white:"#ddf1fc",grey:"#9fb2d4",darkgrey:"#7b8272",lightgrey:"#a4bfda",gray:"#9fb2d4",darkgray:"#7b8272",lightgray:"#a4bfda",red:"#9d5443",darkred:"#8c5b4a",lightred:"#94614c",brown:"#89a78d",darkbrown:"#829e88",lightbrown:"#aaae97",orange:"#d1ba86",yellow:"#d6cda2",green:"#75ac8d",darkgreen:"#8fa67f",lightgreen:"#8eb682",blue:"#88a3ce",lightblue:"#a5adb0",darkblue:"#5c6b8c",purple:"#d39fac",pink:"#c8ac9e"}),a.set("proteus_night",{black:"#010912",white:"#fdeeec",grey:"#051d40",darkgrey:"#091842",lightgrey:"#062151",gray:"#051d40",darkgray:"#091842",lightgray:"#062151",red:"#ad4576",darkred:"#934765",lightred:"#ab6290",brown:"#61646b",darkbrown:"#3d2d2d",lightbrown:"#8393a0",orange:"#0a2227",yellow:"#0a2541",green:"#75ac8d",darkgreen:"#0a2434",lightgreen:"#061f2e",blue:"#0b2c79",lightblue:"#809ccb",darkblue:"#08153b",purple:"#666a87",pink:"#754b4d"}),a.set("proteus_rich",{black:"#6f686f",white:"#d1b1e2",grey:"#b9aac1",darkgrey:"#8e8b84",lightgrey:"#c7b5cd",gray:"#b9aac1",darkgray:"#8e8b84",lightgray:"#c7b5cd",red:"#a11f4f",darkred:"#934765",lightred:"#c998ad",brown:"#89867d",darkbrown:"#797f75",lightbrown:"#ab9997",orange:"#ce8c5c",yellow:"#f0d959",green:"#75bc54",darkgreen:"#599d79",lightgreen:"#90cf5c",blue:"#8fd0ec",lightblue:"#bcdce7",darkblue:"#0b2c70",purple:"#9b377f",pink:"#cd88e5"}),a.set("amstrad",{black:"#000000",white:"#ffffff",grey:"#7f7f7f",darkgrey:"#636363",lightgrey:"#afafaf",gray:"#7f7f7f",darkgray:"#636363",lightgray:"#afafaf",red:"#ff0000",darkred:"#7f0000",lightred:"#ff7f7f",brown:"#ff7f00",darkbrown:"#7f7f00",lightbrown:"#ffff00",orange:"#ff007f",yellow:"#ffff7f",green:"#01ff00",darkgreen:"#007f00",lightgreen:"#7fff7f",blue:"#0000ff",lightblue:"#7f7fff",darkblue:"#00007f",purple:"#7f007f",pink:"#ff7fff"}),a.set("c64",{black:"#000000",white:"#ffffff",grey:"#6C6C6C",darkgrey:"#444444",lightgrey:"#959595",gray:"#6C6C6C",darkgray:"#444444",lightgray:"#959595",red:"#68372B",darkred:"#3f1e17",lightred:"#9A6759",brown:"#433900",darkbrown:"#221c02",lightbrown:"#6d5c0d",orange:"#6F4F25",yellow:"#B8C76F",green:"#588D43",darkgreen:"#345129",lightgreen:"#9AD284",blue:"#6C5EB5",lightblue:"#70A4B2",darkblue:"#352879",purple:"#6F3D86",pink:"#b044ac"}),a.set("whitingjp",{black:"#202527",white:"#eff8fd",grey:"#7b7680",darkgrey:"#3c3b44",lightgrey:"#bed0d7",gray:"#7b7680",darkgray:"#3c3b44",lightgray:"#bed0d7",red:"#bd194b",darkred:"#6b1334",lightred:"#ef2358",brown:"#b52e1c",darkbrown:"#681c12",lightbrown:"#e87b45",orange:"#ff8c10",yellow:"#fbd524",green:"#36bc3c",darkgreen:"#317610",lightgreen:"#8ce062",blue:"#3f62c6",lightblue:"#57bbe0",darkblue:"#2c2fa0",purple:"#7037d9",pink:"#ec2b8f"});var s=n(56),l=n(29),u=n(77),c=n(61),f=n(7),h=n(14),p=n(55),m=n(0),y=n(2);function d(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){g(e,t,n[t])})}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=[m.d.UP,m.d.DOWN,m.d.LEFT,m.d.RIGHT],w=new Set(S);function E(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s&&t.push(s)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}function T(e,t){var n=t.toKey();return e.has(n)||e.set(n,t),e.get(n)}var O=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t,this.tileCache=new Map,this.soundCache=new Map}var t,n,r;return t=e,(n=[{key:"build",value:function(e){var t=this,n=this.toSource({_sourceOffset:0}),r=new c.b;e.metadata.forEach(function(e){var n;if("object"===$(e.value)&&e.value.type)switch(e.value.type){case y.b.HEX3:case y.b.HEX6:case y.b.NAME:var o=e.value;n=t.buildColor(o,r.colorPalette);break;case"WIDTH_AND_HEIGHT":var i=e.value;n=new c.a(i.width,i.height);break;default:throw new Error("BUG: Invalid type at this point in time: ".concat(e.value))}else n=e.value;r._setValue(e.type,n)});var o=e.sprites.map(function(e){return t.buildSprite(e,r.colorPalette)});o.forEach(function(e,t){e.allSpritesBitSetIndex=t});var i=e.legendItems.map(function(e){return t.buildLegendItem(e)}),a=e.sounds.map(function(e){return t.buildSound(e)}),s=e.collisionLayers.map(function(e){return t.buildCollisionLayer(e)}),l=this.buildSimpleRules(e.rules),f=e.winConditions.map(function(e){return t.buildWinConditon(e)}),h=e.levels.map(function(e){return t.buildLevel(e)});return new u.a(n,e.title,r,o,i,a,s,l,f,h)}},{key:"buildSprite",value:function(e,t){var n,r=this;if(e.type===y.h.WITH_PIXELS){var o=this.toSource(e),i=e.colors.map(function(e){return r.buildColor(e,t)}),a=e.pixels.map(function(e){return e.map(function(e){return"."===e?new l.b(o):i[e]||new l.b(o)})});n=new h.e(o,e.name,e.mapChar,a)}else n=new h.f(this.toSource(e),e.name,e.mapChar,e.colors.map(function(e){return r.buildColor(e,t)}));return this.cacheAdd(e.name,n),e.mapChar&&this.cacheAdd(e.mapChar,n),n}},{key:"buildColor",value:function(e,t){var n=this.toSource(e),r=t||"arnecolors";switch(e.type){case y.b.HEX6:case y.b.HEX3:return new l.a(n,e.value);case y.b.NAME:if("TRANSPARENT"===e.value.toUpperCase())return new l.b(n);var o=function(e,t){var n;n=Number.parseInt(e,10)>=1?i[Number.parseInt(e,10)]:e;var r=a.get(n);if(!r)throw new Error('BUG: Invalid color palette name or number: "'.concat(e,'" "').concat(n,'"'));return r[t.toLowerCase()]}(r,e.value);return o?new l.a(n,o):new l.b(n);default:throw new Error("Unsupported type ".concat(e))}}},{key:"buildLegendItem",value:function(e){var t=this,n=this.toSource(e);switch(e.type){case y.i.SIMPLE:if(!e.tile)throw new Error("BUG!!!!!!");var r=new h.c(n,e.name,this.cacheGet(e.tile));return this.cacheAdd(e.name,r),r;case y.i.AND:if(!e.tiles)throw new Error("BUG!!!!!!");var o=new h.a(n,e.name,e.tiles.map(function(e){return t.cacheGet(e)}));return this.cacheAdd(e.name,o),o;case y.i.OR:if(!e.tiles)throw new Error("BUG!!!!!!");var i=new h.b(n,e.name,e.tiles.map(function(e){return t.cacheGet(e)}));return this.cacheAdd(e.name,i),i;default:throw new Error("Unsupported type ".concat(e))}}},{key:"buildCollisionLayer",value:function(e){var t=this,n=this.toSource(e);return new s.a(n,e.tiles.map(function(e){return t.cacheGet(e)}))}},{key:"buildSound",value:function(e){switch(e.type){case"SOUND_SFX":return this.soundCacheAdd(e.soundEffect,e),e;case"SOUND_WHEN":return e;case"SOUND_SPRITE_MOVE":case"SOUND_SPRITE_DIRECTION":case"SOUND_SPRITE_EVENT":return b({},e,{sprite:this.cacheGet(e.sprite)});default:throw new Error("Unsupported type ".concat(e))}}},{key:"buildCommand",value:function(e){switch(e.type){case y.c.SFX:return this.soundCacheHas(e.sound)?b({},e,{sound:this.soundCacheGet(e.sound)}):null;case y.c.AGAIN:case y.c.CANCEL:case y.c.MESSAGE:case y.c.CHECKPOINT:case y.c.RESTART:case y.c.WIN:return e;default:throw new Error("Unsupported type ".concat(e))}}},{key:"buildWinConditon",value:function(e){var t=this.toSource(e);switch(e.type){case y.j.ON:return new p.a(t,e.qualifier,this.cacheGet(e.tile),this.cacheGet(e.onTile));case y.j.SIMPLE:return new p.b(t,e.qualifier,this.cacheGet(e.tile));default:throw new Error("Unsupported type ".concat(e))}}},{key:"buildLevel",value:function(e){var t=this;switch(e.type){case y.d.MESSAGE:return e;case y.d.MAP:return b({},e,{cells:e.cells.map(function(e){return e.map(function(e){return t.cacheGet(e)})})});default:throw new Error("Unsupported type ".concat(e))}}},{key:"buildSimpleRules",value:function(e){var t=this,n=new Map,r=new Map,o=new Map,i=new Map;return e.map(function(e){return t.simplifyRule(e,n,r,o,i)})}},{key:"simplifyRule",value:function(e,t,n,r,o){var i=this,a=this.toSource(e);switch(e.type){case y.f.LOOP:var s=e.rules.map(function(e){return i.simplifyRule(e,t,n,r,o)});return new f.g(a,!1,s);case y.f.GROUP:if(e.rules[0]){var l=!!e.rules[0].isRandom,u=e.rules.map(function(e){return i.simplifyRule(e,t,n,r,o)});return new f.f(a,l,u)}throw new Error("BUG!!!!!!");case y.f.SIMPLE:var c=!!e.isRandom,h=e.conditions,p=e.actions;if(h.length!==p.length&&0!==p.length)throw new Error('Left side has "'.concat(h.length,'" conditions and right side has "').concat(p.length,'" actions!'));if(h.length===p.length);else if(0!==p.length)throw new Error("Invalid Rule. The number of brackets on the right must match the structure of the left hand side or be 0");var m=this.rule_convertToMultiple(e).map(function(e){return i.rule_toSimple(e,t,n,r,o)});if(1===m.length||!e.isRandom&&m[1]&&m[0].canCollapseBecauseBracketsMatch(m[1]))return m[0].subscribeToCellChanges(),new f.f(a,c,[m[0]]);var d=!0,v=!1,b=void 0;try{for(var g,$=m[Symbol.iterator]();!(d=(g=$.next()).done);d=!0){g.value.subscribeToCellChanges()}}catch(e){v=!0,b=e}finally{try{d||null==$.return||$.return()}finally{if(v)throw b}}return new f.f(a,c,m);default:throw new Error("Unsupported type ".concat(e))}}},{key:"rule_toSimple",value:function(e,t,n,r,o){var i=this,a=this.toSource(e),s=this.rule_getDirectionModifiers(e),l=E(e.commands.map(function(e){return i.buildCommand(e)}));if(1!==s.length)throw new Error('BUG: should have exactly 1 direction by now but found the following: "'.concat(s,'"'));for(var u=e.conditions.map(function(e){return i.bracket_toSimple(e,s[0],t,n,r,o)}),c=e.actions.map(function(e){return i.bracket_toSimple(e,s[0],t,n,r,o)}),h=0;h<u.length;h++)c[h];return T(t,new f.e(a,u,c,l,e.isLate,e.isRigid,e.debugFlag))}},{key:"rule_convertToMultiple",value:function(e){var t=[],n=[],r=!0,o=!1,i=void 0;try{for(var a,s=this.rule_getDirectionModifiers(e)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=this.rule_clone(e,l,null,null);t.push(u)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}var c,f=new Map;f.set(y.e.HORIZONTAL,[m.d.LEFT,m.d.RIGHT]),f.set(y.e.VERTICAL,[m.d.UP,m.d.DOWN]),f.set(y.e.MOVING,[m.d.UP,m.d.DOWN,m.d.LEFT,m.d.RIGHT,m.d.ACTION]);do{c=!1;for(var h=0;h<t.length;h++){var p=t[h],d=!1,b=this.rule_getDirectionModifiers(p)[0];if(1!==this.rule_getDirectionModifiers(p).length)throw new Error("BUG: should have already expanded the rule to only contian one direction");var g=!0,$=!1,_=void 0;try{for(var S,w=f[Symbol.iterator]();!(g=(S=w.next()).done);g=!0){var E=v(S.value,2),T=E[0],O=E[1];if(this.rule_hasModifier(p,T)){var R=!0,k=!1,L=void 0;try{for(var x,C=O[Symbol.iterator]();!(R=(x=C.next()).done);R=!0){var A=x.value;n.push(this.rule_clone(p,b,T,A)),d=!0,c=!0}}catch(e){k=!0,L=e}finally{try{R||null==C.return||C.return()}finally{if(k)throw L}}}}}catch(e){$=!0,_=e}finally{try{g||null==w.return||w.return()}finally{if($)throw _}}if(!d){var M=void 0,I=void 0;switch(b){case m.d.UP:case m.d.DOWN:M=[m.d.LEFT,m.d.RIGHT],I=[m.d.UP,m.d.DOWN];break;case m.d.LEFT:case m.d.RIGHT:M=[m.d.UP,m.d.DOWN],I=[m.d.LEFT,m.d.RIGHT];break;default:throw new Error("BUG: There must be some direction")}if(M&&I)for(var N=[{nameToExpand:y.e.ORTHOGONAL,variations:M},{nameToExpand:y.e.PERPENDICULAR,variations:M},{nameToExpand:y.e.PARALLEL,variations:I}],P=0;P<N.length;P++){var D=N[P];T=D.nameToExpand,O=D.variations;if(this.rule_hasModifier(p,T)){var G=!0,B=!1,F=void 0;try{for(var U,W=O[Symbol.iterator]();!(G=(U=W.next()).done);G=!0){var j=U.value;n.push(this.rule_clone(p,b,T,j)),d=!0,c=!0}}catch(e){B=!0,F=e}finally{try{G||null==W.return||W.return()}finally{if(B)throw F}}}}}d||n.push(p)}t=n,n=[]}while(c);return t}},{key:"rule_clone",value:function(e,t,n,r){var o,i=this,a=e.conditions.map(function(e){return i.bracket_clone(e,t,n,r)}),s=e.actions.map(function(e){return i.bracket_clone(e,t,n,r)});switch(t){case m.d.UP:o=y.e.UP;break;case m.d.DOWN:o=y.e.DOWN;break;case m.d.LEFT:o=y.e.LEFT;break;case m.d.RIGHT:o=y.e.RIGHT;break;default:throw new Error('BUG: Invalid direction "'.concat(t,'"'))}return b({},e,{directions:[o],conditions:a,actions:s})}},{key:"rule_getDirectionModifiers",value:function(e){if(e.directions.indexOf(y.e.HORIZONTAL)>=0)return[m.d.LEFT,m.d.RIGHT];if(e.directions.indexOf(y.e.VERTICAL)>=0)return[m.d.UP,m.d.DOWN];var t=e.directions.filter(function(e){return w.has(e)}).map(function(e){switch(e){case y.e.UP:return m.d.UP;case y.e.DOWN:return m.d.DOWN;case y.e.LEFT:return m.d.LEFT;case y.e.RIGHT:return m.d.RIGHT;default:throw new Error('BUG: Invalid rule direction "'.concat(e,'"'))}});return 0===t.length?S:t}},{key:"rule_hasModifier",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=e.conditions[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l=!0,u=!1,c=void 0;try{for(var f,h=this.rule_getAllBracketNeighbors(s)[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var p=f.value,m=!0,y=!1,d=void 0;try{for(var v,b=p.tileWithModifiers[Symbol.iterator]();!(m=(v=b.next()).done);m=!0){if(v.value.direction===t)return!0}}catch(e){y=!0,d=e}finally{try{m||null==b.return||b.return()}finally{if(y)throw d}}}}catch(e){u=!0,c=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw c}}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return!1}},{key:"rule_getAllBracketNeighbors",value:function(e){switch(e.type){case y.a.SIMPLE:return e.neighbors;case y.a.ELLIPSIS:return[].concat(d(e.beforeNeighbors),d(e.afterNeighbors));default:throw new Error("Unsupported type ".concat(e))}}},{key:"bracket_clone",value:function(e,t,n,r){var o=this;switch(e.type){case y.a.SIMPLE:var i=e.neighbors.map(function(e){return o.neighbor_clone(e,t,n,r)});return b({},e,{neighbors:i});case y.a.ELLIPSIS:var a=e.beforeNeighbors.map(function(e){return o.neighbor_clone(e,t,n,r)}),s=e.afterNeighbors.map(function(e){return o.neighbor_clone(e,t,n,r)});return b({},e,{beforeNeighbors:a,afterNeighbors:s});default:throw new Error("Unsupported type ".concat(e))}}},{key:"neighbor_clone",value:function(e,t,n,r){var o=this;return b({},e,{tileWithModifiers:e.tileWithModifiers.map(function(e){return o.tile_clone(e,t,n,r)})})}},{key:"tile_clone",value:function(e,t,n,r){switch(e.direction){case m.e.RELATIVE_UP:case m.e.RELATIVE_DOWN:case m.e.RELATIVE_LEFT:case m.e.RELATIVE_RIGHT:return b({},e,{direction:function(e,t){var n;switch(e){case m.d.RIGHT:n=0;break;case m.d.UP:n=1;break;case m.d.LEFT:n=2;break;case m.d.DOWN:n=3;break;default:throw new Error('BUG! Invalid rule direction "'.concat(e))}switch(t){case m.e.RELATIVE_RIGHT:n+=0;break;case m.e.RELATIVE_UP:n+=1;break;case m.e.RELATIVE_LEFT:n+=2;break;case m.e.RELATIVE_DOWN:n+=3;break;default:throw new Error('BUG! invalid relative direction "'.concat(t,'"'))}switch(n%4){case 0:return m.d.RIGHT;case 1:return m.d.UP;case 2:return m.d.LEFT;case 3:return m.d.DOWN;default:throw new Error('BUG! Incorrectly computed rule direction "'.concat(e,'" "').concat(t,'"'))}}(t,e.direction)});case n:return b({},e,{direction:r});case m.d.UP:case m.d.DOWN:case m.d.LEFT:case m.d.RIGHT:case m.d.ACTION:case m.d.STATIONARY:case m.d.RANDOMDIR:case null:case void 0:default:return e}}},{key:"bracket_toSimple",value:function(e,t,n,r,o,i){var a=this,s=this.toSource(e);switch(e.type){case y.a.SIMPLE:var l=e.neighbors.map(function(e){return a.neighbor_toSimple(e,o,i)});return T(r,new f.b(s,t,l,e.debugFlag));case y.a.ELLIPSIS:var u=e.beforeNeighbors.map(function(e){return a.neighbor_toSimple(e,o,i)}),c=e.afterNeighbors.map(function(e){return a.neighbor_toSimple(e,o,i)});return T(r,new f.c(s,t,u,c,e.debugFlag));default:throw new Error("Unsupported type ".concat(e))}}},{key:"neighbor_toSimple",value:function(e,t,n){var r=this,o=this.toSource(e),i=new Map,a=!0,s=!1,l=void 0;try{for(var u,c=e.tileWithModifiers[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var h=u.value;i.has(h.tile)||i.set(h.tile,h)}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}var p=d(i.values()),m=new Set(E(p.map(function(e){return r.tile_toSimple(e,n)})));return T(t,new f.d(o,m,e.debugFlag))}},{key:"tile_toSimple",value:function(e,t){var n=this.toSource(e);if(!this.cacheHas(e.tile))return null;var r,o=this.cacheGet(e.tile);switch(e.direction){case m.e.RELATIVE_UP:case m.e.RELATIVE_DOWN:case m.e.RELATIVE_LEFT:case m.e.RELATIVE_RIGHT:throw new Error("BUG: Relative directions should have been resolved by now");default:r=e.direction||null}return T(t,new f.h(n,e.isNegated,e.isRandom,r,o,e.debugFlag))}},{key:"toSource",value:function(e){return{code:this.code,sourceOffset:e._sourceOffset}}},{key:"cacheHas",value:function(e){return this.tileCache.has(e.toLowerCase())}},{key:"cacheAdd",value:function(e,t){if(this.tileCache.has(e.toLowerCase()))throw new Error("BUG??? duplicate definition of ".concat(e));this.tileCache.set(e.toLowerCase(),t)}},{key:"cacheGet",value:function(e){var t=this.tileCache.get(e.toLowerCase());if(t)return t;throw new Error("BUG: Could not find tile named ".concat(e))}},{key:"soundCacheAdd",value:function(e,t){if(this.soundCache.has(e.toLowerCase()))throw new Error("BUG??? duplicate definition of ".concat(e));this.soundCache.set(e.toLowerCase(),t)}},{key:"soundCacheGet",value:function(e){var t=this.soundCache.get(e.toLowerCase());if(t)return t;throw new Error("BUG: Could not find sound named ".concat(e))}},{key:"soundCacheHas",value:function(e){return this.soundCache.has(e.toLowerCase())}}])&&_(t.prototype,n),r&&_(t,r),e}();function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function k(e){return e[0]}var L=new Set([]),x=new Set([]),C=function(e,t){return x.has(e)?L.has(e)?null:t||function(t){return{type:e,args:t}}:null},A=function(e){return null},M=function(e){return R(e,1)[0].join("")},I=function(e){return e.map(function(e){if(1!==e.length)throw new Error("BUG: Expected items to only have one element (usually used in listOf[...])");return e[0]})},N=function(e){return e.map(function(e){if(e.length<2)throw new Error("BUG: Expected items to have at least 2 elements (usually used in listOf[...])");return e[1]})};function P(e){var t=R(e,2),n=t[0],r=t[1];return[n].concat(r.map(function(e){var t=R(e,2);t[0];return t[1]}))}var D,G=function(e){return R(e,1)[0].toUpperCase()},B=new Set(["...","AGAIN","DEBUGGER","NO","LEFT","RIGHT","UP","DOWN","RANDOMDIR","RANDOM","STATIONARY","MOVING","ACTION","VERTICAL","HORIZONTAL","PERPENDICULAR","PARALLEL","ORTHOGONAL","^","<",">","V"]),F=void 0,U=[{name:"main$ebnf$1",symbols:[]},{name:"main$ebnf$1",symbols:["main$ebnf$1","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$2",symbols:["lineTerminator"]},{name:"main$ebnf$2",symbols:["main$ebnf$2","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$3$macrocall$2",symbols:["t_OBJECTS"]},{name:"main$ebnf$3$macrocall$3",symbols:["Sprite"]},{name:"main$ebnf$3$macrocall$1$ebnf$1",symbols:[{literal:"="}]},{name:"main$ebnf$3$macrocall$1$ebnf$1",symbols:["main$ebnf$3$macrocall$1$ebnf$1",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$3$macrocall$1$ebnf$2",symbols:[{literal:"="}]},{name:"main$ebnf$3$macrocall$1$ebnf$2",symbols:["main$ebnf$3$macrocall$1$ebnf$2",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$3$macrocall$1$ebnf$3",symbols:["lineTerminator"]},{name:"main$ebnf$3$macrocall$1$ebnf$3",symbols:["main$ebnf$3$macrocall$1$ebnf$3","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$3$macrocall$1$ebnf$4",symbols:[]},{name:"main$ebnf$3$macrocall$1$ebnf$4$subexpression$1",symbols:["main$ebnf$3$macrocall$3"]},{name:"main$ebnf$3$macrocall$1$ebnf$4",symbols:["main$ebnf$3$macrocall$1$ebnf$4","main$ebnf$3$macrocall$1$ebnf$4$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$3$macrocall$1",symbols:["_","main$ebnf$3$macrocall$1$ebnf$1","lineTerminator","_","main$ebnf$3$macrocall$2","lineTerminator","_","main$ebnf$3$macrocall$1$ebnf$2","main$ebnf$3$macrocall$1$ebnf$3","main$ebnf$3$macrocall$1$ebnf$4"],postprocess:C("Section",function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4]),r=(t[5],t[6],t[7],t[8],t[9]);return{type:"SECTION",name:n,items:I(I(r))}})||function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);return I(I(n))}},{name:"main$ebnf$3",symbols:["main$ebnf$3$macrocall$1"],postprocess:k},{name:"main$ebnf$3",symbols:[],postprocess:function(){return null}},{name:"main$ebnf$4$macrocall$2",symbols:["t_LEGEND"]},{name:"main$ebnf$4$macrocall$3",symbols:["LegendTile"]},{name:"main$ebnf$4$macrocall$1$ebnf$1",symbols:[{literal:"="}]},{name:"main$ebnf$4$macrocall$1$ebnf$1",symbols:["main$ebnf$4$macrocall$1$ebnf$1",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$4$macrocall$1$ebnf$2",symbols:[{literal:"="}]},{name:"main$ebnf$4$macrocall$1$ebnf$2",symbols:["main$ebnf$4$macrocall$1$ebnf$2",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$4$macrocall$1$ebnf$3",symbols:["lineTerminator"]},{name:"main$ebnf$4$macrocall$1$ebnf$3",symbols:["main$ebnf$4$macrocall$1$ebnf$3","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$4$macrocall$1$ebnf$4",symbols:[]},{name:"main$ebnf$4$macrocall$1$ebnf$4$subexpression$1",symbols:["main$ebnf$4$macrocall$3"]},{name:"main$ebnf$4$macrocall$1$ebnf$4",symbols:["main$ebnf$4$macrocall$1$ebnf$4","main$ebnf$4$macrocall$1$ebnf$4$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$4$macrocall$1",symbols:["_","main$ebnf$4$macrocall$1$ebnf$1","lineTerminator","_","main$ebnf$4$macrocall$2","lineTerminator","_","main$ebnf$4$macrocall$1$ebnf$2","main$ebnf$4$macrocall$1$ebnf$3","main$ebnf$4$macrocall$1$ebnf$4"],postprocess:C("Section",function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4]),r=(t[5],t[6],t[7],t[8],t[9]);return{type:"SECTION",name:n,items:I(I(r))}})||function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);return I(I(n))}},{name:"main$ebnf$4",symbols:["main$ebnf$4$macrocall$1"],postprocess:k},{name:"main$ebnf$4",symbols:[],postprocess:function(){return null}},{name:"main$ebnf$5$macrocall$2",symbols:["t_SOUNDS"]},{name:"main$ebnf$5$macrocall$3",symbols:["SoundItem"]},{name:"main$ebnf$5$macrocall$1$ebnf$1",symbols:[{literal:"="}]},{name:"main$ebnf$5$macrocall$1$ebnf$1",symbols:["main$ebnf$5$macrocall$1$ebnf$1",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$5$macrocall$1$ebnf$2",symbols:[{literal:"="}]},{name:"main$ebnf$5$macrocall$1$ebnf$2",symbols:["main$ebnf$5$macrocall$1$ebnf$2",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$5$macrocall$1$ebnf$3",symbols:["lineTerminator"]},{name:"main$ebnf$5$macrocall$1$ebnf$3",symbols:["main$ebnf$5$macrocall$1$ebnf$3","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$5$macrocall$1$ebnf$4",symbols:[]},{name:"main$ebnf$5$macrocall$1$ebnf$4$subexpression$1",symbols:["main$ebnf$5$macrocall$3"]},{name:"main$ebnf$5$macrocall$1$ebnf$4",symbols:["main$ebnf$5$macrocall$1$ebnf$4","main$ebnf$5$macrocall$1$ebnf$4$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$5$macrocall$1",symbols:["_","main$ebnf$5$macrocall$1$ebnf$1","lineTerminator","_","main$ebnf$5$macrocall$2","lineTerminator","_","main$ebnf$5$macrocall$1$ebnf$2","main$ebnf$5$macrocall$1$ebnf$3","main$ebnf$5$macrocall$1$ebnf$4"],postprocess:C("Section",function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4]),r=(t[5],t[6],t[7],t[8],t[9]);return{type:"SECTION",name:n,items:I(I(r))}})||function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);return I(I(n))}},{name:"main$ebnf$5",symbols:["main$ebnf$5$macrocall$1"],postprocess:k},{name:"main$ebnf$5",symbols:[],postprocess:function(){return null}},{name:"main$ebnf$6$macrocall$2",symbols:["t_COLLISIONLAYERS"]},{name:"main$ebnf$6$macrocall$3",symbols:["CollisionLayerItem"]},{name:"main$ebnf$6$macrocall$1$ebnf$1",symbols:[{literal:"="}]},{name:"main$ebnf$6$macrocall$1$ebnf$1",symbols:["main$ebnf$6$macrocall$1$ebnf$1",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$6$macrocall$1$ebnf$2",symbols:[{literal:"="}]},{name:"main$ebnf$6$macrocall$1$ebnf$2",symbols:["main$ebnf$6$macrocall$1$ebnf$2",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$6$macrocall$1$ebnf$3",symbols:["lineTerminator"]},{name:"main$ebnf$6$macrocall$1$ebnf$3",symbols:["main$ebnf$6$macrocall$1$ebnf$3","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$6$macrocall$1$ebnf$4",symbols:[]},{name:"main$ebnf$6$macrocall$1$ebnf$4$subexpression$1",symbols:["main$ebnf$6$macrocall$3"]},{name:"main$ebnf$6$macrocall$1$ebnf$4",symbols:["main$ebnf$6$macrocall$1$ebnf$4","main$ebnf$6$macrocall$1$ebnf$4$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$6$macrocall$1",symbols:["_","main$ebnf$6$macrocall$1$ebnf$1","lineTerminator","_","main$ebnf$6$macrocall$2","lineTerminator","_","main$ebnf$6$macrocall$1$ebnf$2","main$ebnf$6$macrocall$1$ebnf$3","main$ebnf$6$macrocall$1$ebnf$4"],postprocess:C("Section",function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4]),r=(t[5],t[6],t[7],t[8],t[9]);return{type:"SECTION",name:n,items:I(I(r))}})||function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);return I(I(n))}},{name:"main$ebnf$6",symbols:["main$ebnf$6$macrocall$1"],postprocess:k},{name:"main$ebnf$6",symbols:[],postprocess:function(){return null}},{name:"main$ebnf$7$macrocall$2",symbols:["t_RULES"]},{name:"main$ebnf$7$macrocall$3",symbols:["RuleItem"]},{name:"main$ebnf$7$macrocall$1$ebnf$1",symbols:[{literal:"="}]},{name:"main$ebnf$7$macrocall$1$ebnf$1",symbols:["main$ebnf$7$macrocall$1$ebnf$1",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$7$macrocall$1$ebnf$2",symbols:[{literal:"="}]},{name:"main$ebnf$7$macrocall$1$ebnf$2",symbols:["main$ebnf$7$macrocall$1$ebnf$2",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$7$macrocall$1$ebnf$3",symbols:["lineTerminator"]},{name:"main$ebnf$7$macrocall$1$ebnf$3",symbols:["main$ebnf$7$macrocall$1$ebnf$3","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$7$macrocall$1$ebnf$4",symbols:[]},{name:"main$ebnf$7$macrocall$1$ebnf$4$subexpression$1",symbols:["main$ebnf$7$macrocall$3"]},{name:"main$ebnf$7$macrocall$1$ebnf$4",symbols:["main$ebnf$7$macrocall$1$ebnf$4","main$ebnf$7$macrocall$1$ebnf$4$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$7$macrocall$1",symbols:["_","main$ebnf$7$macrocall$1$ebnf$1","lineTerminator","_","main$ebnf$7$macrocall$2","lineTerminator","_","main$ebnf$7$macrocall$1$ebnf$2","main$ebnf$7$macrocall$1$ebnf$3","main$ebnf$7$macrocall$1$ebnf$4"],postprocess:C("Section",function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4]),r=(t[5],t[6],t[7],t[8],t[9]);return{type:"SECTION",name:n,items:I(I(r))}})||function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);return I(I(n))}},{name:"main$ebnf$7",symbols:["main$ebnf$7$macrocall$1"],postprocess:k},{name:"main$ebnf$7",symbols:[],postprocess:function(){return null}},{name:"main$ebnf$8$macrocall$2",symbols:["t_WINCONDITIONS"]},{name:"main$ebnf$8$macrocall$3",symbols:["WinConditionItem"]},{name:"main$ebnf$8$macrocall$1$ebnf$1",symbols:[{literal:"="}]},{name:"main$ebnf$8$macrocall$1$ebnf$1",symbols:["main$ebnf$8$macrocall$1$ebnf$1",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$8$macrocall$1$ebnf$2",symbols:[{literal:"="}]},{name:"main$ebnf$8$macrocall$1$ebnf$2",symbols:["main$ebnf$8$macrocall$1$ebnf$2",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$8$macrocall$1$ebnf$3",symbols:["lineTerminator"]},{name:"main$ebnf$8$macrocall$1$ebnf$3",symbols:["main$ebnf$8$macrocall$1$ebnf$3","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$8$macrocall$1$ebnf$4",symbols:[]},{name:"main$ebnf$8$macrocall$1$ebnf$4$subexpression$1",symbols:["main$ebnf$8$macrocall$3"]},{name:"main$ebnf$8$macrocall$1$ebnf$4",symbols:["main$ebnf$8$macrocall$1$ebnf$4","main$ebnf$8$macrocall$1$ebnf$4$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$8$macrocall$1",symbols:["_","main$ebnf$8$macrocall$1$ebnf$1","lineTerminator","_","main$ebnf$8$macrocall$2","lineTerminator","_","main$ebnf$8$macrocall$1$ebnf$2","main$ebnf$8$macrocall$1$ebnf$3","main$ebnf$8$macrocall$1$ebnf$4"],postprocess:C("Section",function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4]),r=(t[5],t[6],t[7],t[8],t[9]);return{type:"SECTION",name:n,items:I(I(r))}})||function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);return I(I(n))}},{name:"main$ebnf$8",symbols:["main$ebnf$8$macrocall$1"],postprocess:k},{name:"main$ebnf$8",symbols:[],postprocess:function(){return null}},{name:"main$ebnf$9$macrocall$2",symbols:["t_LEVELS"]},{name:"main$ebnf$9$macrocall$3",symbols:["LevelItem"]},{name:"main$ebnf$9$macrocall$1$ebnf$1",symbols:[{literal:"="}]},{name:"main$ebnf$9$macrocall$1$ebnf$1",symbols:["main$ebnf$9$macrocall$1$ebnf$1",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$9$macrocall$1$ebnf$2",symbols:[{literal:"="}]},{name:"main$ebnf$9$macrocall$1$ebnf$2",symbols:["main$ebnf$9$macrocall$1$ebnf$2",{literal:"="}],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$9$macrocall$1$ebnf$3",symbols:[]},{name:"main$ebnf$9$macrocall$1$ebnf$3$subexpression$1",symbols:["main$ebnf$9$macrocall$3"]},{name:"main$ebnf$9$macrocall$1$ebnf$3",symbols:["main$ebnf$9$macrocall$1$ebnf$3","main$ebnf$9$macrocall$1$ebnf$3$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"main$ebnf$9$macrocall$1",symbols:["_","main$ebnf$9$macrocall$1$ebnf$1","lineTerminator","_","main$ebnf$9$macrocall$2","lineTerminator","_","main$ebnf$9$macrocall$1$ebnf$2","lineTerminator","main$ebnf$9$macrocall$1$ebnf$3"],postprocess:C("Section",function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4]),r=(t[5],t[6],t[7],t[8],t[9]);return{type:"SECTION",name:n,items:I(I(r))}})||function(e){var t=R(e,10),n=(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);return I(I(n))}},{name:"main$ebnf$9",symbols:["main$ebnf$9$macrocall$1"],postprocess:k},{name:"main$ebnf$9",symbols:[],postprocess:function(){return null}},{name:"main",symbols:["main$ebnf$1","_","Title","main$ebnf$2","OptionalMetaData","main$ebnf$3","main$ebnf$4","main$ebnf$5","main$ebnf$6","main$ebnf$7","main$ebnf$8","main$ebnf$9"],postprocess:C("Section")||function(e){var t=R(e,12),n=(t[0],t[1],t[2]),r=(t[3],t[4]),o=t[5],i=t[6],a=t[7],s=t[8],l=t[9],u=t[10],c=t[11],f=[],h=null,p=!0,m=!1,y=void 0;try{for(var d,v=(c||[])[Symbol.iterator]();!(p=(d=v.next()).done);p=!0){var b=d.value;switch(b.type){case"LEVEL_ROW":h?h.push(b):h=[b];break;case"LEVEL_MESSAGE":h&&(f.push({type:"LEVEL_MAP",cells:h.map(function(e){return e.cells}),_sourceOffset:h[0]._sourceOffset}),h=null),f.push(b);break;case"LEVEL_SEPARATOR":h&&(f.push({type:"LEVEL_MAP",cells:h.map(function(e){return e.cells}),_sourceOffset:h[0]._sourceOffset}),h=null);break;default:throw new Error('BUG: Unsupported level row type "'.concat(b.type,'"'))}}}catch(e){m=!0,y=e}finally{try{p||null==v.return||v.return()}finally{if(m)throw y}}return h&&(f.push({type:"LEVEL_MAP",cells:h.map(function(e){return e.cells}),_sourceOffset:h[0]._sourceOffset}),h=null),{title:n.value,metadata:r.value,sprites:o||[],legendItems:i||[],sounds:a||[],collisionLayers:s||[],rules:l||[],winConditions:u||[],levels:f}}},{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1$subexpression$1",symbols:["whitespaceChar"]},{name:"_$ebnf$1$subexpression$1",symbols:["multiLineComment"]},{name:"_$ebnf$1",symbols:["_$ebnf$1","_$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"_",symbols:["_$ebnf$1"],postprocess:C("whitespace")||A},{name:"__$ebnf$1$subexpression$1",symbols:["whitespaceChar"]},{name:"__$ebnf$1$subexpression$1",symbols:["multiLineComment"]},{name:"__$ebnf$1",symbols:["__$ebnf$1$subexpression$1"]},{name:"__$ebnf$1$subexpression$2",symbols:["whitespaceChar"]},{name:"__$ebnf$1$subexpression$2",symbols:["multiLineComment"]},{name:"__$ebnf$1",symbols:["__$ebnf$1","__$ebnf$1$subexpression$2"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"__",symbols:["__$ebnf$1"],postprocess:C("whitespace")||A},{name:"multiLineComment$ebnf$1",symbols:[]},{name:"multiLineComment$ebnf$1",symbols:["multiLineComment$ebnf$1","textOrComment"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"multiLineComment",symbols:[{literal:"("},"multiLineComment$ebnf$1",{literal:")"}],postprocess:C("multiLineComment")||A},{name:"textOrComment",symbols:["multiLineComment"],postprocess:A},{name:"textOrComment",symbols:[/[^\(\)]/],postprocess:A},{name:"whitespaceChar",symbols:[{literal:" "}]},{name:"whitespaceChar",symbols:[{literal:"\t"}]},{name:"newline",symbols:[{literal:"\n"}]},{name:"digit",symbols:[/[0-9]/],postprocess:k},{name:"hexDigit",symbols:[/[0-9a-fA-F]/],postprocess:k},{name:"letter",symbols:[/[^\n \(\)]/],postprocess:k},{name:"integer$ebnf$1",symbols:["digit"]},{name:"integer$ebnf$1",symbols:["integer$ebnf$1","digit"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"integer",symbols:["integer$ebnf$1"],postprocess:function(e){var t=R(e,1)[0];return parseInt(t.join(""),10)}},{name:"word$ebnf$1",symbols:[/[^\n \(]/]},{name:"word$ebnf$1",symbols:["word$ebnf$1",/[^\n \(]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"word",symbols:["word$ebnf$1"],postprocess:C("WORD")||M},{name:"words$macrocall$2",symbols:["word"]},{name:"words$macrocall$3$ebnf$1",symbols:["whitespaceChar"]},{name:"words$macrocall$3$ebnf$1",symbols:["words$macrocall$3$ebnf$1","whitespaceChar"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"words$macrocall$3",symbols:["words$macrocall$3$ebnf$1"]},{name:"words$macrocall$1$ebnf$1",symbols:[]},{name:"words$macrocall$1$ebnf$1$subexpression$1",symbols:["words$macrocall$3","words$macrocall$2"]},{name:"words$macrocall$1$ebnf$1",symbols:["words$macrocall$1$ebnf$1","words$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"words$macrocall$1",symbols:["words$macrocall$2","words$macrocall$1$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"words",symbols:["words$macrocall$1"],postprocess:C("WORDS")||function(e){var t=R(e,1)[0];return I(t).join(" ")}},{name:"lineTerminator",symbols:["_","newline"],postprocess:C("lineTerminator")||A},{name:"sourceCharacter",symbols:[/[^\n ]/]},{name:"nonVarChar",symbols:["whitespaceChar"]},{name:"nonVarChar",symbols:["newline"]},{name:"nonVarChar",symbols:[{literal:"["}]},{name:"nonVarChar",symbols:[{literal:"]"}]},{name:"nonVarChar",symbols:[{literal:"("}]},{name:"nonVarChar",symbols:[{literal:")"}]},{name:"nonVarChar",symbols:[{literal:"|"}]},{name:"nonVarChar",symbols:[{literal:"."}]},{name:"decimal",symbols:["decimalWithLeadingNumber"]},{name:"decimal",symbols:["decimalWithLeadingPeriod"]},{name:"decimalWithLeadingNumber$ebnf$1",symbols:["digit"]},{name:"decimalWithLeadingNumber$ebnf$1",symbols:["decimalWithLeadingNumber$ebnf$1","digit"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"decimalWithLeadingNumber$ebnf$2$subexpression$1$ebnf$1",symbols:["digit"]},{name:"decimalWithLeadingNumber$ebnf$2$subexpression$1$ebnf$1",symbols:["decimalWithLeadingNumber$ebnf$2$subexpression$1$ebnf$1","digit"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"decimalWithLeadingNumber$ebnf$2$subexpression$1",symbols:[{literal:"."},"decimalWithLeadingNumber$ebnf$2$subexpression$1$ebnf$1"]},{name:"decimalWithLeadingNumber$ebnf$2",symbols:["decimalWithLeadingNumber$ebnf$2$subexpression$1"],postprocess:k},{name:"decimalWithLeadingNumber$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"decimalWithLeadingNumber",symbols:["decimalWithLeadingNumber$ebnf$1","decimalWithLeadingNumber$ebnf$2"],postprocess:function(e){var t=R(e,2),n=t[0],r=t[1];return r?Number.parseFloat("".concat(n[0],".").concat(r[1].join(""))):Number.parseInt(n[0],10)}},{name:"decimalWithLeadingPeriod$ebnf$1",symbols:["digit"]},{name:"decimalWithLeadingPeriod$ebnf$1",symbols:["decimalWithLeadingPeriod$ebnf$1","digit"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"decimalWithLeadingPeriod",symbols:[{literal:"."},"decimalWithLeadingPeriod$ebnf$1"],postprocess:function(e){var t=R(e,2),n=(t[0],t[1]);return Number.parseInt(n.join(""),10)}},{name:"colorHex6",symbols:[{literal:"#"},"hexDigit","hexDigit","hexDigit","hexDigit","hexDigit","hexDigit"],postprocess:function(e,t){return{type:y.b.HEX6,value:e.join(""),_sourceOffset:t}}},{name:"colorHex3",symbols:[{literal:"#"},"hexDigit","hexDigit","hexDigit"],postprocess:function(e,t){return{type:y.b.HEX3,value:e.join(""),_sourceOffset:t}}},{name:"colorNameOrHex",symbols:["colorHex6"],postprocess:k},{name:"colorNameOrHex",symbols:["colorHex3"],postprocess:k},{name:"colorNameOrHex",symbols:["colorName"],postprocess:k},{name:"colorName",symbols:[/[^\n #\(0-9\.]/,"word"],postprocess:C("COLOR_NAME")||function(e,t){var n=R(e,2),r=n[0],o=n[1];return{type:y.b.NAME,value:[r].concat(o).join(""),_sourceOffset:t}}},{name:"legendVariableChar",symbols:[/[^\n\ \=]/]},{name:"ruleVariableChar",symbols:[/[^(?=\.\.\.)\n \=\[\]\|]/]},{name:"ruleVariableName$ebnf$1",symbols:["ruleVariableChar"]},{name:"ruleVariableName$ebnf$1",symbols:["ruleVariableName$ebnf$1","ruleVariableChar"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"ruleVariableName",symbols:["ruleVariableName$ebnf$1"],postprocess:M},{name:"lookupRuleVariableName$ebnf$1",symbols:[/[^\n \=\[\]\|]/]},{name:"lookupRuleVariableName$ebnf$1",symbols:["lookupRuleVariableName$ebnf$1",/[^\n \=\[\]\|]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"lookupRuleVariableName",symbols:["lookupRuleVariableName$ebnf$1"],postprocess:function(e,t,n){var r=R(e,1)[0].join("");return B.has(r.toUpperCase())?n:r}},{name:"collisionVariableChar",symbols:[/[^(?=\.\.\.)\ \n\=\[\]\|\,]/]},{name:"collisionVariableName$ebnf$1",symbols:["collisionVariableChar"]},{name:"collisionVariableName$ebnf$1",symbols:["collisionVariableName$ebnf$1","collisionVariableChar"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"collisionVariableName",symbols:["collisionVariableName$ebnf$1"],postprocess:M},{name:"lookupCollisionVariableName",symbols:["collisionVariableName"],postprocess:k},{name:"t_DEBUGGER",symbols:["t_DEBUGGER_ADD"],postprocess:k},{name:"t_DEBUGGER",symbols:["t_DEBUGGER_REMOVE"],postprocess:k},{name:"t_DEBUGGER",symbols:["t_DEBUGGER_DEFAULT"],postprocess:k},{name:"t_DEBUGGER_DEFAULT$subexpression$1",symbols:[/[dD]/,/[eE]/,/[bB]/,/[uU]/,/[gG]/,/[gG]/,/[eE]/,/[rR]/],postprocess:function(e){return e.join("")}},{name:"t_DEBUGGER_DEFAULT",symbols:["t_DEBUGGER_DEFAULT$subexpression$1"],postprocess:G},{name:"t_DEBUGGER_ADD$subexpression$1",symbols:[/[dD]/,/[eE]/,/[bB]/,/[uU]/,/[gG]/,/[gG]/,/[eE]/,/[rR]/,{literal:"_"},/[aA]/,/[dD]/,/[dD]/],postprocess:function(e){return e.join("")}},{name:"t_DEBUGGER_ADD",symbols:["t_DEBUGGER_ADD$subexpression$1"],postprocess:G},{name:"t_DEBUGGER_REMOVE$subexpression$1",symbols:[/[dD]/,/[eE]/,/[bB]/,/[uU]/,/[gG]/,/[gG]/,/[eE]/,/[rR]/,{literal:"_"},/[rR]/,/[eE]/,/[mM]/,/[oO]/,/[vV]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_DEBUGGER_REMOVE",symbols:["t_DEBUGGER_REMOVE$subexpression$1"],postprocess:G},{name:"t_OBJECTS$subexpression$1",symbols:[/[oO]/,/[bB]/,/[jJ]/,/[eE]/,/[cC]/,/[tT]/,/[sS]/],postprocess:function(e){return e.join("")}},{name:"t_OBJECTS",symbols:["t_OBJECTS$subexpression$1"],postprocess:G},{name:"t_LEGEND$subexpression$1",symbols:[/[lL]/,/[eE]/,/[gG]/,/[eE]/,/[nN]/,/[dD]/],postprocess:function(e){return e.join("")}},{name:"t_LEGEND",symbols:["t_LEGEND$subexpression$1"],postprocess:G},{name:"t_SOUNDS$subexpression$1",symbols:[/[sS]/,/[oO]/,/[uU]/,/[nN]/,/[dD]/,/[sS]/],postprocess:function(e){return e.join("")}},{name:"t_SOUNDS",symbols:["t_SOUNDS$subexpression$1"],postprocess:G},{name:"t_COLLISIONLAYERS$subexpression$1",symbols:[/[cC]/,/[oO]/,/[lL]/,/[lL]/,/[iI]/,/[sS]/,/[iI]/,/[oO]/,/[nN]/,/[lL]/,/[aA]/,/[yY]/,/[eE]/,/[rR]/,/[sS]/],postprocess:function(e){return e.join("")}},{name:"t_COLLISIONLAYERS",symbols:["t_COLLISIONLAYERS$subexpression$1"],postprocess:G},{name:"t_RULES$subexpression$1",symbols:[/[rR]/,/[uU]/,/[lL]/,/[eE]/,/[sS]/],postprocess:function(e){return e.join("")}},{name:"t_RULES",symbols:["t_RULES$subexpression$1"],postprocess:G},{name:"t_WINCONDITIONS$subexpression$1",symbols:[/[wW]/,/[iI]/,/[nN]/,/[cC]/,/[oO]/,/[nN]/,/[dD]/,/[iI]/,/[tT]/,/[iI]/,/[oO]/,/[nN]/,/[sS]/],postprocess:function(e){return e.join("")}},{name:"t_WINCONDITIONS",symbols:["t_WINCONDITIONS$subexpression$1"],postprocess:G},{name:"t_LEVELS$subexpression$1",symbols:[/[lL]/,/[eE]/,/[vV]/,/[eE]/,/[lL]/,/[sS]/],postprocess:function(e){return e.join("")}},{name:"t_LEVELS",symbols:["t_LEVELS$subexpression$1"],postprocess:G},{name:"t_RIGID$subexpression$1",symbols:[/[rR]/,/[iI]/,/[gG]/,/[iI]/,/[dD]/],postprocess:function(e){return e.join("")}},{name:"t_RIGID",symbols:["t_RIGID$subexpression$1"],postprocess:G},{name:"t_LATE$subexpression$1",symbols:[/[lL]/,/[aA]/,/[tT]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_LATE",symbols:["t_LATE$subexpression$1"],postprocess:G},{name:"t_RANDOM$subexpression$1",symbols:[/[rR]/,/[aA]/,/[nN]/,/[dD]/,/[oO]/,/[mM]/],postprocess:function(e){return e.join("")}},{name:"t_RANDOM",symbols:["t_RANDOM$subexpression$1"],postprocess:G},{name:"t_RANDOMDIR$subexpression$1",symbols:[/[rR]/,/[aA]/,/[nN]/,/[dD]/,/[oO]/,/[mM]/,/[dD]/,/[iI]/,/[rR]/],postprocess:function(e){return e.join("")}},{name:"t_RANDOMDIR",symbols:["t_RANDOMDIR$subexpression$1"],postprocess:G},{name:"t_ACTION$subexpression$1",symbols:[/[aA]/,/[cC]/,/[tT]/,/[iI]/,/[oO]/,/[nN]/],postprocess:function(e){return e.join("")}},{name:"t_ACTION",symbols:["t_ACTION$subexpression$1"],postprocess:G},{name:"t_STARTLOOP$subexpression$1",symbols:[/[sS]/,/[tT]/,/[aA]/,/[rR]/,/[tT]/,/[lL]/,/[oO]/,/[oO]/,/[pP]/],postprocess:function(e){return e.join("")}},{name:"t_STARTLOOP",symbols:["t_STARTLOOP$subexpression$1"],postprocess:G},{name:"t_ENDLOOP$subexpression$1",symbols:[/[eE]/,/[nN]/,/[dD]/,/[lL]/,/[oO]/,/[oO]/,/[pP]/],postprocess:function(e){return e.join("")}},{name:"t_ENDLOOP",symbols:["t_ENDLOOP$subexpression$1"],postprocess:G},{name:"t_UP$subexpression$1",symbols:[/[uU]/,/[pP]/],postprocess:function(e){return e.join("")}},{name:"t_UP",symbols:["t_UP$subexpression$1"],postprocess:G},{name:"t_DOWN$subexpression$1",symbols:[/[dD]/,/[oO]/,/[wW]/,/[nN]/],postprocess:function(e){return e.join("")}},{name:"t_DOWN",symbols:["t_DOWN$subexpression$1"],postprocess:G},{name:"t_LEFT$subexpression$1",symbols:[/[lL]/,/[eE]/,/[fF]/,/[tT]/],postprocess:function(e){return e.join("")}},{name:"t_LEFT",symbols:["t_LEFT$subexpression$1"],postprocess:G},{name:"t_RIGHT$subexpression$1",symbols:[/[rR]/,/[iI]/,/[gG]/,/[hH]/,/[tT]/],postprocess:function(e){return e.join("")}},{name:"t_RIGHT",symbols:["t_RIGHT$subexpression$1"],postprocess:G},{name:"t_ARROW_UP$subexpression$1",symbols:[{literal:"^"}],postprocess:function(e){return e.join("")}},{name:"t_ARROW_UP",symbols:["t_ARROW_UP$subexpression$1"],postprocess:G},{name:"t_ARROW_DOWN$subexpression$1",symbols:[/[vV]/],postprocess:function(e){return e.join("")}},{name:"t_ARROW_DOWN",symbols:["t_ARROW_DOWN$subexpression$1"],postprocess:G},{name:"t_ARROW_LEFT$subexpression$1",symbols:[{literal:"<"}],postprocess:function(e){return e.join("")}},{name:"t_ARROW_LEFT",symbols:["t_ARROW_LEFT$subexpression$1"],postprocess:G},{name:"t_ARROW_RIGHT$subexpression$1",symbols:[{literal:">"}],postprocess:function(e){return e.join("")}},{name:"t_ARROW_RIGHT",symbols:["t_ARROW_RIGHT$subexpression$1"],postprocess:G},{name:"t_MOVING$subexpression$1",symbols:[/[mM]/,/[oO]/,/[vV]/,/[iI]/,/[nN]/,/[gG]/],postprocess:function(e){return e.join("")}},{name:"t_MOVING",symbols:["t_MOVING$subexpression$1"],postprocess:G},{name:"t_ORTHOGONAL$subexpression$1",symbols:[/[oO]/,/[rR]/,/[tT]/,/[hH]/,/[oO]/,/[gG]/,/[oO]/,/[nN]/,/[aA]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_ORTHOGONAL",symbols:["t_ORTHOGONAL$subexpression$1"],postprocess:G},{name:"t_PERPENDICULAR$subexpression$1",symbols:[/[pP]/,/[eE]/,/[rR]/,/[pP]/,/[eE]/,/[nN]/,/[dD]/,/[iI]/,/[cC]/,/[uU]/,/[lL]/,/[aA]/,/[rR]/],postprocess:function(e){return e.join("")}},{name:"t_PERPENDICULAR",symbols:["t_PERPENDICULAR$subexpression$1"],postprocess:G},{name:"t_PARALLEL$subexpression$1",symbols:[/[pP]/,/[aA]/,/[rR]/,/[aA]/,/[lL]/,/[lL]/,/[eE]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_PARALLEL",symbols:["t_PARALLEL$subexpression$1"],postprocess:G},{name:"t_STATIONARY$subexpression$1",symbols:[/[sS]/,/[tT]/,/[aA]/,/[tT]/,/[iI]/,/[oO]/,/[nN]/,/[aA]/,/[rR]/,/[yY]/],postprocess:function(e){return e.join("")}},{name:"t_STATIONARY",symbols:["t_STATIONARY$subexpression$1"],postprocess:G},{name:"t_HORIZONTAL$subexpression$1",symbols:[/[hH]/,/[oO]/,/[rR]/,/[iI]/,/[zZ]/,/[oO]/,/[nN]/,/[tT]/,/[aA]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_HORIZONTAL",symbols:["t_HORIZONTAL$subexpression$1"],postprocess:G},{name:"t_VERTICAL$subexpression$1",symbols:[/[vV]/,/[eE]/,/[rR]/,/[tT]/,/[iI]/,/[cC]/,/[aA]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_VERTICAL",symbols:["t_VERTICAL$subexpression$1"],postprocess:G},{name:"t_ARROW_ANY",symbols:["t_ARROW_UP"],postprocess:G},{name:"t_ARROW_ANY",symbols:["t_ARROW_DOWN"],postprocess:G},{name:"t_ARROW_ANY",symbols:["t_ARROW_LEFT"],postprocess:G},{name:"t_ARROW_ANY",symbols:["t_ARROW_RIGHT"],postprocess:G},{name:"t_AGAIN$subexpression$1",symbols:[/[aA]/,/[gG]/,/[aA]/,/[iI]/,/[nN]/],postprocess:function(e){return e.join("")}},{name:"t_AGAIN",symbols:["t_AGAIN$subexpression$1"],postprocess:G},{name:"t_CANCEL$subexpression$1",symbols:[/[cC]/,/[aA]/,/[nN]/,/[cC]/,/[eE]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_CANCEL",symbols:["t_CANCEL$subexpression$1"],postprocess:G},{name:"t_CHECKPOINT$subexpression$1",symbols:[/[cC]/,/[hH]/,/[eE]/,/[cC]/,/[kK]/,/[pP]/,/[oO]/,/[iI]/,/[nN]/,/[tT]/],postprocess:function(e){return e.join("")}},{name:"t_CHECKPOINT",symbols:["t_CHECKPOINT$subexpression$1"],postprocess:G},{name:"t_RESTART$subexpression$1",symbols:[/[rR]/,/[eE]/,/[sS]/,/[tT]/,/[aA]/,/[rR]/,/[tT]/],postprocess:function(e){return e.join("")}},{name:"t_RESTART",symbols:["t_RESTART$subexpression$1"],postprocess:G},{name:"t_UNDO$subexpression$1",symbols:[/[uU]/,/[nN]/,/[dD]/,/[oO]/],postprocess:function(e){return e.join("")}},{name:"t_UNDO",symbols:["t_UNDO$subexpression$1"],postprocess:G},{name:"t_WIN$subexpression$1",symbols:[/[wW]/,/[iI]/,/[nN]/],postprocess:function(e){return e.join("")}},{name:"t_WIN",symbols:["t_WIN$subexpression$1"],postprocess:G},{name:"t_MESSAGE$subexpression$1",symbols:[/[mM]/,/[eE]/,/[sS]/,/[sS]/,/[aA]/,/[gG]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_MESSAGE",symbols:["t_MESSAGE$subexpression$1"],postprocess:G},{name:"t_ELLIPSIS$subexpression$1",symbols:[{literal:"."},{literal:"."},{literal:"."}],postprocess:function(e){return e.join("")}},{name:"t_ELLIPSIS",symbols:["t_ELLIPSIS$subexpression$1"],postprocess:G},{name:"t_AND$subexpression$1",symbols:[/[aA]/,/[nN]/,/[dD]/],postprocess:function(e){return e.join("")}},{name:"t_AND",symbols:["t_AND$subexpression$1"],postprocess:G},{name:"t_OR$subexpression$1",symbols:[/[oO]/,/[rR]/],postprocess:function(e){return e.join("")}},{name:"t_OR",symbols:["t_OR$subexpression$1"],postprocess:G},{name:"t_SFX0$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"0"}],postprocess:function(e){return e.join("")}},{name:"t_SFX0",symbols:["t_SFX0$subexpression$1"],postprocess:G},{name:"t_SFX1$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"1"}],postprocess:function(e){return e.join("")}},{name:"t_SFX1",symbols:["t_SFX1$subexpression$1"],postprocess:G},{name:"t_SFX2$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"2"}],postprocess:function(e){return e.join("")}},{name:"t_SFX2",symbols:["t_SFX2$subexpression$1"],postprocess:G},{name:"t_SFX3$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"3"}],postprocess:function(e){return e.join("")}},{name:"t_SFX3",symbols:["t_SFX3$subexpression$1"],postprocess:G},{name:"t_SFX4$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"4"}],postprocess:function(e){return e.join("")}},{name:"t_SFX4",symbols:["t_SFX4$subexpression$1"],postprocess:G},{name:"t_SFX5$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"5"}],postprocess:function(e){return e.join("")}},{name:"t_SFX5",symbols:["t_SFX5$subexpression$1"],postprocess:G},{name:"t_SFX6$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"6"}],postprocess:function(e){return e.join("")}},{name:"t_SFX6",symbols:["t_SFX6$subexpression$1"],postprocess:G},{name:"t_SFX7$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"7"}],postprocess:function(e){return e.join("")}},{name:"t_SFX7",symbols:["t_SFX7$subexpression$1"],postprocess:G},{name:"t_SFX8$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"8"}],postprocess:function(e){return e.join("")}},{name:"t_SFX8",symbols:["t_SFX8$subexpression$1"],postprocess:G},{name:"t_SFX9$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"9"}],postprocess:function(e){return e.join("")}},{name:"t_SFX9",symbols:["t_SFX9$subexpression$1"],postprocess:G},{name:"t_SFX10$subexpression$1",symbols:[/[sS]/,/[fF]/,/[xX]/,{literal:"1"},{literal:"0"}],postprocess:function(e){return e.join("")}},{name:"t_SFX10",symbols:["t_SFX10$subexpression$1"],postprocess:G},{name:"t_SFX",symbols:["t_SFX10"],postprocess:G},{name:"t_SFX",symbols:["t_SFX0"],postprocess:G},{name:"t_SFX",symbols:["t_SFX1"],postprocess:G},{name:"t_SFX",symbols:["t_SFX2"],postprocess:G},{name:"t_SFX",symbols:["t_SFX3"],postprocess:G},{name:"t_SFX",symbols:["t_SFX4"],postprocess:G},{name:"t_SFX",symbols:["t_SFX5"],postprocess:G},{name:"t_SFX",symbols:["t_SFX6"],postprocess:G},{name:"t_SFX",symbols:["t_SFX7"],postprocess:G},{name:"t_SFX",symbols:["t_SFX8"],postprocess:G},{name:"t_SFX",symbols:["t_SFX9"],postprocess:G},{name:"t_TITLE$subexpression$1",symbols:[/[tT]/,/[iI]/,/[tT]/,/[lL]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_TITLE",symbols:["t_TITLE$subexpression$1"],postprocess:G},{name:"t_AUTHOR$subexpression$1",symbols:[/[aA]/,/[uU]/,/[tT]/,/[hH]/,/[oO]/,/[rR]/],postprocess:function(e){return e.join("")}},{name:"t_AUTHOR",symbols:["t_AUTHOR$subexpression$1"],postprocess:G},{name:"t_HOMEPAGE$subexpression$1",symbols:[/[hH]/,/[oO]/,/[mM]/,/[eE]/,/[pP]/,/[aA]/,/[gG]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_HOMEPAGE",symbols:["t_HOMEPAGE$subexpression$1"],postprocess:G},{name:"t_YOUTUBE$subexpression$1",symbols:[/[yY]/,/[oO]/,/[uU]/,/[tT]/,/[uU]/,/[bB]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_YOUTUBE",symbols:["t_YOUTUBE$subexpression$1"],postprocess:G},{name:"t_ZOOMSCREEN$subexpression$1",symbols:[/[zZ]/,/[oO]/,/[oO]/,/[mM]/,/[sS]/,/[cC]/,/[rR]/,/[eE]/,/[eE]/,/[nN]/],postprocess:function(e){return e.join("")}},{name:"t_ZOOMSCREEN",symbols:["t_ZOOMSCREEN$subexpression$1"],postprocess:G},{name:"t_FLICKSCREEN$subexpression$1",symbols:[/[fF]/,/[lL]/,/[iI]/,/[cC]/,/[kK]/,/[sS]/,/[cC]/,/[rR]/,/[eE]/,/[eE]/,/[nN]/],postprocess:function(e){return e.join("")}},{name:"t_FLICKSCREEN",symbols:["t_FLICKSCREEN$subexpression$1"],postprocess:G},{name:"t_REQUIRE_PLAYER_MOVEMENT$subexpression$1",symbols:[/[rR]/,/[eE]/,/[qQ]/,/[uU]/,/[iI]/,/[rR]/,/[eE]/,{literal:"_"},/[pP]/,/[lL]/,/[aA]/,/[yY]/,/[eE]/,/[rR]/,{literal:"_"},/[mM]/,/[oO]/,/[vV]/,/[eE]/,/[mM]/,/[eE]/,/[nN]/,/[tT]/],postprocess:function(e){return e.join("")}},{name:"t_REQUIRE_PLAYER_MOVEMENT",symbols:["t_REQUIRE_PLAYER_MOVEMENT$subexpression$1"],postprocess:G},{name:"t_RUN_RULES_ON_LEVEL_START$subexpression$1",symbols:[/[rR]/,/[uU]/,/[nN]/,{literal:"_"},/[rR]/,/[uU]/,/[lL]/,/[eE]/,/[sS]/,{literal:"_"},/[oO]/,/[nN]/,{literal:"_"},/[lL]/,/[eE]/,/[vV]/,/[eE]/,/[lL]/,{literal:"_"},/[sS]/,/[tT]/,/[aA]/,/[rR]/,/[tT]/],postprocess:function(e){return e.join("")}},{name:"t_RUN_RULES_ON_LEVEL_START",symbols:["t_RUN_RULES_ON_LEVEL_START$subexpression$1"],postprocess:G},{name:"t_COLOR_PALETTE$subexpression$1",symbols:[/[cC]/,/[oO]/,/[lL]/,/[oO]/,/[rR]/,{literal:"_"},/[pP]/,/[aA]/,/[lL]/,/[eE]/,/[tT]/,/[tT]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_COLOR_PALETTE",symbols:["t_COLOR_PALETTE$subexpression$1"],postprocess:G},{name:"t_BACKGROUND_COLOR$subexpression$1",symbols:[/[bB]/,/[aA]/,/[cC]/,/[kK]/,/[gG]/,/[rR]/,/[oO]/,/[uU]/,/[nN]/,/[dD]/,{literal:"_"},/[cC]/,/[oO]/,/[lL]/,/[oO]/,/[rR]/],postprocess:function(e){return e.join("")}},{name:"t_BACKGROUND_COLOR",symbols:["t_BACKGROUND_COLOR$subexpression$1"],postprocess:G},{name:"t_TEXT_COLOR$subexpression$1",symbols:[/[tT]/,/[eE]/,/[xX]/,/[tT]/,{literal:"_"},/[cC]/,/[oO]/,/[lL]/,/[oO]/,/[rR]/],postprocess:function(e){return e.join("")}},{name:"t_TEXT_COLOR",symbols:["t_TEXT_COLOR$subexpression$1"],postprocess:G},{name:"t_REALTIME_INTERVAL$subexpression$1",symbols:[/[rR]/,/[eE]/,/[aA]/,/[lL]/,/[tT]/,/[iI]/,/[mM]/,/[eE]/,{literal:"_"},/[iI]/,/[nN]/,/[tT]/,/[eE]/,/[rR]/,/[vV]/,/[aA]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_REALTIME_INTERVAL",symbols:["t_REALTIME_INTERVAL$subexpression$1"],postprocess:G},{name:"t_KEY_REPEAT_INTERVAL$subexpression$1",symbols:[/[kK]/,/[eE]/,/[yY]/,{literal:"_"},/[rR]/,/[eE]/,/[pP]/,/[eE]/,/[aA]/,/[tT]/,{literal:"_"},/[iI]/,/[nN]/,/[tT]/,/[eE]/,/[rR]/,/[vV]/,/[aA]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_KEY_REPEAT_INTERVAL",symbols:["t_KEY_REPEAT_INTERVAL$subexpression$1"],postprocess:G},{name:"t_AGAIN_INTERVAL$subexpression$1",symbols:[/[aA]/,/[gG]/,/[aA]/,/[iI]/,/[nN]/,{literal:"_"},/[iI]/,/[nN]/,/[tT]/,/[eE]/,/[rR]/,/[vV]/,/[aA]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_AGAIN_INTERVAL",symbols:["t_AGAIN_INTERVAL$subexpression$1"],postprocess:G},{name:"t_NOACTION$subexpression$1",symbols:[/[nN]/,/[oO]/,/[aA]/,/[cC]/,/[tT]/,/[iI]/,/[oO]/,/[nN]/],postprocess:function(e){return e.join("")}},{name:"t_NOACTION",symbols:["t_NOACTION$subexpression$1"],postprocess:G},{name:"t_NOUNDO$subexpression$1",symbols:[/[nN]/,/[oO]/,/[uU]/,/[nN]/,/[dD]/,/[oO]/],postprocess:function(e){return e.join("")}},{name:"t_NOUNDO",symbols:["t_NOUNDO$subexpression$1"],postprocess:G},{name:"t_NORESTART$subexpression$1",symbols:[/[nN]/,/[oO]/,/[rR]/,/[eE]/,/[sS]/,/[tT]/,/[aA]/,/[rR]/,/[tT]/],postprocess:function(e){return e.join("")}},{name:"t_NORESTART",symbols:["t_NORESTART$subexpression$1"],postprocess:G},{name:"t_THROTTLE_MOVEMENT$subexpression$1",symbols:[/[tT]/,/[hH]/,/[rR]/,/[oO]/,/[tT]/,/[tT]/,/[lL]/,/[eE]/,{literal:"_"},/[mM]/,/[oO]/,/[vV]/,/[eE]/,/[mM]/,/[eE]/,/[nN]/,/[tT]/],postprocess:function(e){return e.join("")}},{name:"t_THROTTLE_MOVEMENT",symbols:["t_THROTTLE_MOVEMENT$subexpression$1"],postprocess:G},{name:"t_NOREPEAT_ACTION$subexpression$1",symbols:[/[nN]/,/[oO]/,/[rR]/,/[eE]/,/[pP]/,/[eE]/,/[aA]/,/[tT]/,{literal:"_"},/[aA]/,/[cC]/,/[tT]/,/[iI]/,/[oO]/,/[nN]/],postprocess:function(e){return e.join("")}},{name:"t_NOREPEAT_ACTION",symbols:["t_NOREPEAT_ACTION$subexpression$1"],postprocess:G},{name:"t_VERBOSE_LOGGING$subexpression$1",symbols:[/[vV]/,/[eE]/,/[rR]/,/[bB]/,/[oO]/,/[sS]/,/[eE]/,{literal:"_"},/[lL]/,/[oO]/,/[gG]/,/[gG]/,/[iI]/,/[nN]/,/[gG]/],postprocess:function(e){return e.join("")}},{name:"t_VERBOSE_LOGGING",symbols:["t_VERBOSE_LOGGING$subexpression$1"],postprocess:G},{name:"t_TRANSPARENT$subexpression$1",symbols:[/[tT]/,/[rR]/,/[aA]/,/[nN]/,/[sS]/,/[pP]/,/[aA]/,/[rR]/,/[eE]/,/[nN]/,/[tT]/],postprocess:function(e){return e.join("")}},{name:"t_TRANSPARENT",symbols:["t_TRANSPARENT$subexpression$1"],postprocess:G},{name:"t_MOVE$subexpression$1",symbols:[/[mM]/,/[oO]/,/[vV]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_MOVE",symbols:["t_MOVE$subexpression$1"],postprocess:G},{name:"t_DESTROY$subexpression$1",symbols:[/[dD]/,/[eE]/,/[sS]/,/[tT]/,/[rR]/,/[oO]/,/[yY]/],postprocess:function(e){return e.join("")}},{name:"t_DESTROY",symbols:["t_DESTROY$subexpression$1"],postprocess:G},{name:"t_CREATE$subexpression$1",symbols:[/[cC]/,/[rR]/,/[eE]/,/[aA]/,/[tT]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_CREATE",symbols:["t_CREATE$subexpression$1"],postprocess:G},{name:"t_CANTMOVE$subexpression$1",symbols:[/[cC]/,/[aA]/,/[nN]/,/[tT]/,/[mM]/,/[oO]/,/[vV]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_CANTMOVE",symbols:["t_CANTMOVE$subexpression$1"],postprocess:G},{name:"t_TITLESCREEN$subexpression$1",symbols:[/[tT]/,/[iI]/,/[tT]/,/[lL]/,/[eE]/,/[sS]/,/[cC]/,/[rR]/,/[eE]/,/[eE]/,/[nN]/],postprocess:function(e){return e.join("")}},{name:"t_TITLESCREEN",symbols:["t_TITLESCREEN$subexpression$1"],postprocess:G},{name:"t_STARTGAME$subexpression$1",symbols:[/[sS]/,/[tT]/,/[aA]/,/[rR]/,/[tT]/,/[gG]/,/[aA]/,/[mM]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_STARTGAME",symbols:["t_STARTGAME$subexpression$1"],postprocess:G},{name:"t_STARTLEVEL$subexpression$1",symbols:[/[sS]/,/[tT]/,/[aA]/,/[rR]/,/[tT]/,/[lL]/,/[eE]/,/[vV]/,/[eE]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_STARTLEVEL",symbols:["t_STARTLEVEL$subexpression$1"],postprocess:G},{name:"t_ENDLEVEL$subexpression$1",symbols:[/[eE]/,/[nN]/,/[dD]/,/[lL]/,/[eE]/,/[vV]/,/[eE]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_ENDLEVEL",symbols:["t_ENDLEVEL$subexpression$1"],postprocess:G},{name:"t_ENDGAME$subexpression$1",symbols:[/[eE]/,/[nN]/,/[dD]/,/[gG]/,/[aA]/,/[mM]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_ENDGAME",symbols:["t_ENDGAME$subexpression$1"],postprocess:G},{name:"t_SHOWMESSAGE$subexpression$1",symbols:[/[sS]/,/[hH]/,/[oO]/,/[wW]/,/[mM]/,/[eE]/,/[sS]/,/[sS]/,/[aA]/,/[gG]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_SHOWMESSAGE",symbols:["t_SHOWMESSAGE$subexpression$1"],postprocess:G},{name:"t_CLOSEMESSAGE$subexpression$1",symbols:[/[cC]/,/[lL]/,/[oO]/,/[sS]/,/[eE]/,/[mM]/,/[eE]/,/[sS]/,/[sS]/,/[aA]/,/[gG]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_CLOSEMESSAGE",symbols:["t_CLOSEMESSAGE$subexpression$1"],postprocess:G},{name:"t_GROUP_RULE_PLUS$subexpression$1",symbols:[{literal:"+"}],postprocess:function(e){return e.join("")}},{name:"t_GROUP_RULE_PLUS",symbols:["t_GROUP_RULE_PLUS$subexpression$1"],postprocess:G},{name:"t_ON$subexpression$1",symbols:[/[oO]/,/[nN]/],postprocess:function(e){return e.join("")}},{name:"t_ON",symbols:["t_ON$subexpression$1"],postprocess:G},{name:"t_NO$subexpression$1",symbols:[/[nN]/,/[oO]/],postprocess:function(e){return e.join("")}},{name:"t_NO",symbols:["t_NO$subexpression$1"],postprocess:G},{name:"t_ALL$subexpression$1",symbols:[/[aA]/,/[lL]/,/[lL]/],postprocess:function(e){return e.join("")}},{name:"t_ALL",symbols:["t_ALL$subexpression$1"],postprocess:G},{name:"t_ANY$subexpression$1",symbols:[/[aA]/,/[nN]/,/[yY]/],postprocess:function(e){return e.join("")}},{name:"t_ANY",symbols:["t_ANY$subexpression$1"],postprocess:G},{name:"t_SOME$subexpression$1",symbols:[/[sS]/,/[oO]/,/[mM]/,/[eE]/],postprocess:function(e){return e.join("")}},{name:"t_SOME",symbols:["t_SOME$subexpression$1"],postprocess:G},{name:"Title",symbols:["t_TITLE","__","words"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"TITLE",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaData$ebnf$1",symbols:[]},{name:"OptionalMetaData$ebnf$1$subexpression$1$ebnf$1",symbols:["lineTerminator"]},{name:"OptionalMetaData$ebnf$1$subexpression$1$ebnf$1",symbols:["OptionalMetaData$ebnf$1$subexpression$1$ebnf$1","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"OptionalMetaData$ebnf$1$subexpression$1",symbols:["_","OptionalMetaDataItem","OptionalMetaData$ebnf$1$subexpression$1$ebnf$1"]},{name:"OptionalMetaData$ebnf$1",symbols:["OptionalMetaData$ebnf$1","OptionalMetaData$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"OptionalMetaData",symbols:["OptionalMetaData$ebnf$1"],postprocess:function(e){var t=R(e,1)[0];return{type:"METADATA",value:N(t)}}},{name:"OptionalMetaDataItem",symbols:["t_AUTHOR","__","words"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"AUTHOR",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_HOMEPAGE","__","word"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"HOMEPAGE",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_YOUTUBE","__","word"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"YOUTUBE",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_ZOOMSCREEN","__","widthAndHeight"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"ZOOMSCREEN",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_FLICKSCREEN","__","widthAndHeight"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"FLICKSCREEN",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem$ebnf$1$subexpression$1$string$1",symbols:[{literal:"o"},{literal:"f"},{literal:"f"}],postprocess:function(e){return e.join("")}},{name:"OptionalMetaDataItem$ebnf$1$subexpression$1",symbols:["__","OptionalMetaDataItem$ebnf$1$subexpression$1$string$1"]},{name:"OptionalMetaDataItem$ebnf$1",symbols:["OptionalMetaDataItem$ebnf$1$subexpression$1"],postprocess:k},{name:"OptionalMetaDataItem$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"OptionalMetaDataItem",symbols:["t_REQUIRE_PLAYER_MOVEMENT","OptionalMetaDataItem$ebnf$1"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"REQUIRE_PLAYER_MOVEMENT",value:!!n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem$ebnf$2$subexpression$1$string$1",symbols:[{literal:"t"},{literal:"r"},{literal:"u"},{literal:"e"}],postprocess:function(e){return e.join("")}},{name:"OptionalMetaDataItem$ebnf$2$subexpression$1",symbols:["__","OptionalMetaDataItem$ebnf$2$subexpression$1$string$1"]},{name:"OptionalMetaDataItem$ebnf$2",symbols:["OptionalMetaDataItem$ebnf$2$subexpression$1"],postprocess:k},{name:"OptionalMetaDataItem$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"OptionalMetaDataItem",symbols:["t_RUN_RULES_ON_LEVEL_START","OptionalMetaDataItem$ebnf$2"],postprocess:function(e,t){var n=R(e,3);n[0],n[1],n[2];return{type:"RUN_RULES_ON_LEVEL_START",value:!0,_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_COLOR_PALETTE","__","word"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"COLOR_PALETTE",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_BACKGROUND_COLOR","__","colorNameOrHex"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"BACKGROUND_COLOR",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_TEXT_COLOR","__","colorNameOrHex"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"TEXT_COLOR",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_REALTIME_INTERVAL","__","decimal"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"REALTIME_INTERVAL",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_KEY_REPEAT_INTERVAL","__","decimal"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"KEY_REPEAT_INTERVAL",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_AGAIN_INTERVAL","__","decimal"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"AGAIN_INTERVAL",value:n[2],_sourceOffset:t}}},{name:"OptionalMetaDataItem",symbols:["t_NOACTION"],postprocess:function(){return{type:"NOACTION",value:!0}}},{name:"OptionalMetaDataItem",symbols:["t_NOUNDO"],postprocess:function(){return{type:"NOUNDO",value:!0}}},{name:"OptionalMetaDataItem",symbols:["t_NOREPEAT_ACTION"],postprocess:function(){return{type:"NOREPEAT_ACTION",value:!0}}},{name:"OptionalMetaDataItem",symbols:["t_THROTTLE_MOVEMENT"],postprocess:function(){return{type:"THROTTLE_MOVEMENT",value:!0}}},{name:"OptionalMetaDataItem",symbols:["t_NORESTART"],postprocess:function(){return{type:"NORESTART",value:!0}}},{name:"OptionalMetaDataItem",symbols:["t_VERBOSE_LOGGING"],postprocess:function(){return{type:"VERBOSE_LOGGING",value:!0}}},{name:"widthAndHeight",symbols:["integer",{literal:"x"},"integer"],postprocess:function(e){var t=R(e,3),n=t[0];t[1];return{type:"WIDTH_AND_HEIGHT",width:n,height:t[2]}}},{name:"Sprite",symbols:["SpritePixels"],postprocess:k},{name:"Sprite",symbols:["SpriteNoPixels"],postprocess:k},{name:"SpriteNoPixels$ebnf$1$subexpression$1",symbols:["__","legendShortcutChar"]},{name:"SpriteNoPixels$ebnf$1",symbols:["SpriteNoPixels$ebnf$1$subexpression$1"],postprocess:k},{name:"SpriteNoPixels$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"SpriteNoPixels$ebnf$2",symbols:["lineTerminator"]},{name:"SpriteNoPixels$ebnf$2",symbols:["SpriteNoPixels$ebnf$2","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"SpriteNoPixels$ebnf$3",symbols:["lineTerminator"]},{name:"SpriteNoPixels$ebnf$3",symbols:["SpriteNoPixels$ebnf$3","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"SpriteNoPixels",symbols:["_","spriteName","SpriteNoPixels$ebnf$1","SpriteNoPixels$ebnf$2","_","colorDefinitions","SpriteNoPixels$ebnf$3"],postprocess:C("SpriteNoPixels")||function(e,t){var n=R(e,7),r=(n[0],n[1]),o=n[2],i=(n[3],n[4],n[5]);n[6];return{type:y.h.NO_PIXELS,name:r,mapChar:o?o[1]:null,colors:i,_sourceOffset:t}}},{name:"SpritePixels$ebnf$1$subexpression$1",symbols:["__","legendShortcutChar"]},{name:"SpritePixels$ebnf$1",symbols:["SpritePixels$ebnf$1$subexpression$1"],postprocess:k},{name:"SpritePixels$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"SpritePixels$ebnf$2",symbols:["lineTerminator"]},{name:"SpritePixels$ebnf$2",symbols:["SpritePixels$ebnf$2","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"SpritePixels$ebnf$3",symbols:["lineTerminator"]},{name:"SpritePixels$ebnf$3",symbols:["SpritePixels$ebnf$3","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"SpritePixels$ebnf$4",symbols:[]},{name:"SpritePixels$ebnf$4",symbols:["SpritePixels$ebnf$4","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"SpritePixels",symbols:["_","spriteName","SpritePixels$ebnf$1","SpritePixels$ebnf$2","_","colorDefinitions","SpritePixels$ebnf$3","PixelRows","SpritePixels$ebnf$4"],postprocess:C("SpritePixels")||function(e,t){var n=R(e,9),r=(n[0],n[1]),o=n[2],i=(n[3],n[4],n[5]),a=(n[6],n[7]);n[8];return{type:y.h.WITH_PIXELS,name:r,mapChar:o?o[1]:null,colors:i,pixels:a,_sourceOffset:t}}},{name:"colorDefinitions$macrocall$2",symbols:["colorNameOrHex"]},{name:"colorDefinitions$macrocall$3",symbols:["__"]},{name:"colorDefinitions$macrocall$1$ebnf$1",symbols:[]},{name:"colorDefinitions$macrocall$1$ebnf$1$subexpression$1",symbols:["colorDefinitions$macrocall$3","colorDefinitions$macrocall$2"]},{name:"colorDefinitions$macrocall$1$ebnf$1",symbols:["colorDefinitions$macrocall$1$ebnf$1","colorDefinitions$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"colorDefinitions$macrocall$1",symbols:["colorDefinitions$macrocall$2","colorDefinitions$macrocall$1$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"colorDefinitions",symbols:["colorDefinitions$macrocall$1"],postprocess:function(e){var t=R(e,1)[0];return I(t)}},{name:"colorDefinitions$macrocall$5",symbols:["colorHex6"]},{name:"colorDefinitions$macrocall$6",symbols:["__"]},{name:"colorDefinitions$macrocall$4$ebnf$1",symbols:[]},{name:"colorDefinitions$macrocall$4$ebnf$1$subexpression$1",symbols:["colorDefinitions$macrocall$6","colorDefinitions$macrocall$5"]},{name:"colorDefinitions$macrocall$4$ebnf$1",symbols:["colorDefinitions$macrocall$4$ebnf$1","colorDefinitions$macrocall$4$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"colorDefinitions$macrocall$4",symbols:["colorDefinitions$macrocall$5","colorDefinitions$macrocall$4$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"colorDefinitions$macrocall$8",symbols:["colorHex6"]},{name:"colorDefinitions$macrocall$9",symbols:["__"]},{name:"colorDefinitions$macrocall$7$ebnf$1",symbols:[]},{name:"colorDefinitions$macrocall$7$ebnf$1$subexpression$1",symbols:["colorDefinitions$macrocall$9","colorDefinitions$macrocall$8"]},{name:"colorDefinitions$macrocall$7$ebnf$1",symbols:["colorDefinitions$macrocall$7$ebnf$1","colorDefinitions$macrocall$7$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"colorDefinitions$macrocall$7",symbols:["colorDefinitions$macrocall$8","colorDefinitions$macrocall$7$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"colorDefinitions",symbols:["colorDefinitions$macrocall$4","colorDefinitions$macrocall$7"],postprocess:function(e){var t=R(e,2),n=t[0],r=t[1];return I(n.concat(r))}},{name:"spriteName",symbols:["ruleVariableName"],postprocess:k},{name:"pixelRow$ebnf$1",symbols:["pixelDigit"]},{name:"pixelRow$ebnf$1",symbols:["pixelRow$ebnf$1","pixelDigit"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"pixelRow",symbols:["_","pixelRow$ebnf$1","lineTerminator"],postprocess:C("pixelRow",function(e){var t=R(e,3),n=(t[0],t[1]);t[2];return{type:"PIXEL_ROW",entries:n}})||function(e){var t=R(e,3),n=(t[0],t[1]);t[2];return n}},{name:"pixelDigit",symbols:["digit"],postprocess:k},{name:"pixelDigit",symbols:[{literal:"."}],postprocess:k},{name:"legendShortcutChar",symbols:[/[^\n ]/],postprocess:k},{name:"PixelRows$ebnf$1",symbols:["pixelRow"]},{name:"PixelRows$ebnf$1",symbols:["PixelRows$ebnf$1","pixelRow"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"PixelRows",symbols:["pixelRow","pixelRow","pixelRow","pixelRow","PixelRows$ebnf$1"],postprocess:function(e){var t=R(e,5),n=t[0],r=t[1],o=t[2],i=t[3],a=t[4];return[n,r,o,i].concat(a)}},{name:"LegendTile",symbols:["LegendTileSimple"],postprocess:k},{name:"LegendTile",symbols:["LegendTileAnd"],postprocess:k},{name:"LegendTile",symbols:["LegendTileOr"],postprocess:k},{name:"LegendTileSimple$ebnf$1",symbols:["lineTerminator"]},{name:"LegendTileSimple$ebnf$1",symbols:["LegendTileSimple$ebnf$1","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"LegendTileSimple",symbols:["_","LegendVarNameDefn","_",{literal:"="},"_","LookupLegendVarName","LegendTileSimple$ebnf$1"],postprocess:C("LegendTileSimple")||function(e,t){var n=R(e,8),r=(n[0],n[1]),o=(n[2],n[3],n[4],n[5]);n[6],n[7];return{type:y.i.SIMPLE,name:r,tile:o,_sourceOffset:t}}},{name:"LegendTileAnd$macrocall$2",symbols:["LookupLegendVarName"]},{name:"LegendTileAnd$macrocall$3",symbols:["__","t_AND","__"]},{name:"LegendTileAnd$macrocall$1$ebnf$1$subexpression$1",symbols:["LegendTileAnd$macrocall$3","LegendTileAnd$macrocall$2"]},{name:"LegendTileAnd$macrocall$1$ebnf$1",symbols:["LegendTileAnd$macrocall$1$ebnf$1$subexpression$1"]},{name:"LegendTileAnd$macrocall$1$ebnf$1$subexpression$2",symbols:["LegendTileAnd$macrocall$3","LegendTileAnd$macrocall$2"]},{name:"LegendTileAnd$macrocall$1$ebnf$1",symbols:["LegendTileAnd$macrocall$1$ebnf$1","LegendTileAnd$macrocall$1$ebnf$1$subexpression$2"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"LegendTileAnd$macrocall$1",symbols:["LegendTileAnd$macrocall$2","LegendTileAnd$macrocall$1$ebnf$1"],postprocess:C("atLeast2ListOf")||P},{name:"LegendTileAnd$ebnf$1",symbols:["lineTerminator"]},{name:"LegendTileAnd$ebnf$1",symbols:["LegendTileAnd$ebnf$1","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"LegendTileAnd",symbols:["_","LegendVarNameDefn","_",{literal:"="},"_","LegendTileAnd$macrocall$1","LegendTileAnd$ebnf$1"],postprocess:C("LegendTileAnd")||function(e,t){var n=R(e,8),r=(n[0],n[1]),o=(n[2],n[3],n[4],n[5]);n[6],n[7];return{type:y.i.AND,name:r,tiles:I(o),_sourceOffset:t}}},{name:"LegendTileOr$macrocall$2",symbols:["LookupLegendVarName"]},{name:"LegendTileOr$macrocall$3",symbols:["__","t_OR","__"]},{name:"LegendTileOr$macrocall$1$ebnf$1$subexpression$1",symbols:["LegendTileOr$macrocall$3","LegendTileOr$macrocall$2"]},{name:"LegendTileOr$macrocall$1$ebnf$1",symbols:["LegendTileOr$macrocall$1$ebnf$1$subexpression$1"]},{name:"LegendTileOr$macrocall$1$ebnf$1$subexpression$2",symbols:["LegendTileOr$macrocall$3","LegendTileOr$macrocall$2"]},{name:"LegendTileOr$macrocall$1$ebnf$1",symbols:["LegendTileOr$macrocall$1$ebnf$1","LegendTileOr$macrocall$1$ebnf$1$subexpression$2"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"LegendTileOr$macrocall$1",symbols:["LegendTileOr$macrocall$2","LegendTileOr$macrocall$1$ebnf$1"],postprocess:C("atLeast2ListOf")||P},{name:"LegendTileOr$ebnf$1",symbols:["lineTerminator"]},{name:"LegendTileOr$ebnf$1",symbols:["LegendTileOr$ebnf$1","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"LegendTileOr",symbols:["_","LegendVarNameDefn","_",{literal:"="},"_","LegendTileOr$macrocall$1","LegendTileOr$ebnf$1"],postprocess:C("LegendTileOr")||function(e,t){var n=R(e,8),r=(n[0],n[1]),o=(n[2],n[3],n[4],n[5]);n[6],n[7];return{type:y.i.OR,name:r,tiles:I(o),_sourceOffset:t}}},{name:"LegendVarNameDefn",symbols:["word"],postprocess:C("LegendVarNameDefn")||k},{name:"LookupLegendVarName",symbols:["LegendVarNameDefn"],postprocess:C("LookupLegendVarName")||k},{name:"SoundItem$ebnf$1",symbols:["lineTerminator"]},{name:"SoundItem$ebnf$1",symbols:["SoundItem$ebnf$1","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"SoundItem",symbols:["_","SoundItemInner","SoundItem$ebnf$1"],postprocess:function(e){var t=R(e,3),n=(t[0],t[1]);t[2];return n}},{name:"SoundItemInner",symbols:["SoundItemEnum"],postprocess:k},{name:"SoundItemInner",symbols:["SoundItemSfx"],postprocess:k},{name:"SoundItemInner",symbols:["SoundItemMoveDirection"],postprocess:k},{name:"SoundItemInner",symbols:["SoundItemMoveSimple"],postprocess:k},{name:"SoundItemInner",symbols:["SoundItemNormal"],postprocess:k},{name:"soundItemSimpleOptions",symbols:["t_RESTART"],postprocess:G},{name:"soundItemSimpleOptions",symbols:["t_UNDO"],postprocess:G},{name:"soundItemSimpleOptions",symbols:["t_TITLESCREEN"],postprocess:G},{name:"soundItemSimpleOptions",symbols:["t_STARTGAME"],postprocess:G},{name:"soundItemSimpleOptions",symbols:["t_STARTLEVEL"],postprocess:G},{name:"soundItemSimpleOptions",symbols:["t_ENDLEVEL"],postprocess:G},{name:"soundItemSimpleOptions",symbols:["t_ENDGAME"],postprocess:G},{name:"soundItemSimpleOptions",symbols:["t_SHOWMESSAGE"],postprocess:G},{name:"soundItemSimpleOptions",symbols:["t_CLOSEMESSAGE"],postprocess:G},{name:"SoundItemEnum",symbols:["soundItemSimpleOptions","__","integer"],postprocess:function(e,t){var n=R(e,3),r=n[0],o=(n[1],n[2]);return{type:y.g.WHEN,when:r,soundCode:o,_sourceOffset:t}}},{name:"SoundItemSfx",symbols:["t_SFX","__","integer"],postprocess:function(e,t){var n=R(e,3),r=n[0],o=(n[1],n[2]);return{type:y.g.SFX,soundEffect:r,soundCode:o,_sourceOffset:t}}},{name:"SoundItemMoveDirection",symbols:["lookupRuleVariableName","__","t_MOVE","__","soundItemActionMoveArg","__","integer"],postprocess:function(e,t){var n=R(e,7),r=n[0],o=(n[1],n[2],n[3],n[4]),i=(n[5],n[6]);return{type:y.g.SPRITE_DIRECTION,sprite:r,direction:o,soundCode:i,_sourceOffset:t}}},{name:"SoundItemMoveSimple",symbols:["lookupRuleVariableName","__","t_MOVE","__","integer"],postprocess:function(e,t){var n=R(e,5),r=n[0],o=(n[1],n[2],n[3],n[4]);return{type:y.g.SPRITE_MOVE,sprite:r,soundCode:o,_sourceOffset:t}}},{name:"SoundItemNormal",symbols:["lookupRuleVariableName","__","SoundItemAction","__","integer"],postprocess:function(e,t){var n=R(e,5),r=n[0],o=(n[1],n[2]),i=(n[3],n[4]);return{type:y.g.SPRITE_EVENT,sprite:r,eventEnum:o,soundCode:i,_sourceOffset:t}}},{name:"SoundItemAction",symbols:["t_CREATE"],postprocess:G},{name:"SoundItemAction",symbols:["t_DESTROY"],postprocess:G},{name:"SoundItemAction",symbols:["t_CANTMOVE"],postprocess:G},{name:"soundItemActionMoveArg",symbols:["t_UP"],postprocess:G},{name:"soundItemActionMoveArg",symbols:["t_DOWN"],postprocess:G},{name:"soundItemActionMoveArg",symbols:["t_LEFT"],postprocess:G},{name:"soundItemActionMoveArg",symbols:["t_RIGHT"],postprocess:G},{name:"soundItemActionMoveArg",symbols:["t_HORIZONTAL"],postprocess:G},{name:"soundItemActionMoveArg",symbols:["t_VERTICAL"],postprocess:G},{name:"CollisionLayerItem$macrocall$2",symbols:["lookupCollisionVariableName"]},{name:"CollisionLayerItem$macrocall$3$subexpression$1",symbols:["_",{literal:","},"_"]},{name:"CollisionLayerItem$macrocall$3$subexpression$1",symbols:["__"]},{name:"CollisionLayerItem$macrocall$3",symbols:["CollisionLayerItem$macrocall$3$subexpression$1"]},{name:"CollisionLayerItem$macrocall$1$ebnf$1",symbols:[]},{name:"CollisionLayerItem$macrocall$1$ebnf$1$subexpression$1",symbols:["CollisionLayerItem$macrocall$3","CollisionLayerItem$macrocall$2"]},{name:"CollisionLayerItem$macrocall$1$ebnf$1",symbols:["CollisionLayerItem$macrocall$1$ebnf$1","CollisionLayerItem$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"CollisionLayerItem$macrocall$1",symbols:["CollisionLayerItem$macrocall$2","CollisionLayerItem$macrocall$1$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"CollisionLayerItem$ebnf$1",symbols:[{literal:","}],postprocess:k},{name:"CollisionLayerItem$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"CollisionLayerItem$ebnf$2",symbols:["lineTerminator"]},{name:"CollisionLayerItem$ebnf$2",symbols:["CollisionLayerItem$ebnf$2","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"CollisionLayerItem",symbols:["_","CollisionLayerItem$macrocall$1","CollisionLayerItem$ebnf$1","CollisionLayerItem$ebnf$2"],postprocess:C("CollisionLayerItem")||function(e,t){var n=R(e,3),r=(n[0],n[1]);n[2];return{type:"COLLISION_LAYER",tiles:I(r),_sourceOffset:t}}},{name:"RuleItem",symbols:["RuleLoop"],postprocess:k},{name:"RuleItem",symbols:["RuleGroup"],postprocess:k},{name:"RuleItem",symbols:["Rule"],postprocess:k},{name:"Rule",symbols:["RuleWithoutMessage"],postprocess:k},{name:"Rule",symbols:["RuleWithMessage"],postprocess:k},{name:"RuleWithoutMessage$macrocall$2",symbols:["ConditionBracket"]},{name:"RuleWithoutMessage$macrocall$3$ebnf$1$subexpression$1",symbols:["RuleModifier","_"]},{name:"RuleWithoutMessage$macrocall$3$ebnf$1",symbols:["RuleWithoutMessage$macrocall$3$ebnf$1$subexpression$1"],postprocess:k},{name:"RuleWithoutMessage$macrocall$3$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"RuleWithoutMessage$macrocall$3",symbols:["_","RuleWithoutMessage$macrocall$3$ebnf$1"]},{name:"RuleWithoutMessage$macrocall$1$ebnf$1",symbols:[]},{name:"RuleWithoutMessage$macrocall$1$ebnf$1$subexpression$1",symbols:["RuleWithoutMessage$macrocall$3","RuleWithoutMessage$macrocall$2"]},{name:"RuleWithoutMessage$macrocall$1$ebnf$1",symbols:["RuleWithoutMessage$macrocall$1$ebnf$1","RuleWithoutMessage$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleWithoutMessage$macrocall$1",symbols:["RuleWithoutMessage$macrocall$2","RuleWithoutMessage$macrocall$1$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"RuleWithoutMessage$string$1",symbols:[{literal:"-"},{literal:">"}],postprocess:function(e){return e.join("")}},{name:"RuleWithoutMessage$ebnf$1",symbols:[]},{name:"RuleWithoutMessage$ebnf$1$subexpression$1",symbols:["ActionBracket"]},{name:"RuleWithoutMessage$ebnf$1",symbols:["RuleWithoutMessage$ebnf$1","RuleWithoutMessage$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleWithoutMessage$ebnf$2",symbols:[]},{name:"RuleWithoutMessage$ebnf$2$subexpression$1",symbols:["_","RuleCommand"]},{name:"RuleWithoutMessage$ebnf$2",symbols:["RuleWithoutMessage$ebnf$2","RuleWithoutMessage$ebnf$2$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleWithoutMessage$ebnf$3",symbols:["lineTerminator"]},{name:"RuleWithoutMessage$ebnf$3",symbols:["RuleWithoutMessage$ebnf$3","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleWithoutMessage",symbols:["_","LeftModifiers","RuleWithoutMessage$macrocall$1","_","RuleWithoutMessage$string$1","RuleWithoutMessage$ebnf$1","RuleWithoutMessage$ebnf$2","RuleWithoutMessage$ebnf$3"],postprocess:C("RuleWithoutMessage")||function(e,t){var n=R(e,8),r=(n[0],n[1]),o=n[2],i=(n[3],n[4],n[5]),a=n[6],s=(n[7],r.filter(function(e){return["RANDOM","LATE","RIGID"].indexOf(e)<0})),l=r.indexOf("RANDOM")>=0,u=r.indexOf("LATE")>=0,c=r.indexOf("RIGID")>=0;return{type:y.f.SIMPLE,directions:s,isRandom:l,isLate:u,isRigid:c,conditions:I(o),actions:I(i),commands:N(a),_sourceOffset:t}}},{name:"RuleWithMessage$macrocall$2",symbols:["ConditionBracket"]},{name:"RuleWithMessage$macrocall$3$ebnf$1$subexpression$1",symbols:["RuleModifier","_"]},{name:"RuleWithMessage$macrocall$3$ebnf$1",symbols:["RuleWithMessage$macrocall$3$ebnf$1$subexpression$1"],postprocess:k},{name:"RuleWithMessage$macrocall$3$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"RuleWithMessage$macrocall$3",symbols:["_","RuleWithMessage$macrocall$3$ebnf$1"]},{name:"RuleWithMessage$macrocall$1$ebnf$1",symbols:[]},{name:"RuleWithMessage$macrocall$1$ebnf$1$subexpression$1",symbols:["RuleWithMessage$macrocall$3","RuleWithMessage$macrocall$2"]},{name:"RuleWithMessage$macrocall$1$ebnf$1",symbols:["RuleWithMessage$macrocall$1$ebnf$1","RuleWithMessage$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleWithMessage$macrocall$1",symbols:["RuleWithMessage$macrocall$2","RuleWithMessage$macrocall$1$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"RuleWithMessage$string$1",symbols:[{literal:"-"},{literal:">"}],postprocess:function(e){return e.join("")}},{name:"RuleWithMessage$ebnf$1",symbols:[]},{name:"RuleWithMessage$ebnf$1$subexpression$1",symbols:["ActionBracket"]},{name:"RuleWithMessage$ebnf$1",symbols:["RuleWithMessage$ebnf$1","RuleWithMessage$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleWithMessage$ebnf$2",symbols:[]},{name:"RuleWithMessage$ebnf$2$subexpression$1",symbols:["_","RuleCommand"]},{name:"RuleWithMessage$ebnf$2",symbols:["RuleWithMessage$ebnf$2","RuleWithMessage$ebnf$2$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleWithMessage$ebnf$3",symbols:[]},{name:"RuleWithMessage$ebnf$3",symbols:["RuleWithMessage$ebnf$3","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleWithMessage",symbols:["_","LeftModifiers","RuleWithMessage$macrocall$1","_","RuleWithMessage$string$1","RuleWithMessage$ebnf$1","RuleWithMessage$ebnf$2","_","MessageCommand","RuleWithMessage$ebnf$3"],postprocess:C("RuleWithoutMessage")||function(e,t){var n=R(e,10),r=(n[0],n[1]),o=n[2],i=(n[3],n[4],n[5]),a=n[6],s=(n[7],n[8]),l=(n[9],r.filter(function(e){return["RANDOM","LATE","RIGID"].indexOf(e)<0})),u=r.indexOf("RANDOM")>=0,c=r.indexOf("LATE")>=0,f=r.indexOf("RIGID")>=0,h=N(a);return s&&h.push(s),{type:y.f.SIMPLE,directions:l,isRandom:u,isLate:c,isRigid:f,conditions:I(o),actions:I(i),commands:h,_sourceOffset:t}}},{name:"ConditionBracket",symbols:["NormalRuleBracket"],postprocess:function(e,t){var n=R(e,1)[0],r=n.neighbors,o=n.againHack,i=n.debugFlag;return{type:y.a.SIMPLE,neighbors:r,againHack:o,debugFlag:i,_sourceOffset:t}}},{name:"ConditionBracket",symbols:["EllipsisRuleBracket"],postprocess:function(e,t){var n=R(e,1)[0],r=n.beforeNeighbors,o=n.afterNeighbors,i=n.debugFlag;return{type:y.a.ELLIPSIS,beforeNeighbors:r,afterNeighbors:o,debugFlag:i,_sourceOffset:t}}},{name:"ActionBracket$ebnf$1",symbols:[]},{name:"ActionBracket$ebnf$1$subexpression$1",symbols:["_","RuleModifier"]},{name:"ActionBracket$ebnf$1",symbols:["ActionBracket$ebnf$1","ActionBracket$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"ActionBracket",symbols:["ActionBracket$ebnf$1","_","NormalRuleBracket"],postprocess:function(e,t){var n=R(e,3),r=(n[0],n[1],n[2]),o=r.neighbors,i=r.againHack,a=r.debugFlag;return{type:y.a.SIMPLE,neighbors:o,againHack:i,debugFlag:a,_sourceOffset:t}}},{name:"ActionBracket$ebnf$2",symbols:[]},{name:"ActionBracket$ebnf$2$subexpression$1",symbols:["_","RuleModifier"]},{name:"ActionBracket$ebnf$2",symbols:["ActionBracket$ebnf$2","ActionBracket$ebnf$2$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"ActionBracket",symbols:["ActionBracket$ebnf$2","_","EllipsisRuleBracket"],postprocess:function(e,t){var n=R(e,3),r=(n[0],n[1],n[2]),o=r.beforeNeighbors,i=r.afterNeighbors,a=r.debugFlag;return{type:y.a.ELLIPSIS,beforeNeighbors:o,afterNeighbors:i,debugFlag:a,_sourceOffset:t}}},{name:"LeftModifiers$macrocall$2",symbols:["RuleModifierLeft"]},{name:"LeftModifiers$macrocall$3",symbols:["__"]},{name:"LeftModifiers$macrocall$1$ebnf$1",symbols:[]},{name:"LeftModifiers$macrocall$1$ebnf$1$subexpression$1",symbols:["LeftModifiers$macrocall$3","LeftModifiers$macrocall$2"]},{name:"LeftModifiers$macrocall$1$ebnf$1",symbols:["LeftModifiers$macrocall$1$ebnf$1","LeftModifiers$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"LeftModifiers$macrocall$1",symbols:["LeftModifiers$macrocall$2","LeftModifiers$macrocall$1$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"LeftModifiers",symbols:["LeftModifiers$macrocall$1","_"],postprocess:function(e){var t=R(e,1)[0];return I(t)}},{name:"LeftModifiers",symbols:[],postprocess:function(){return[]}},{name:"RuleBracket",symbols:["EllipsisRuleBracket"],postprocess:k},{name:"RuleBracket",symbols:["NormalRuleBracket"],postprocess:k},{name:"NormalRuleBracket$macrocall$2",symbols:["RuleBracketNeighbor"]},{name:"NormalRuleBracket$macrocall$3",symbols:[{literal:"|"}]},{name:"NormalRuleBracket$macrocall$1$ebnf$1",symbols:[]},{name:"NormalRuleBracket$macrocall$1$ebnf$1$subexpression$1",symbols:["NormalRuleBracket$macrocall$3","NormalRuleBracket$macrocall$2"]},{name:"NormalRuleBracket$macrocall$1$ebnf$1",symbols:["NormalRuleBracket$macrocall$1$ebnf$1","NormalRuleBracket$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"NormalRuleBracket$macrocall$1",symbols:["NormalRuleBracket$macrocall$2","NormalRuleBracket$macrocall$1$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"NormalRuleBracket$ebnf$1$subexpression$1",symbols:["t_AGAIN","_"]},{name:"NormalRuleBracket$ebnf$1",symbols:["NormalRuleBracket$ebnf$1$subexpression$1"],postprocess:k},{name:"NormalRuleBracket$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"NormalRuleBracket$ebnf$2$subexpression$1",symbols:["_","t_DEBUGGER"]},{name:"NormalRuleBracket$ebnf$2",symbols:["NormalRuleBracket$ebnf$2$subexpression$1"],postprocess:k},{name:"NormalRuleBracket$ebnf$2",symbols:[],postprocess:function(){return null}},{name:"NormalRuleBracket",symbols:[{literal:"["},"NormalRuleBracket$macrocall$1","NormalRuleBracket$ebnf$1",{literal:"]"},"NormalRuleBracket$ebnf$2"],postprocess:C("NormalRuleBracket")||function(e,t){var n=R(e,5),r=(n[0],n[1]),o=n[2],i=(n[3],n[4]);return{type:"_INNER_BRACKET",neighbors:I(r),againHack:!!o,debugFlag:i?i[1]:null,_sourceOffset:t}}},{name:"EllipsisRuleBracket$macrocall$2",symbols:["RuleBracketNeighbor"]},{name:"EllipsisRuleBracket$macrocall$3",symbols:[{literal:"|"}]},{name:"EllipsisRuleBracket$macrocall$1$ebnf$1",symbols:[]},{name:"EllipsisRuleBracket$macrocall$1$ebnf$1$subexpression$1",symbols:["EllipsisRuleBracket$macrocall$3","EllipsisRuleBracket$macrocall$2"]},{name:"EllipsisRuleBracket$macrocall$1$ebnf$1",symbols:["EllipsisRuleBracket$macrocall$1$ebnf$1","EllipsisRuleBracket$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"EllipsisRuleBracket$macrocall$1",symbols:["EllipsisRuleBracket$macrocall$2","EllipsisRuleBracket$macrocall$1$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"EllipsisRuleBracket$macrocall$5",symbols:["RuleBracketNeighbor"]},{name:"EllipsisRuleBracket$macrocall$6",symbols:[{literal:"|"}]},{name:"EllipsisRuleBracket$macrocall$4$ebnf$1",symbols:[]},{name:"EllipsisRuleBracket$macrocall$4$ebnf$1$subexpression$1",symbols:["EllipsisRuleBracket$macrocall$6","EllipsisRuleBracket$macrocall$5"]},{name:"EllipsisRuleBracket$macrocall$4$ebnf$1",symbols:["EllipsisRuleBracket$macrocall$4$ebnf$1","EllipsisRuleBracket$macrocall$4$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"EllipsisRuleBracket$macrocall$4",symbols:["EllipsisRuleBracket$macrocall$5","EllipsisRuleBracket$macrocall$4$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"EllipsisRuleBracket$ebnf$1$subexpression$1",symbols:["_","t_DEBUGGER"]},{name:"EllipsisRuleBracket$ebnf$1",symbols:["EllipsisRuleBracket$ebnf$1$subexpression$1"],postprocess:k},{name:"EllipsisRuleBracket$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"EllipsisRuleBracket",symbols:[{literal:"["},"EllipsisRuleBracket$macrocall$1",{literal:"|"},"_","t_ELLIPSIS","_",{literal:"|"},"EllipsisRuleBracket$macrocall$4",{literal:"]"},"EllipsisRuleBracket$ebnf$1"],postprocess:C("EllipsisRuleBracket")||function(e,t){var n=R(e,10),r=(n[0],n[1]),o=(n[2],n[3],n[4],n[5],n[6],n[7]),i=(n[8],n[9]);return{type:"_INNER_ELLIPSIS_BRACKET",beforeNeighbors:I(r),afterNeighbors:I(o),debugFlag:i?i[1]:null,_sourceOffset:t}}},{name:"RuleBracketNeighbor",symbols:["RuleBracketNoEllipsisNeighbor"],postprocess:k},{name:"RuleBracketNeighbor",symbols:["RuleBracketEmptyNeighbor"],postprocess:k},{name:"RuleBracketNoEllipsisNeighbor$macrocall$2",symbols:["TileWithModifier"]},{name:"RuleBracketNoEllipsisNeighbor$macrocall$3",symbols:["__"]},{name:"RuleBracketNoEllipsisNeighbor$macrocall$1$ebnf$1",symbols:[]},{name:"RuleBracketNoEllipsisNeighbor$macrocall$1$ebnf$1$subexpression$1",symbols:["RuleBracketNoEllipsisNeighbor$macrocall$3","RuleBracketNoEllipsisNeighbor$macrocall$2"]},{name:"RuleBracketNoEllipsisNeighbor$macrocall$1$ebnf$1",symbols:["RuleBracketNoEllipsisNeighbor$macrocall$1$ebnf$1","RuleBracketNoEllipsisNeighbor$macrocall$1$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleBracketNoEllipsisNeighbor$macrocall$1",symbols:["RuleBracketNoEllipsisNeighbor$macrocall$2","RuleBracketNoEllipsisNeighbor$macrocall$1$ebnf$1"],postprocess:C("nonemptyListOf")||P},{name:"RuleBracketNoEllipsisNeighbor$ebnf$1$subexpression$1",symbols:["_","t_DEBUGGER"]},{name:"RuleBracketNoEllipsisNeighbor$ebnf$1",symbols:["RuleBracketNoEllipsisNeighbor$ebnf$1$subexpression$1"],postprocess:k},{name:"RuleBracketNoEllipsisNeighbor$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"RuleBracketNoEllipsisNeighbor",symbols:["_","RuleBracketNoEllipsisNeighbor$macrocall$1","RuleBracketNoEllipsisNeighbor$ebnf$1","_"],postprocess:C("RuleBracketNoEllipsisNeighbor")||function(e,t){var n=R(e,4),r=(n[0],n[1]),o=n[2];n[3];return{type:"NEIGHBOR",tileWithModifiers:I(r),debugFlag:o?o[1]:null,_sourceOffset:t}}},{name:"RuleBracketEmptyNeighbor",symbols:["_"],postprocess:C("RuleBracketEmptyNeighbor")||function(e,t){R(e,1)[0];return{type:"NEIGHBOR",tileWithModifiers:[],_sourceOffset:t}}},{name:"TileWithModifier$ebnf$1$subexpression$1",symbols:["tileModifier","__"]},{name:"TileWithModifier$ebnf$1",symbols:["TileWithModifier$ebnf$1$subexpression$1"],postprocess:k},{name:"TileWithModifier$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"TileWithModifier",symbols:["TileWithModifier$ebnf$1","lookupRuleVariableName"],postprocess:C("TileWithModifier")||function(e,t){var n,r=R(e,2),o=r[0],i=r[1],a=o?o[0]:null,s=!1,l=!1;switch(a){case"NO":s=!0;break;case"RANDOM":l=!0;break;default:n=a}return{type:"TILE_WITH_MODIFIER",direction:n,isNegated:s,isRandom:l,tile:i,_sourceOffset:t}}},{name:"tileModifier",symbols:["t_NO"],postprocess:G},{name:"tileModifier",symbols:["t_LEFT"],postprocess:G},{name:"tileModifier",symbols:["t_RIGHT"],postprocess:G},{name:"tileModifier",symbols:["t_UP"],postprocess:G},{name:"tileModifier",symbols:["t_DOWN"],postprocess:G},{name:"tileModifier",symbols:["t_RANDOMDIR"],postprocess:G},{name:"tileModifier",symbols:["t_RANDOM"],postprocess:G},{name:"tileModifier",symbols:["t_STATIONARY"],postprocess:G},{name:"tileModifier",symbols:["t_MOVING"],postprocess:G},{name:"tileModifier",symbols:["t_ACTION"],postprocess:G},{name:"tileModifier",symbols:["t_VERTICAL"],postprocess:G},{name:"tileModifier",symbols:["t_HORIZONTAL"],postprocess:G},{name:"tileModifier",symbols:["t_PERPENDICULAR"],postprocess:G},{name:"tileModifier",symbols:["t_PARALLEL"],postprocess:G},{name:"tileModifier",symbols:["t_ORTHOGONAL"],postprocess:G},{name:"tileModifier",symbols:["t_ARROW_ANY"],postprocess:G},{name:"RuleModifier",symbols:["t_RANDOM"],postprocess:G},{name:"RuleModifier",symbols:["t_UP"],postprocess:G},{name:"RuleModifier",symbols:["t_DOWN"],postprocess:G},{name:"RuleModifier",symbols:["t_LEFT"],postprocess:G},{name:"RuleModifier",symbols:["t_RIGHT"],postprocess:G},{name:"RuleModifier",symbols:["t_VERTICAL"],postprocess:G},{name:"RuleModifier",symbols:["t_HORIZONTAL"],postprocess:G},{name:"RuleModifier",symbols:["t_ORTHOGONAL"],postprocess:G},{name:"RuleModifierLeft",symbols:["RuleModifier"],postprocess:k},{name:"RuleModifierLeft",symbols:["t_LATE"],postprocess:G},{name:"RuleModifierLeft",symbols:["t_RIGID"],postprocess:G},{name:"RuleCommand",symbols:["t_AGAIN"],postprocess:function(e,t){return{type:y.c.AGAIN,_sourceOffset:t}}},{name:"RuleCommand",symbols:["t_CANCEL"],postprocess:function(e,t){return{type:y.c.CANCEL,_sourceOffset:t}}},{name:"RuleCommand",symbols:["t_CHECKPOINT"],postprocess:function(e,t){return{type:y.c.CHECKPOINT,_sourceOffset:t}}},{name:"RuleCommand",symbols:["t_RESTART"],postprocess:function(e,t){return{type:y.c.RESTART,_sourceOffset:t}}},{name:"RuleCommand",symbols:["t_WIN"],postprocess:function(e,t){return{type:y.c.WIN,_sourceOffset:t}}},{name:"RuleCommand",symbols:["t_SFX"],postprocess:function(e,t){var n=R(e,1)[0];return{type:y.c.SFX,sound:n,_sourceOffset:t}}},{name:"MessageCommand",symbols:["t_MESSAGE","messageLine"],postprocess:function(e,t){var n=R(e,2),r=(n[0],n[1]);return{type:y.c.MESSAGE,message:r,_sourceOffset:t}}},{name:"RuleLoop$ebnf$1$subexpression$1",symbols:["_","t_DEBUGGER"]},{name:"RuleLoop$ebnf$1",symbols:["RuleLoop$ebnf$1$subexpression$1"],postprocess:k},{name:"RuleLoop$ebnf$1",symbols:[],postprocess:function(){return null}},{name:"RuleLoop$ebnf$2",symbols:["lineTerminator"]},{name:"RuleLoop$ebnf$2",symbols:["RuleLoop$ebnf$2","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleLoop$ebnf$3$subexpression$1",symbols:["RuleItem"]},{name:"RuleLoop$ebnf$3",symbols:["RuleLoop$ebnf$3$subexpression$1"]},{name:"RuleLoop$ebnf$3$subexpression$2",symbols:["RuleItem"]},{name:"RuleLoop$ebnf$3",symbols:["RuleLoop$ebnf$3","RuleLoop$ebnf$3$subexpression$2"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleLoop$ebnf$4",symbols:["lineTerminator"]},{name:"RuleLoop$ebnf$4",symbols:["RuleLoop$ebnf$4","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleLoop",symbols:["RuleLoop$ebnf$1","_","t_STARTLOOP","RuleLoop$ebnf$2","RuleLoop$ebnf$3","_","t_ENDLOOP","RuleLoop$ebnf$4"],postprocess:function(e){var t=R(e,8),n=(t[0],t[1],t[2],t[3],t[4]);t[5],t[6],t[7];return{type:y.f.LOOP,rules:I(n)}}},{name:"RuleGroup$ebnf$1$subexpression$1",symbols:["_","t_GROUP_RULE_PLUS","Rule"]},{name:"RuleGroup$ebnf$1",symbols:["RuleGroup$ebnf$1$subexpression$1"]},{name:"RuleGroup$ebnf$1$subexpression$2",symbols:["_","t_GROUP_RULE_PLUS","Rule"]},{name:"RuleGroup$ebnf$1",symbols:["RuleGroup$ebnf$1","RuleGroup$ebnf$1$subexpression$2"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"RuleGroup",symbols:["Rule","RuleGroup$ebnf$1"],postprocess:function(e,t){var n,r=R(e,2),o=r[0],i=r[1];return{type:y.f.GROUP,rules:[o].concat((n=i,n.map(function(e){if(e.length<3)throw new Error("BUG: Expected items to have at least 3 elements (usually used in listOf[...])");return e[2]}))),_sourceOffset:t}}},{name:"WinConditionItem$ebnf$1",symbols:["lineTerminator"]},{name:"WinConditionItem$ebnf$1",symbols:["WinConditionItem$ebnf$1","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"WinConditionItem",symbols:["_","winConditionItemPrefix","__","lookupRuleVariableName","WinConditionItem$ebnf$1"],postprocess:C("WinConditionItem")||function(e,t){var n=R(e,5),r=(n[0],n[1]),o=(n[2],n[3]);n[4];return{type:y.j.SIMPLE,qualifier:r,tile:o,_sourceOffset:t}}},{name:"WinConditionItem$ebnf$2",symbols:["lineTerminator"]},{name:"WinConditionItem$ebnf$2",symbols:["WinConditionItem$ebnf$2","lineTerminator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"WinConditionItem",symbols:["_","winConditionItemPrefix","__","lookupRuleVariableName","__","t_ON","__","lookupRuleVariableName","WinConditionItem$ebnf$2"],postprocess:C("WinConditionItem")||function(e,t){var n=R(e,9),r=(n[0],n[1]),o=(n[2],n[3]),i=(n[4],n[5],n[6],n[7]);n[8];return{type:y.j.ON,qualifier:r,tile:o,onTile:i,_sourceOffset:t}}},{name:"winConditionItemPrefix",symbols:["t_NO"],postprocess:k},{name:"winConditionItemPrefix",symbols:["t_ALL"],postprocess:k},{name:"winConditionItemPrefix",symbols:["t_ANY"],postprocess:k},{name:"winConditionItemPrefix",symbols:["t_SOME"],postprocess:k},{name:"LevelItem",symbols:["GameMessageLevel"],postprocess:k},{name:"LevelItem",symbols:["levelMapRow"],postprocess:k},{name:"LevelItem",symbols:["SeparatorLine"],postprocess:k},{name:"GameMessageLevel",symbols:["_","t_MESSAGE","messageLine"],postprocess:function(e,t){var n=R(e,3);n[0],n[1];return{type:"LEVEL_MESSAGE",message:n[2],_sourceOffset:t}}},{name:"messageLine$ebnf$1",symbols:[]},{name:"messageLine$ebnf$1",symbols:["messageLine$ebnf$1",/[^\n]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"messageLine",symbols:["messageLine$ebnf$1",/[\n]/],postprocess:C("messageLine")||function(e){var t=R(e,2),n=t[0];t[1];return n.join("").trim()}},{name:"levelMapRow$ebnf$1",symbols:[/[^\n \t\(]/]},{name:"levelMapRow$ebnf$1",symbols:["levelMapRow$ebnf$1",/[^\n \t\(]/],postprocess:function(e){return e[0].concat([e[1]])}},{name:"levelMapRow",symbols:["_","levelMapRow$ebnf$1","lineTerminator"],postprocess:function(e,t,n){var r=R(e,2),o=(r[0],r[1]);return o.join("").toUpperCase().startsWith("MESSAGE")?n:{type:"LEVEL_ROW",cells:o.map(function(e){return R(e,1)[0][0]}),_sourceOffset:t}}},{name:"SeparatorLine",symbols:["lineTerminator"],postprocess:function(e,t){return{type:"LEVEL_SEPARATOR",_sourceOffset:t}}}],W="main";function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e[e.ERROR=0]="ERROR",e[e.WARNING=1]="WARNING",e[e.INFO=2]="INFO"}(D||(D={}));var H=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.grammar=o.Grammar.fromCompiled(r)}var t,n,i;return t=e,(n=[{key:"parseToAST",value:function(e){var t=new o.Parser(this.grammar);t.feed(e),t.feed("\n"),t.finish();var n=t.results;if(1===n.length)return n[0];throw 0===n.length?new Error("ERROR: Could not parse"):new Error("AMBIGUOUS: has ".concat(n.length," results"))}},{key:"parse",value:function(e){var t=this.parseToAST(e);return{data:new O(e).build(t)}}}])&&j(t.prototype,n),i&&j(t,i),e}();t.a=new H},,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}
/**
 * Seedable random number generator functions.
 * @version 1.0.0
 * @license Public Domain
 *
 * @example
 * var rng = new RNG('Example');
 * rng.random(40, 50);  // =>  42
 * rng.uniform();       // =>  0.7972798995050903
 * rng.normal();        // => -0.6698504543216376
 * rng.exponential();   // =>  1.0547367609131555
 * rng.poisson(4);      // =>  2
 * rng.gamma(4);        // =>  2.781724687386858
 */n.r(t),n.d(t,"RNG",function(){return s});var a=function(){function e(t){r(this,e),this.s=new Array(256),this.i=0,this.j=0;for(var n=0;n<256;n++)this.s[n]=n;t&&this.mix(t)}return i(e,[{key:"_swap",value:function(e,t){var n=this.s[e];this.s[e]=this.s[t],this.s[t]=n}},{key:"mix",value:function(e){for(var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n),o=[];do{o.push(255&r),r>>=8}while(r>0);t=t.concat(o.reverse())}return t}(e),n=0,r=0;r<this.s.length;r++)n+=this.s[r]+t[r%t.length],n%=256,this._swap(r,n)}},{key:"next",value:function(){return this.i=(this.i+1)%256,this.j=(this.j+this.s[this.i])%256,this._swap(this.i,this.j),this.s[(this.s[this.i]+this.s[this.j])%256]}}]),e}(),s=function(){function e(t){r(this,e),this._normal=null,this._state=new a(JSON.stringify(t))}return i(e,[{key:"nextByte",value:function(){return this._state.next()}},{key:"uniform",value:function(){for(var e=0,t=0;t<7;t++)e*=256,e+=this.nextByte();return e/(Math.pow(2,56)-1)}},{key:"random",value:function(e,t){return null===e?this.uniform():(null===t&&(t=e,e=0),e+Math.floor(this.uniform()*(t-e)))}},{key:"normal",value:function(){if(null!==this._normal){var e=this._normal;return this._normal=null,e}var t=this.uniform()||Math.pow(2,-53),n=this.uniform();return this._normal=Math.sqrt(-2*Math.log(t))*Math.sin(2*Math.PI*n),Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*n)}},{key:"exponential",value:function(){return-Math.log(this.uniform()||Math.pow(2,-53))}},{key:"poisson",value:function(e){var t=Math.exp(-(e||1)),n=0,r=1;do{n++,r*=this.uniform()}while(r>t);return n-1}}]),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"MakeRiff",function(){return l}),n.d(t,"FastBase64_Encode",function(){return i});var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=[];function i(e){for(var t,n=e.length,i="",a=0;n>2;)t=e[a]<<16|e[a+1]<<8|e[a+2],i+=o[t>>12]+o[4095&t],n-=3,a+=3;if(n>0){var s=(252&e[a])>>2,l=(3&e[a])<<4;if(n>1&&(l|=(240&e[++a])>>4),i+=r[s],i+=r[l],2===n){var u=(15&e[a++])<<2;u|=(192&e[a])>>6,i+=r[u]}1===n&&(i+="="),i+="="}return i}function a(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function s(e){return[255&e,e>>8&255]}function l(e,t,n){var r,o={audioFormat:1,bitsPerSample:t,blockAlign:0,byteRate:0,chunkId:[82,73,70,70],chunkSize:0,format:[87,65,86,69],numChannels:1,sampleRate:e,subChunk1Id:[102,109,116,32],subChunk1Size:16,subChunk2Id:[100,97,116,97],subChunk2Size:0};return o.byteRate=o.sampleRate*o.numChannels*o.bitsPerSample>>3,o.blockAlign=o.numChannels*o.bitsPerSample>>3,o.subChunk2Size=n.length,o.chunkSize=36+o.subChunk2Size,{dat:[],dataURI:"data:audio/wav;base64,"+i(r=o.chunkId.concat(a(o.chunkSize),o.format,o.subChunk1Id,a(o.subChunk1Size),s(o.audioFormat),s(o.numChannels),a(o.sampleRate),a(o.byteRate),s(o.blockAlign),s(o.bitsPerSample),o.subChunk2Id,a(o.subChunk2Size),n)),header:o,wav:r}}!function(){for(var e=0;e<4096;e++)o[e]=r[e>>6]+r[63&e]}()},,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);n(153);var r=n(150),o=n(149),i=n(355),a=n(2),s=n(357),l=n(151),u=n(0);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}var y=function(){function e(t,n){var o=this;h(this,e),this.table=t,this.inputWatcher=new r.a(t),this.timer=0,this.engine=null;var i={onWin:function(){alert("You won the game! Congratulations!")},onMessage:function(){var e=f(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(u.j)(10,function(){return!o.inputWatcher.isSomethingPressed()&&(alert(n),t.focus(),!0)}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},a=n?new u.a([n,i]):new u.a([i]);this.tableUI=new l.a(t,a)}return m(e,[{key:"setGame",value:function(e,t){var n=s.a.parse(e).data;this.engine=new i.a(n,this.tableUI),this.tableUI.onGameChange(n),this.engine.setLevel(t),n.metadata.keyRepeatInterval&&this.inputWatcher.setKeyRepeatInterval(n.metadata.keyRepeatInterval)}},{key:"start",value:function(){var e=this;this.timer&&this.pause(),this.table.setAttribute("data-ps-state","running");var t=function(){var n=f(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r=e.inputWatcher.pollControls())&&e.engine&&e.engine.press(r),n.next=4,e.getEngine().tick();case 4:e.timer=window.requestAnimationFrame(t);case 5:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}();this.timer=window.requestAnimationFrame(t)}},{key:"pause",value:function(){this.table.setAttribute("data-ps-state","paused"),cancelAnimationFrame(this.timer),this.timer=0}},{key:"getEngine",value:function(){if(!this.engine)throw new Error("BUG: Engine has not been created yet");return this.engine}},{key:"dispose",value:function(){this.pause(),this.inputWatcher.dispose()}}]),e}(),d=function(){function e(t,n){h(this,e),this.table=t,this.subEngine=new y(t,n),this.resizeWatcher=new o.a(t,this.handleResize.bind(this)),this.handler=new u.a(n?[n,this.subEngine.tableUI]:[this.subEngine.tableUI]),this.boundPause=this.pause.bind(this),this.boundResume=this.resume.bind(this),this.table.addEventListener("blur",this.boundPause),this.table.addEventListener("focus",this.boundResume)}return m(e,[{key:"setGame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.subEngine.setGame(e,t);var n=this.subEngine.getEngine();if(n.getCurrentLevel().type===a.d.MAP){var r=n.getCurrentLevelCells();this.resizeWatcher.setLevel(r.length,r[0].length)}this.subEngine.start(),this.table.focus(),this.resizeWatcher.trigger()}},{key:"dispose",value:function(){this.subEngine.dispose(),this.resizeWatcher.dispose(),this.table.removeEventListener("blur",this.boundPause),this.table.removeEventListener("focus",this.boundResume)}},{key:"pause",value:function(){this.subEngine.pause(),this.handler.onPause()}},{key:"resume",value:function(){this.subEngine.start(),this.handler.onResume()}},{key:"handleResize",value:function(e){this.subEngine.getEngine().isCurrentLevelAMessage()||this.table.setAttribute("style","width: ".concat(e,"px;"))}}]),e}(),v=n(354),b=n(147);window.PuzzleScript={WebworkerTableEngine:v.a,SyncTableEngine:d,closeSounds:b.closeSounds}}]);
//# sourceMappingURL=puzzlescript.js.map